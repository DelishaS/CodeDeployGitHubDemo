##########################################################################################################
Promote start: 1/14/2020 6:00:31 PM at server DONUATALWAX for account .  SiteManager 6.0 - MOVEFORM267308.
##########################################################################################################
Technical Contact is michael xia at phone number (803) 569-1956
##########################################################################################################
##########################################################################################################
##########################################################################################################
Backed Up Prior Version of
    E:\csc\don\uat\alc.0\webserver\applications\nbp\BPCABuilding.ascx
    TO
    E:\CSCCODEMOVES\MOVEFORM267308\MOVEFORM267308.ZIP
Copied File 
    E:\CSCCODEMOVES\MOVEFORM267308\BPCABuilding.ascx
    TO
    E:\csc\don\uat\alc.0\webserver\applications\nbp\BPCABuilding.ascx
 Copied BPCABuilding.ascx to E:\csc\don\uat\alc.0\webserver\applications\nbp
##########################################################################################################
Backed Up Prior Version of
    E:\csc\don\uat\alc.0\webserver\bin\NBusinessOwners.dll
    TO
    E:\CSCCODEMOVES\MOVEFORM267308\MOVEFORM267308.ZIP
Copied File 
    E:\CSCCODEMOVES\MOVEFORM267308\NBusinessOwners.dll
    TO
    E:\csc\don\uat\alc.0\webserver\bin\NBusinessOwners.dll
 Copied NBusinessOwners.dll to E:\csc\don\uat\alc.0\webserver\bin
##########################################################################################################
##########################################################################################################
##########################################################################################################
Promote Process Succeeded: 1/14/2020 6:00:32 PM
ALTER TABLE BOPropertyInfo ADD [CondoAssociation] [char](1) NULL 

INSERT INTO [dbo].[BOSeleUnitDeductible]
           ([HostCD]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[StateCd]
           ,[UnitDeductibleCd]
           ,[UnitDeductibleDes]
           ,[AcordCd]
           ,[SortOrder])
     VALUES
           ('PT',	'00',	'01',	'00',	'BP', 	'CBP',	'CA',	'25000', '25,000', '',	8)

INSERT INTO [dbo].[BOSeleUnitDeductible]
           ([HostCD]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[StateCd]
           ,[UnitDeductibleCd]
           ,[UnitDeductibleDes]
           ,[AcordCd]
           ,[SortOrder])
     VALUES
           ('PT',	'00',	'01',	'00',	'BP', 	'CBP',	'CA',	'50000', '50,000', '',	9)


(1 rows affected)

(1 rows affected)


INSERT INTO [dbo].[SHSeleCovDescription]
           ([HostCd]
           ,[CoverageCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[StateCd]
           ,[CoverageDes]
           ,[SortOrder]
           ,[AcordCd]
           ,[DisplaySeq])
     VALUES
           ('PT',	'WTRDMG', 	'BP',	'CBP',	'CA',	'Split Water Damage Deductible',	0,	'',    	55900)


(1 rows affected)




INSERT INTO [dbo].[SHSeleCoverageAttributes]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[CoverageCd]
           ,[CoverageDes]
           ,[CoverageOutputDes]
           ,[SubjectOfInsuranceLineCd]
           ,[InsuranceLineCovInd]
           ,[AddInsuredCd]
           ,[MandatoryCoverageInd]
           ,[MultipleSelectionInd]
           ,[ScheduleItemCd]
           ,[ClassSearchCd]
           ,[DefaultClassCd]
           ,[SortOrderNbr]
           ,[AcordCd]
           ,[IsAppliedForAgent])
     VALUES('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'CONENH',	'Condo Property Enhancement (BO 079)','','',		          	1,'',	  	'False',	'False',	0,	0,	'',          	14,	'CONENH',	'True')

INSERT INTO [dbo].[SHSeleCoverageAttributes]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[CoverageCd]
           ,[CoverageDes]
           ,[CoverageOutputDes]
           ,[SubjectOfInsuranceLineCd]
           ,[InsuranceLineCovInd]
           ,[AddInsuredCd]
           ,[MandatoryCoverageInd]
           ,[MultipleSelectionInd]
           ,[ScheduleItemCd]
           ,[ClassSearchCd]
           ,[DefaultClassCd]
           ,[SortOrderNbr]
           ,[AcordCd]
           ,[IsAppliedForAgent])
     VALUES('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'WTRDMG',	'Split Water Damage',  '','',		          	2,  '',	  	'False',	'False',	0,	0, '',	          	10,	'WTRDMG',	'True')



(1 rows affected)

(1 rows affected)
INSERT INTO [dbo].[SHSeleCovParms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[CoverageCd]
           ,[CoverageParmSeqNbr]
           ,[CoverageParmFieldId]
           ,[CoverageParmHeadingTxt]
           ,[CoverageParmTypeCd]
           ,[CoverageParmLookupCd]
           ,[CoverageParmSizeTxt]
           ,[CoverageParmFieldRowNbr]
           ,[CoverageParmDefaultTxt]
           ,[MappingFieldNm]
           ,[AcordXMLPathTxt]
           ,[MandatoryFieldsInd]
           ,[CoverageParmUserTypeStatusCd]
           ,[CoverageParmAggTypeCd]
           ,[CoverageSubParmTypeCd]
           ,[MandatoryFieldsEditMsgTxt]
           ,[MandatoryFieldsEditTypeCd]
           ,[ValidationEditCd]
           ,[ValidationTriggerTxt]
           ,[ValidationMsgTxt]
           ,[ValidationMandatoryFieldsInd]
           ,[ValidationMandatoryFieldsEditMsgTxt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'CONENH',	10,	'CONENH_TotalNumberLoc',	'*Total Number of Locations',	'INP','',		'size="11"  maxlength="9" onBlur="return CheckNumeric(this)"  style="text-align:right"  class="fData"',	1,'','',		        	'com.csc_CONENTotalNumberLoc',	'False',	0,	'OPTION',	  '',    	'*Total Number of Locations',	'TXT',  '','',			'TRUE',	'True',	NULL)

INSERT INTO [dbo].[SHSeleCovParms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[CoverageCd]
           ,[CoverageParmSeqNbr]
           ,[CoverageParmFieldId]
           ,[CoverageParmHeadingTxt]
           ,[CoverageParmTypeCd]
           ,[CoverageParmLookupCd]
           ,[CoverageParmSizeTxt]
           ,[CoverageParmFieldRowNbr]
           ,[CoverageParmDefaultTxt]
           ,[MappingFieldNm]
           ,[AcordXMLPathTxt]
           ,[MandatoryFieldsInd]
           ,[CoverageParmUserTypeStatusCd]
           ,[CoverageParmAggTypeCd]
           ,[CoverageSubParmTypeCd]
           ,[MandatoryFieldsEditMsgTxt]
           ,[MandatoryFieldsEditTypeCd]
           ,[ValidationEditCd]
           ,[ValidationTriggerTxt]
           ,[ValidationMsgTxt]
           ,[ValidationMandatoryFieldsInd]
           ,[ValidationMandatoryFieldsEditMsgTxt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'WTRDMG',	11,	'WATER_Label',	'Split Water Damage Deductible ($):',	'CHK',	'',	'value="N" align="top" onClick="sewer_check()"',	3,	1,	   '',     	'com.csc_WTRDMGChecked',	'False',	0,	'OPTION',	 '','','','','','',     		     				'False',	NULL)

INSERT INTO [dbo].[SHSeleCovParms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[CoverageCd]
           ,[CoverageParmSeqNbr]
           ,[CoverageParmFieldId]
           ,[CoverageParmHeadingTxt]
           ,[CoverageParmTypeCd]
           ,[CoverageParmLookupCd]
           ,[CoverageParmSizeTxt]
           ,[CoverageParmFieldRowNbr]
           ,[CoverageParmDefaultTxt]
           ,[MappingFieldNm]
           ,[AcordXMLPathTxt]
           ,[MandatoryFieldsInd]
           ,[CoverageParmUserTypeStatusCd]
           ,[CoverageParmAggTypeCd]
           ,[CoverageSubParmTypeCd]
           ,[MandatoryFieldsEditMsgTxt]
           ,[MandatoryFieldsEditTypeCd]
           ,[ValidationEditCd]
           ,[ValidationTriggerTxt]
           ,[ValidationMsgTxt]
           ,[ValidationMandatoryFieldsInd]
           ,[ValidationMandatoryFieldsEditMsgTxt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'WTRDMG',	15,	'WATER_LimitAmt',	'',	'SEL',	'WTRDMG',	'size="1" onBlur="return CheckNumeric(this,''5000'',''F'')" style="text-align:right" class="fData" disabled',	4,	'5000',	    '',    	'com.csc_WTRDMGLimit',	'False',	0,	'OPTION',	'','','','','','',      		     				'False',	NULL)

(1 rows affected)

(1 rows affected)

(1 rows affected)
INSERT INTO [dbo].[SHSeleLookupValues]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[LookupCd]
           ,[LookupValueCd]
           ,[LookupValueDesc]
           ,[SortOrderNbr]
           ,[AcordCd]
           ,[IsAppliedForAgent])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'WTRDMG',	'10000',	'10,000',	3,	'',	'True')

INSERT INTO [dbo].[SHSeleLookupValues]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[LookupCd]
           ,[LookupValueCd]
           ,[LookupValueDesc]
           ,[SortOrderNbr]
           ,[AcordCd]
           ,[IsAppliedForAgent])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'WTRDMG',	'15000',	'15,000',	4,	'',	'True')

INSERT INTO [dbo].[SHSeleLookupValues]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[LookupCd]
           ,[LookupValueCd]
           ,[LookupValueDesc]
           ,[SortOrderNbr]
           ,[AcordCd]
           ,[IsAppliedForAgent])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP',	'CBP',	'WTRDMG',	'20000',	'20,000',	5,	'',	'True')

INSERT INTO [dbo].[SHSeleLookupValues]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[LookupCd]
           ,[LookupValueCd]
           ,[LookupValueDesc]
           ,[SortOrderNbr]
           ,[AcordCd]
           ,[IsAppliedForAgent])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'WTRDMG',	'5000',		'5,000',	1,	'',	'True')	

INSERT INTO [dbo].[SHSeleLookupValues]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[LookupCd]
           ,[LookupValueCd]
           ,[LookupValueDesc]
           ,[SortOrderNbr]
           ,[AcordCd]
           ,[IsAppliedForAgent])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'WTRDMG',	'7500',		'7,500',	2,	'',	'True')


(1 rows affected)

(1 rows affected)

(1 rows affected)

(1 rows affected)

(1 rows affected)
INSERT INTO [dbo].[SHSeleManualForms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[ProductCd]
           ,[CoverageCd]
           ,[SetTypeNbr]
           ,[AttributeNm]
           ,[AttributeValueRateBookCd]
           ,[AttributeValueCd]
           ,[EditionCd]
           ,[AttributeValueDes]
           ,[FunctionsAttachedTxt]
           ,[EffectiveDt]
           ,[ExpirationDt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'999999',	'999999',	'120',	'FORM NUMBER',                   	'A',	'BO075',               	'1019',      	'Split Water Damage Deductible coverage',                                                                                  	NULL,	'2009-01-01 00:00:00.000',	'2099-12-31 00:00:00.000')

INSERT INTO [dbo].[SHSeleManualForms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[ProductCd]
           ,[CoverageCd]
           ,[SetTypeNbr]
           ,[AttributeNm]
           ,[AttributeValueRateBookCd]
           ,[AttributeValueCd]
           ,[EditionCd]
           ,[AttributeValueDes]
           ,[FunctionsAttachedTxt]
           ,[EffectiveDt]
           ,[ExpirationDt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'999999',	'999999',	'120',	'FORM NUMBER',                   	'A',	'BO076',               	'1019',      	'CONDOMINIUM ASSOCIATION COVERAGE - ALL INCLUDED',                                                                        	NULL,	'2009-01-01 00:00:00.000',	'2099-12-31 00:00:00.000')

INSERT INTO [dbo].[SHSeleManualForms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[ProductCd]
           ,[CoverageCd]
           ,[SetTypeNbr]
           ,[AttributeNm]
           ,[AttributeValueRateBookCd]
           ,[AttributeValueCd]
           ,[EditionCd]
           ,[AttributeValueDes]
           ,[FunctionsAttachedTxt]
           ,[EffectiveDt]
           ,[ExpirationDt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'999999',	'999999',	'120',	'FORM NUMBER',                   	'A',	'BO077',              	'1019',      	'CONDOMINIUM ASSOCIATION COVERAGE - BARE WALLS',                                                                           	NULL,	'2009-01-01 00:00:00.000',	'2099-12-31 00:00:00.000')

INSERT INTO [dbo].[SHSeleManualForms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[ProductCd]
           ,[CoverageCd]
           ,[SetTypeNbr]
           ,[AttributeNm]
           ,[AttributeValueRateBookCd]
           ,[AttributeValueCd]
           ,[EditionCd]
           ,[AttributeValueDes]
           ,[FunctionsAttachedTxt]
           ,[EffectiveDt]
           ,[ExpirationDt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP', 	'CBP',	'999999',	'999999',	'120',	'FORM NUMBER',                   	'A',	'BO078',               	'1019',      	'CONDOMINIUM ASSOCIATION COVERAGE - ORIGINAL SPECIFICATIONS',                                                              	NULL,	'2009-01-01 00:00:00.000',	'2099-12-31 00:00:00.000')

INSERT INTO [dbo].[SHSeleManualForms]
           ([HostCd]
           ,[LocationId]
           ,[MasterCompanyId]
           ,[PolicyCompanyId]
           ,[StateCd]
           ,[LineOfBusinessCd]
           ,[InsuranceLineCd]
           ,[ProductCd]
           ,[CoverageCd]
           ,[SetTypeNbr]
           ,[AttributeNm]
           ,[AttributeValueRateBookCd]
           ,[AttributeValueCd]
           ,[EditionCd]
           ,[AttributeValueDes]
           ,[FunctionsAttachedTxt]
           ,[EffectiveDt]
           ,[ExpirationDt])
     VALUES
           ('PT',	'00',	'01',	'00',	'CA',	'BP',	'CBP',	'999999',	'999999',	'120',	'FORM NUMBER',                   	'A',	'BO079',               	'1119',      	'Condo Property Enhancement coverage',                                                                                     	NULL,	'2009-01-01 00:00:00.000',	'2099-12-31 00:00:00.000')


(1 rows affected)

(1 rows affected)

(1 rows affected)

(1 rows affected)

(1 rows affected)





IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[ACORDXMLBORetrieveCommlSubLocation]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[ACORDXMLBORetrieveCommlSubLocation]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

CREATE PROCEDURE [dbo].[ACORDXMLBORetrieveCommlSubLocation]
@AppId varchar(20),
@HostId char(2),
@ACORDCodes char(1) ='0'
--TL BOP NY 2010 Starts
,@LOB varchar(10) = ''
,@InsuranceLineCd char(3) = ''
,@StateCd varchar(2) = '99'
,@LocationId varchar(2) = '99'
,@MasterCompanyId varchar(2) = '99'
,@PolicyCompanyId varchar(2) = '99'
--TL BOP NY 2010 Ends
 AS
set nocount on
Set @StateCd = (Select RiskState From SHPlanInfo with (nolock) where appid=@AppId) --TL BOP CA 2010
select @LocationId=LocationId, @MasterCompanyId=MasterCompanyId, @PolicyCompanyId=PolicyCompanyId from SHSeleLineOfBusiness where LOB=@LOB and Code=@InsuranceLineCd and State=@StateCd --TL BOP CA 2010
Select
10								as Tag,
Null								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Case When @ACORDCodes = '0' or @ACORDCodes = '1' then	
	Case When @ACORDCodes = '0' then A.OccupancyCd
		else ''
	end
	else K.OccupancyDes
end								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --DON-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],          --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr  --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C') --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
20								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Case When @ACORDCodes = '0' or @ACORDCodes = '1' then	
	Case When @ACORDCodes = '0' then A.ConstructionCd
		else D.AcordCd
	end
	else D.ConstructionDes
end								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C') --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C') --TL BOP NY 2010
Union All
Select
30								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
40								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
 A.YearBuilt							as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr       --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr       --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
--TL BOP NY 2010 Starts
Select
45								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null							    as [YearBuilt!40!],
A.RenovationYear					as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr       --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr       --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
    Union All
    --TL BOP NY 2010 Ends
    Select
50								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
60								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Case When @ACORDCodes = '0' or @ACORDCodes = '1' then	
	Case When @ACORDCodes = '0' then A.BCEGCd	
		else F.AcordCd
	end
	else F.BCEGDes	
end								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	-- WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')        --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')        --TL BOP NY 2010
Union All
Select
70								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Case When @ACORDCodes = '0' or @ACORDCodes = '1' then	
	Case When @ACORDCodes = '0' then A.BCEGTypeCd	
		else G.AcordCd
	end
	else G.BCEGCodedDes
end								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
80								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
CONVERT(char, A.SquareFtAreaAmt)				as [BldgArea!80!NumUnits!element],
CASE WHEN A.SquareFtAreaAmt > '0' THEN 'SF' END		as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr     --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
90								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
StoriesCountNbr						as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!], Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
100								as Tag,
20								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
UnitCountNbr						as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
110								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Case When @ACORDCodes = '0' or @ACORDCodes = '1' then	
	A.ProtectionClassCd	
else C.ProtectionClassDes	
end								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Case When @ACORDCodes = '0' or @ACORDCodes = '1' then	
	Case When @ACORDCodes = '0' then A.BurglarAlarmInd		
		else E.AcordCd	
	end
	else E.BurglarAlarmIndDes		
end								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Case When @ACORDCodes = '0' or @ACORDCodes = '1' then	
	Case When @ACORDCodes = '0' then A.SprinklerInd	
		else ''
	end
	else L.SprinklerDes		
end								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
CASE B.DeadboltCylinderInd
		WHEN '1' THEN 'DEADB'
		WHEN '2' THEN ''
		END						as [BldgProtection!110!DoorLockCd!element],
 CONVERT(char, A.AreaSprinkledPct) 				as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
B.ListOfProtectionEquipTxt			as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr       --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr       --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
--105894 Begins
Select
115								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
''									as [BldgExposures!115!DirectionTypeCd!element],
B.NatureOfBusinessTxt				as [BldgExposures!115!Description!element],
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
left join SHPropertyLocation B with (nolock) on A.appid=B.appid
WHERE A.AppId = @Appid AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
and a.LocationNbr=B.LocationNbr
Union All
Select
120								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element], 
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
 --105894 Ends
Union All
Select
140								as Tag,
120								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element], 
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
150								as Tag,
120								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
case @ACORDCodes
when '0' then A.RiskTypeCd
when '1' then ''
when '2' then M.RiskTypeDes
end								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock), SHSeleRiskType M
--TL BOP NY 2010 Starts
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
--	and M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
--				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
	and M.HostCd=@HostId AND M.RiskTypeCd=A.RiskTypeCd
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
--TL BOP NY 2010 Ends    
Union All
Select
160								as Tag,
120								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
--105894 Begins
Select
130								as Tag,
120								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
union all
Select
170								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
--105894 Begins
--Null								as [CrimeInfo!170!DepositFrequencyCd!element],
B.DepositFrequencyAmt				as [CrimeInfo!170!DepositFrequencyCd!element],
--105894 Ends
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
--105894 Begins
--from BOPropertyInfo A
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
from BOPropertyInfo A with (nolock)
--left join BOProtectionInfo B on A.appid=B.appid  128507
left join BOProtectionInfo B with (nolock) on A.appid=B.appid  and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.StructureNbr	--128507
WHERE A.AppId = @appid
AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
--105894 Ends
Union All
Select
180								as Tag,
170								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
 CONVERT(char, A.GrossSalesAmt) 				as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr   --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C') --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
190								as Tag,
170								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
200								as Tag,
170								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
210								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
--105894 Begins
Select
215								as Tag,
210								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 isnull(convert(varchar(20),MaximumCashPremAmt),'')		as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--left join BOProtectionInfo B on A.appid=B.appid  128507
left join BOProtectionInfo B with (nolock) on A.appid=B.appid  and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.StructureNbr	--128507 
WHERE A.AppId = @AppId 
AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
Union All
--105894 Ends
Select
220								as Tag,
210								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
--105894 Begins
--Null								as [MoneyAmt!220!Amt!element],
B.MaximumCashMessangerAmt								as [MoneyAmt!220!Amt!element],
--105894 Begins
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
--105894 Begins
--from BOPropertyInfo A
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
from BOPropertyInfo A with (nolock)
--left join BOProtectionInfo B on A.appid=B.appid  128507
left join BOProtectionInfo B with (nolock) on A.appid=B.appid  and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.StructureNbr	--128507 
WHERE A.AppId = @AppId 
AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')
and a.LocationNbr=B.LocationNbr
--105894 Ends
Union All
Select
230								as Tag,
210								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element], 
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element], 
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
240								as Tag,
210								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
CONVERT(char, A.PayrollAmt)         as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
250								as Tag,
210								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
 CONVERT(varchar(15), B.CashPremOvernightAmt)		as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM BOProtectionInfo B,BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
      and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.StructureNbr	--128507
Union All
Select distinct
260								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Case When @ACORDCodes = '1' then	
	C.AcordCd	
	else B.AlarmDes		
end								as [AlarmAndSecurity!260!AlarmDescCd!element],
Case When @ACORDCodes = '1' then	
	D.AcordCd	
	else B.AlarmTypeCd			
end								as [AlarmAndSecurity!260!AlarmTypeCd!element],
''								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
''								as [AlarmAndSecurity!260!CentralStationInd!element],
''								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
''								as [AlarmAndSecurity!260!LineSecurityInd!element],
''								as [AlarmAndSecurity!260!LocalGongInd!element],
''								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
''								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
''								as [AlarmAndSecurity!260!NumGuards!element],
''								as [AlarmAndSecurity!260!NumWatchPersons!element],
''								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
--''								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],--105894
B.GradeCd								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],--105894
Case When @ACORDCodes = '1' then	
	 E.AcordCd	
	else B.SafeVaultProtectionCd		
end								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
''								as [AlarmAndSecurity!260!ULCertificateNumber!element],
''								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
''								as [AlarmAndSecurity!260!WithKeysInd!element],
Case When @ACORDCodes = '1' then	
	 F.AcordCd	
	else B.PremProtectionCd		
end								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
''								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM BOPropertyInfo A,BOProtectionInfo B with (nolock)
--TL BOP NY 2010 Starts
	LEFT JOIN BOSeleAlarmDesc C
	/*ON B.AlarmDes = C.AlarmDescCd AND C.HostCd = @HostId AND C.StateCd = '99'
 AND C.LineOfBusinessCd = 'BO' AND C.LocationId = '99' AND C.MasterCompanyId = '99' AND C.PolicyCompanyId = '99'*/
    ON B.AlarmDes = C.AlarmDescCd 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN BOSeleAlarmType D
	/*ON B.AlarmTypeCd = D.AlarmTypeCd AND D.HostCd = @HostId AND D.StateCd = '99'
 AND D.LineOfBusinessCd = 'BO' AND D.LocationId = '99' AND D.MasterCompanyId = '99' AND D.PolicyCompanyId = '99'*/
    ON B.AlarmTypeCd = D.AlarmTypeCd 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSafeVaultProtection E
	/*ON B.SafeVaultProtectionCd = E.SafeVaultProtectionCd AND D.HostCd = @HostId AND D.StateCd = '99'
 AND D.LineOfBusinessCd = 'BO' AND D.LocationId = '99' AND D.MasterCompanyId = '99' AND D.PolicyCompanyId = '99'*/
    ON B.SafeVaultProtectionCd = E.SafeVaultProtectionCd 
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN BOSelePremProtection F
	/*ON B.PremProtectionCd = F.PremProtectionCd AND D.HostCd = @HostId AND D.StateCd = '99'
 AND D.LineOfBusinessCd = 'BO' AND D.LocationId = '99' AND D.MasterCompanyId = '99' AND D.PolicyCompanyId = '99'*/
    ON B.PremProtectionCd = F.PremProtectionCd 
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	--WHERE B.AppId = @AppID AND B.InsuranceLineCd = 'BOP' and B.AppId = A.AppId and A.ActivitystatusCd not in ('D', 'C')
    WHERE B.AppId = @AppID AND B.InsuranceLineCd = @InsuranceLineCd and B.AppId = A.AppId and A.ActivitystatusCd not in ('D', 'C')
	      and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.StructureNbr	--128507
--TL BOP NY 2010 Ends
Union All
Select
270								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
280								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
290								as Tag,
280								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!], 
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
300								as Tag,
280								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
 B.SafeVaultManufacturerCd					as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM BOPropertyInfo A,BOProtectionInfo B with (nolock)
	LEFT JOIN BOSeleSafeVaultClass C
    --TL BOP NY 2010 Starts
	/*ON B.SafeVaultClassCd = C.SafeVaultClassCd AND C.HostCd = @HostId AND C.StateCd = '99'
 AND C.LineOfBusinessCd = 'BO' AND C.LocationId = '99' AND C.MasterCompanyId = '99' AND C.PolicyCompanyId = '99'*/
    ON B.SafeVaultClassCd = C.SafeVaultClassCd 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')    
	--WHERE B.AppId = @AppID AND B.InsuranceLineCd = 'BOP' and A.AppId = B.AppId and A.ActivitystatusCd not in ('D', 'C')
    WHERE B.AppId = @AppID AND B.InsuranceLineCd = @InsuranceLineCd and A.AppId = B.AppId and A.ActivitystatusCd not in ('D', 'C')
    --TL BOP NY 2010 Ends
	      and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.StructureNbr	--128507
Union All
Select
310								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
320								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), C.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), C.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
case @ACORDCodes
when '1' then B.AcordCd
else A.SafeVaultClassCd
end								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
FROM BOPropertyInfo C,BOProtectionInfo A with (nolock)
	LEFT JOIN BOSeleSafeVaultClass B
	ON A.SafeVaultClassCd = B.SafeVaultClassCd AND B.HostCd = @HostId AND B.StateCd = '99'
 AND B.LineOfBusinessCd = 'BO' AND B.LocationId = '99' AND B.MasterCompanyId = '99' AND B.PolicyCompanyId = '99'
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' and A.AppId = C.AppId and C.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd and A.AppId = C.AppId and C.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
	      and A.LocationNbr=C.LocationNbr and A.BuildingNbr=C.StructureNbr	--128507 
Union All
Select
330								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!], 
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
340								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!], 
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!], 
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
350								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
''								as [Length!350!NumUnits!element],
''								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Union All
Select
360								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
''								as [Width!360!NumUnits!element],
''								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
370								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!], 
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
''								as [Height!370!NumUnits!element],
''								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
380								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!], 
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
''								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
390								as Tag,
270								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!], 
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
''								as [SafeVaultConstruction!390!ComponentTypeCd!element],
''								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
400								as Tag,
390								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
''								as [Thickness!400!NumUnits!element],
''								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
410								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element], 
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
 CONVERT(char, A.PropOwnedAmt) 				as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
Union All
Select
420								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element],
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
isnull(A.SwimmingPoolCntNbr,'')				as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
--don-2576 begin
Union All
Select
425								as Tag,
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element], 
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
A.CondoAssociation					as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
Null								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
Null								as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],       --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],           --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],      --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],         --TL BOP NY 2010
Null								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],     --TL BOP NY 2010        
Null								as [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]  --TL BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_StoreKeeperClassCd!element]  --TP BOP NY 2010
,Null								as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,Null								as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]  --TP BPCA Class Deviation Field 10/19/12 dlh
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBldClass!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh start
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element] 
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]   
,Null								as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --dlh fsit 187326 BPCA Bld Class Field 1/14/12 dlh  end
from BOPropertyInfo A with (nolock)
--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')   --TL BOP NY 2010
--don-2576 end
Union All
Select
430								as Tag, 
10								as Parent,
Null								as [CommlSubLocation!10!],
 'l' + CONVERT(varchar(3), A.LocationNbr)			as [CommlSubLocation!10!LocationRef],
 's' + CONVERT(varchar(3), A.StructureNbr) 			as [CommlSubLocation!10!SubLocationRef],
Null								as [CommlSubLocation!10!InterestCd!element],
Null								as [CommlSubLocation!10!CompanyProductCd!element],
Null								as [CommlSubLocation!10!ContractExpirationDt!element],
Null								as [CommlSubLocation!10!InstallationServiceOrRepairWorkForRetailPct!element],
Null								as [Construction!20!],
Null								as [Construction!20!ConstructionCd!element],
Null								as [Construction!20!InsurerConstructionClassCd!element],
Null								as [Construction!20!ConstructionBeganDt!element],
Null								as [Construction!20!ConstructionEstEndDt!element],
Null								as [ConstructionCostAmt!30!],
Null								as [ConstructionCostAmt!30!Amt!element],
Null								as [YearBuilt!40!],
Null								as [RenovationYear!45!],    --TL BOP NY 2010
Null								as [FoundationCd!50!],
Null								as [BldgCodeEffectivenessGradeCd!60!],
Null								as [BldgEffectivenessGradeTypeCd!70!],
Null								as [BldgArea!80!],
Null								as [BldgArea!80!NumUnits!element],
Null								as [BldgArea!80!UnitMeasurementCd!element],
Null								as [NumStories!90!],
Null								as [NumUnits!100!],
Null								as [BldgProtection!110!],
Null								as [BldgProtection!110!FireProtectionClassCd!element],
Null								as [BldgProtection!110!FireExtinguisherInd!element],
Null								as [BldgProtection!110!ProtectionDeviceBurglarCd!element],
Null								as [BldgProtection!110!ProtectionDeviceFireCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSmokeCd!element],
Null								as [BldgProtection!110!ProtectionDeviceSprinklerCd!element],
Null								as [BldgProtection!110!DoorLockCd!element],
Null								as [BldgProtection!110!SprinkleredPct!element],
--105894 Begins
Null								as [BldgProtection!110!OtherProtectionDesc!element],
Null								as [BldgExposures!115!],
Null								as [BldgExposures!115!DirectionTypeCd!element],
Null								as [BldgExposures!115!Description!element],
--105894 Ends
Null								as [BldgOccupancy!120!],
Null								as [BldgOccupancy!120!NumUnitsOwnerOccupied!element],
Null								as [BldgOccupancy!120!VacantUnoccupiedCd!element],
Null								as [BldgOccupancy!120!OccupiedPct!element], 
 
Null								as [AreaOccupied!130!],
Null								as [AreaOccupied!130!NumUnits!element],
Null								as [AreaOccupied!130!UnitMeasurementCd!element],
Null								as [OccupancyDesc!140!],
Null								as [NatureBusinessCd!150!],
Null								as [OperationsDesc!160!],
Null								as [CrimeInfo!170!],
Null								as [CrimeInfo!170!AvgNumEmployees!element],
Null								as [CrimeInfo!170!DepositFrequencyCd!element],
Null								as [CrimeInfo!170!NightDepositInd!element],
Null								as [AnnualGrossReceiptsAmt!180!],
Null								as [AnnualGrossReceiptsAmt!180!Amt!element],
Null								as [PropertyDesc!190!],
Null								as [MaxPropertyValueAmt!200!],
Null								as [MaxPropertyValueAmt!200!Amt!element],
Null								as [CrimeMoneyAndSecurities!210!],
Null								as [CrimeMoneyAndSecurities!210!MoneyAndSecuritiesCoverageTypeCd!element],
--105894 Begins
 Null								as [MaxExposureAmt!215!],
 Null								as [MaxExposureAmt!215!Amt!element],
 --105894 Ends
Null								as [MoneyAmt!220!],
Null								as [MoneyAmt!220!Amt!element],
Null								as [ChecksAmt!230!],
Null								as [ChecksAmt!230!Amt!element],
Null								as [PayrollAmt!240!],
Null								as [PayrollAmt!240!Amt!element],
Null								as [MoneyOvernightAmt!250!],
Null								as [MoneyOvernightAmt!250!Amt!element],
Null								as [AlarmAndSecurity!260!],
Null								as [AlarmAndSecurity!260!AlarmDescCd!element],
Null								as [AlarmAndSecurity!260!AlarmTypeCd!element],
Null								as [AlarmAndSecurity!260!BulletResistingEnclosureTypeCd!element],
Null								as [AlarmAndSecurity!260!CentralStationInd!element],
Null								as [AlarmAndSecurity!260!ULCertificateExpirationDt!element],
Null								as [AlarmAndSecurity!260!LineSecurityInd!element],
Null								as [AlarmAndSecurity!260!LocalGongInd!element],
Null								as [AlarmAndSecurity!260!MaintenanceContractInd!element],
Null								as [AlarmAndSecurity!260!MonitoredSurveillanceInd!element],
Null								as [AlarmAndSecurity!260!NumGuards!element],
Null								as [AlarmAndSecurity!260!NumWatchPersons!element],
Null								as [AlarmAndSecurity!260!PoliceFireConnectionCd!element],
Null								as [AlarmAndSecurity!260!ProtectionClassGradeCd!element],
Null								as [AlarmAndSecurity!260!ProtectionExtentCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateNumber!element],
Null								as [AlarmAndSecurity!260!WatchPersonsFactorCd!element],
Null								as [AlarmAndSecurity!260!WithKeysInd!element],
Null								as [AlarmAndSecurity!260!AlarmCoverageAreaCd!element],
Null								as [AlarmAndSecurity!260!ULCertificateIssueDt!element],
Null								as [SafeVaultCharacteristics!270!],
Null								as [ItemInfo!280!],
Null								as [ItemIdInfo!290!],
Null								as [ItemIdInfo!290!InsurerId!element],
Null								as [ItemDefinition!300!],
Null								as [ItemDefinition!300!ItemTypeCd!element],
Null								as [ItemDefinition!300!Manufacturer!element],
Null								as [ItemDefinition!300!Model!element],
Null								as [ItemDefinition!300!SerialIdNumber!element],
Null								as [ItemDefinition!300!ModelYear!element],
Null								as [ItemDefinition!300!ItemDesc!element],
Null								as [LabelCd!310!],
Null								as [SafeVaultClassCd!320!],
Null								as [TimeLockInd!330!],
Null								as [RelockingDeviceInd!340!],
Null								as [Length!350!],
Null								as [Length!350!NumUnits!element], 
Null								as [Length!350!UnitMeasurementCd!element],
Null								as [Width!360!],
Null								as [Width!360!NumUnits!element],
Null								as [Width!360!UnitMeasurementCd!element],
Null								as [Height!370!],
Null								as [Height!370!NumUnits!element],
Null								as [Height!370!UnitMeasurementCd!element],
Null								as [NumOpenings!380!],
Null								as [SafeVaultConstruction!390!],
Null								as [SafeVaultConstruction!390!ComponentTypeCd!element],
Null								as [SafeVaultConstruction!390!ConstructionCd!element],
Null								as [Thickness!400!],
Null								as [Thickness!400!NumUnits!element],
Null								as [Thickness!400!UnitMeasurementCd!element],
Null								as [com.csc_PropertyOwnedByOther!410!],
Null								as [com.csc_NumSwimmingPools!420!],
Null								as [com.csc_CondoAssociation!425!], --don-2576
Null								as [com.csc_SubLocationInfo!430!],
--TL FSIT 144196 issue #92 10/12/2012 Starts
CASE @InsuranceLineCd
WHEN 'CBP' THEN
	Case @ACORDCodes 
		when '0' then substring(LTRIM(RTRIM(A.TerritoryCd)), 1, 3)	--TP BOP NY 2010
		when '1' then ''
		when '2' then T.TerritoryDes
	end	
ELSE	
	Case @ACORDCodes 
		when '0' then LTRIM(RTRIM(A.TerritoryCd))	--TP BOP NY 2010
		when '1' then ''
		when '2' then T.TerritoryDes
	end	
end								as [com.csc_SubLocationInfo!430!TerritoryCd!element],
--TL FSIT 144196 issue #92 10/12/2012 Ends
Case @ACORDCodes 
when '0' then A.RateNumberCd	
when '1' then ''
when '2' then J.RateNumberDes	
end								as [com.csc_SubLocationInfo!430!com.csc_ContentsRateGroupCd!element],
Case @ACORDCodes 
--DON00084 when '0' then A.RateGroupCd	
--DON00084 when '1' then ''
--DON00084 when '2' then H.RateGroupDes
when '0' then A.RateNumberCd	--DON00084
when '1' then ''				--DON00084
when '2' then J.RateNumberDes	--DON00084	
end								as [com.csc_SubLocationInfo!430!com.csc_ClassRateGroupCd!element],
ltrim(rtrim(A.RateGroupCd))     as [com.csc_SubLocationInfo!430!com.csc_RateGroupCd!element],           --TL BOP NY 2010
ltrim(rtrim(A.PropertyRateNumberCd))     as [com.csc_SubLocationInfo!430!com.csc_PropertyRateNumberCd!element],           --TL BOP NY 2010
Case When @ACORDCodes = '1' then ''
	else A.ShuttersInd	
end								as [com.csc_SubLocationInfo!430!StormShuttersCd!element],
Case When @ACORDCodes = '1' then ''
	else A.WindHailInd	
end								as [com.csc_SubLocationInfo!430!com.csc_WindHailDeductiblePct!element],
CASE @StateCd
	WHEN 'NY' THEN
		CASE WindHailInd
			WHEN '1' THEN 'Y'
			ELSE 'N'
		END
	ELSE
		WindHailInd				--TP BPCA 2010 Move value
END                             as [com.csc_SubLocationInfo!430!com.csc_OptWindHailDeductInd!element],   --TL BOP NY 2010
CASE TerrorismInd
    WHEN '1' THEN 'Y'
    ELSE 'N'
END                             as [com.csc_SubLocationInfo!430!com.csc_TerrorismInd!element],           --TL BOP NY 2010
CASE WindstormProtectiveInd
    WHEN '1' THEN 'Y'
    ELSE 'N'
END								as [com.csc_SubLocationInfo!430!com.csc_WindProtDevInd!element],         --TL BOP NY 2010
--TL BOP CA 2010 Starts
CASE @StateCd
	WHEN 'CA' THEN		
		(Select Convert(char(1), TerrorismExclusionInd) from BOInsuranceLine with (nolock) where appid = @AppId)
	WHEN 'NY' THEN
		Convert(char(1),A.TerrorismPropTerrCd) 
END 
as [com.csc_SubLocationInfo!430!com.csc_PropTerrCd!element],             --TL BOP NY 2010
--TL BOP CA 2010 Ends
CASE EmploymentLiabilityInd
    WHEN '1' THEN 'Y'
    ELSE 'N'
END								as [com.csc_SubLocationInfo!430!com.csc_EmptLiabInd!element],            --TL BOP NY 2010
ltrim(rtrim(A.LiabClassGroupCd))		as [com.csc_SubLocationInfo!430!com.csc_LiabClassGroupCd!element],            --TL BOP NY 2010
ltrim(rtrim(A.PersonalPropertyBlanketTypeCd))		as [com.csc_SubLocationInfo!430!com.csc_BlanketBPPCd!element],            --TL BOP NY 2010
ltrim(rtrim(A.BuildingBlanketTypeCd))		as [com.csc_SubLocationInfo!430!com.csc_BlanketBuildingCd!element],             --TL BOP NY 2010
ltrim(rtrim(A.LiabDeductAmt))		as [com.csc_SubLocationInfo!430!com.csc_LiabDeductAmt!element],            --TL BOP NY 2010
ltrim(rtrim(A.LiabDeductType))		as [com.csc_SubLocationInfo!430!com.csc_LiabDeductType!element],            --TL BOP NY 2010
CASE A.LargeRestaurantInd
    WHEN '1' THEN 'Y'
    ELSE 'N'
END								as [com.csc_SubLocationInfo!430!com.csc_LargeRestaurantInd!element],         --TL BOP NY 2010
--TP Mapping TENANT START
CASE @StateCd
	WHEN 'CA' THEN
		(Select ltrim(rtrim(FieldValueTxt)) from SHCoverageDetailItems where  Appid = @Appid and FieldNameTxt='Tenants_Improvements_Limit'
			AND LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)	--TP 01182013 add AND LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr per fsit #147392
	WHEN 'NY' THEN
		ltrim(rtrim(A.TenantsImprovementsCov))		
END AS [com.csc_SubLocationInfo!430!com.csc_TenantsImprovementsCov!element]            --TL BOP NY 2010
--TP Mapping TENANT END
,
CASE @LOB 
     WHEN 'BP' THEN
           ltrim(rtrim((Select Top 1 LiabilityExposureBasis from BPSeleClassCodes  bCC --fsit 144130
			Where ClassCd = A.ClassCd And bCC.StateCd=@StateCd)))			
	 WHEN 'BO' THEN
	        ltrim(rtrim((Select Top 1 RateNbr from BOSeleClassCodes  bCC --fsit 144130
			Where ClassCd = A.ClassCd And bCC.StateCd=@StateCd)))	
END		as [com.csc_SubLocationInfo!430!com.csc_LiabilityBase!element]            --TL BOP NY 2010 fsit 144130
,
CASE @LOB 
     WHEN 'BP' THEN
            ltrim(rtrim((Select Top 1 StoreKeeperClassCd from BPSeleClassCodes  bCC
			Where ClassCd = A.ClassCd And bCC.StateCd=@StateCd)))			
     WHEN 'BO' THEN
            ltrim(rtrim((Select Top 1 StoreKeeperClassCd from BOSeleClassCodes  bCC
			Where ClassCd = A.ClassCd And bCC.StateCd=@StateCd)))		
END		as [com.csc_SubLocationInfo!430!csc_StoreKeeperClassCd!element]            --TL BOP NY 2010 fsit 144130
,
CASE (Select TOP 1 RTRIM(SwimmingPoolInd) From  BOPropertyInfo Where AppId = @AppId)
	WHEN 1 THEN 'Y'
	WHEN 0 THEN 'N'
END	as [com.csc_SubLocationInfo!430!com.csc_SwimmingPoolInd!element]  --TP BPCA Functional Building Valuation
,
CASE @StateCd
	WHEN 'CA' THEN
		(Select RTRIM(ISNULL(FieldValueTxt, '')) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'Susceptibility' and LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)
	ELSE ''
END	as [com.csc_SubLocationInfo!430!com.csc_SPKLEQSusceptibility!element]  --TP BPCA SPKLEQ Susceptibility Field
,
-- BPCA 10/19/12 Class Deviation dlh start 
CASE @LOB 
     WHEN 'BP' THEN
           ltrim(rtrim((Select Top 1 SpecialMedPayInd from BPSeleClassCodes  bCC 
			Where ClassCd = A.ClassCd And bCC.StateCd=@StateCd)))			
	 WHEN 'BO' THEN
	        ltrim(rtrim((Select Top 1 SpecialMedPayInd from BOSeleClassCodes  bCC 
			Where ClassCd = A.ClassCd And bCC.StateCd=@StateCd)))	
END		as [com.csc_SubLocationInfo!430!com.csc_ClassDevation!element]            
-- BPCA 10/19/12 Class Deviation dlh start 
,
CASE @StateCd
	WHEN 'CA' THEN
		(Select  RTRIM(ISNULL(FieldValueTxt, '')) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'EQBuildingClass' and LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)
    ELSE ''		
END	as [com.csc_SubLocationInfo!430!com.csc_SPKLEQBuildingClass!element]  --TP BPCA SPKLEQ Susceptibility Field
,
CASE @StateCd
	WHEN 'CA' THEN
		(Select  substring(RTRIM(ISNULL(FieldValueTxt, '')),1,2) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'EQDedTier' and LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)
	ELSE ''
END	as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedTier!element]  --TP BPCA SPKLEQ Susceptibility Field
,    
CASE @StateCd
	WHEN 'CA' THEN
		(Select  RTRIM(ISNULL(FieldValueTxt, '')) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'EQDedPercent' and LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)
	ELSE ''
END	as [com.csc_SubLocationInfo!430!com.csc_SPKLEQDedPer!element]  --TP BPCA SPKLEQ Susceptibility Field
,  
CASE @StateCd
	WHEN 'CA' THEN
		(Select  RTRIM(ISNULL(FieldValueTxt, '')) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'EQConstruction' and LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)
	ELSE ''
END	as [com.csc_SubLocationInfo!430!com.csc_SPKLEQConstr!element]  --TP BPCA SPKLEQ Susceptibility Field
,   
CASE @StateCd
	WHEN 'CA' THEN
		(Select  RTRIM(ISNULL(FieldValueTxt, '')) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'Territory' and LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)
	ELSE ''
END	as [com.csc_SubLocationInfo!430!com.csc_SPKLEQTerr!element]  
,
CASE @StateCd
	WHEN 'CA' THEN
		(Select  RTRIM(ISNULL(FieldValueTxt, '')) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'Group' and LocationNbr = A.LocationNbr AND BuildingNbr = A.StructureNbr)
	ELSE ''
END						as [com.csc_SubLocationInfo!430!com.csc_SPKLEQGroup!element]    
,
CASE @StateCd
	WHEN 'CA' THEN
		(Select  RTRIM(ISNULL(FieldValueTxt, '')) From SHCoverageDetailItems Where  Appid = @AppId And CoverageCd = 'SPKLEQ' And FieldNameTxt = 'EQNbrStories' and LocationNbr = B.LocationNbr AND BuildingNbr = B.BuildingNbr)
	ELSE ''
END	 as [com.csc_SubLocationInfo!430!com.csc_SPKLEQNbrStor!element]  --TP BPCA SPKLEQ Susceptibility Field
FROM 	BOPropertyInfo A with (nolock)
	LEFT JOIN
	 BOProtectionInfo B with (nolock)
		--ON A.AppId = B.AppId AND B.InsuranceLineCd = 'BOP' AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr       --TL BOP NY 2010
        ON A.AppId = B.AppId AND B.InsuranceLineCd = @InsuranceLineCd AND A.LocationNbr = B.LocationNbr AND A.StructureNbr = B.BuildingNbr     --TL BOP NY 2010
	LEFT JOIN
	BOSeleProtectionClass C
    --TL BOP NY 2010 Starts
		/*ON C.HostCd=@HostId AND C.LocationId='99' AND C.MasterCompanyId='99' AND C.PolicyCompanyId='99' 
				 AND C.ProtectionClassCd=A.ProtectionClassCd*/
    ON C.ProtectionClassCd=A.ProtectionClassCd                 
    AND C.HostCd = @HostId 
    AND (C.StateCd = '99' OR C.StateCd=@StateCd)
    AND C.LineOfBusinessCd = @LOB 
    AND (C.LocationId=@LocationId OR C.LocationId = '99') 
    AND (C.MasterCompanyId=@MasterCompanyId OR C.MasterCompanyId = '99')
    AND (C.PolicyCompanyId=@PolicyCompanyId OR C.PolicyCompanyId = '99')
	LEFT JOIN SHSeleConstruction D
		/*ON D.HostCd=@HostId AND D.LocationId='99' AND D.MasterCompanyId='99' AND D.PolicyCompanyId='99' 
				 AND D.LineOfBusinessCd='BO' AND D.ConstructionCd=A.ConstructionCd*/
    ON D.ConstructionCd=A.ConstructionCd                 
    AND D.HostCd = @HostId 
    AND (D.StateCd = '99' OR D.StateCd=@StateCd)
    AND D.LineOfBusinessCd = @LOB 
    AND (D.LocationId=@LocationId OR D.LocationId = '99') 
    AND (D.MasterCompanyId=@MasterCompanyId OR D.MasterCompanyId = '99')
    AND (D.PolicyCompanyId=@PolicyCompanyId OR D.PolicyCompanyId = '99')
	LEFT JOIN BOSeleBurglarAlarmInd E
		/*ON E.HostCd=@HostId AND E.LocationId='99' AND E.MasterCompanyId='99' AND E.PolicyCompanyId='99' 
				 AND E.LineOfBusinessCd='BO' AND E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd*/
    ON E.BurglarAlarmIndTypeCd=A.BurglarAlarmInd
    AND E.HostCd = @HostId 
    AND (E.StateCd = '99' OR E.StateCd=@StateCd)
    AND E.LineOfBusinessCd = @LOB 
    AND (E.LocationId=@LocationId OR E.LocationId = '99') 
    AND (E.MasterCompanyId=@MasterCompanyId OR E.MasterCompanyId = '99')
    AND (E.PolicyCompanyId=@PolicyCompanyId OR E.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEG F
		/*ON F.HostCd=@HostId AND F.LocationId='99' AND F.MasterCompanyId='99' AND F.PolicyCompanyId='99' 
				 AND F.LineOfBusinessCd='BO' AND F.BCEGCd=A.BCEGCd*/
    ON F.BCEGCd=A.BCEGCd
    AND F.HostCd = @HostId 
    AND (F.StateCd = '99' OR F.StateCd=@StateCd)
    AND F.LineOfBusinessCd = @LOB 
    AND (F.LocationId=@LocationId OR F.LocationId = '99') 
    AND (F.MasterCompanyId=@MasterCompanyId OR F.MasterCompanyId = '99')
    AND (F.PolicyCompanyId=@PolicyCompanyId OR F.PolicyCompanyId = '99')
	LEFT JOIN SHSeleBCEGType G
		/*ON G.HostCd=@HostId AND G.LocationId='99' AND G.MasterCompanyId='99' AND G.PolicyCompanyId='99' 
				 AND G.LineOfBusinessCd='BO' AND G.BCEGTypeCd=A.BCEGTypeCd*/
    ON G.BCEGTypeCd=A.BCEGTypeCd
    AND G.HostCd = @HostId 
    AND (G.StateCd = '99' OR G.StateCd=@StateCd)
    AND G.LineOfBusinessCd = @LOB 
    AND (G.LocationId=@LocationId OR G.LocationId = '99') 
    AND (G.MasterCompanyId=@MasterCompanyId OR G.MasterCompanyId = '99')
    AND (G.PolicyCompanyId=@PolicyCompanyId OR G.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRateGroup H
		/*ON H.HostCd=@HostId AND H.LocationId='99' AND H.MasterCompanyId='99' AND H.PolicyCompanyId='99' 
				 AND H.LineOfBusinessCd='BO' AND H.RateGroupCd=A.RateGroupCd*/
    ON H.RateGroupCd=A.RateGroupCd
    AND H.HostCd = @HostId 
    AND (H.StateCd = '99' OR H.StateCd=@StateCd)
    AND H.LineOfBusinessCd = @LOB 
    AND (H.LocationId=@LocationId OR H.LocationId = '99') 
    AND (H.MasterCompanyId=@MasterCompanyId OR H.MasterCompanyId = '99')
    AND (H.PolicyCompanyId=@PolicyCompanyId OR H.PolicyCompanyId = '99')
	LEFT JOIN BOSeleRateNumber J
		/*ON J.HostCd=@HostId AND J.LocationId='99' AND J.MasterCompanyId='99' AND J.PolicyCompanyId='99' 
				 AND J.LineOfBusinessCd='BO' AND J.RateNumberCd=A.RateNumberCd*/
    ON J.RateNumberCd=A.RateNumberCd
    AND J.HostCd = @HostId 
    AND (J.StateCd = '99' OR J.StateCd=@StateCd)
    AND J.LineOfBusinessCd = @LOB 
    AND (J.LocationId=@LocationId OR J.LocationId = '99') 
    AND (J.MasterCompanyId=@MasterCompanyId OR J.MasterCompanyId = '99')
    AND (J.PolicyCompanyId=@PolicyCompanyId OR J.PolicyCompanyId = '99')
	LEFT JOIN SHSeleOccupancy K
		/*ON K.HostCd=@HostId AND K.LocationId='99' AND K.MasterCompanyId='99' AND K.PolicyCompanyId='99' 
				 AND K.LineOfBusinessCd='BO' AND K.OccupancyCd=A.OccupancyCd*/
    ON K.OccupancyCd=A.OccupancyCd
    AND K.HostCd = @HostId 
    AND (K.StateCd = '99' OR K.StateCd=@StateCd)
    AND K.LineOfBusinessCd = @LOB 
    AND (K.LocationId=@LocationId OR K.LocationId = '99') 
    AND (K.MasterCompanyId=@MasterCompanyId OR K.MasterCompanyId = '99')
    AND (K.PolicyCompanyId=@PolicyCompanyId OR K.PolicyCompanyId = '99')
	LEFT JOIN BOSeleSprinkler L
		/*ON L.HostCd=@HostId AND L.LocationId='99' AND L.MasterCompanyId='99' AND L.PolicyCompanyId='99' 
				 AND L.LineOfBusinessCd='BO' AND L.SprinklerCd=A.SprinklerInd*/
    ON L.SprinklerCd=A.SprinklerInd
    AND L.HostCd = @HostId 
    AND (L.StateCd = '99' OR L.StateCd=@StateCd)
    AND L.LineOfBusinessCd = @LOB 
    AND (L.LocationId=@LocationId OR L.LocationId = '99') 
    AND (L.MasterCompanyId=@MasterCompanyId OR L.MasterCompanyId = '99')
    AND (L.PolicyCompanyId=@PolicyCompanyId OR L.PolicyCompanyId = '99')
	LEFT JOIN SHSeleRiskType M
		/*ON M.HostCd=@HostId AND M.LocationId='99' AND M.MasterCompanyId='99' AND M.PolicyCompanyId='99' 
				 AND M.LineOfBusinessCd='BO' AND M.RiskTypeCd=A.RiskTypeCd*/
    ON M.RiskTypeCd=A.RiskTypeCd
    AND M.HostCd = @HostId 
    AND (M.StateCd = '99' OR M.StateCd=@StateCd)
    AND M.LineOfBusinessCd = @LOB 
    AND (M.LocationId=@LocationId OR M.LocationId = '99') 
    AND (M.MasterCompanyId=@MasterCompanyId OR M.MasterCompanyId = '99')
    AND (M.PolicyCompanyId=@PolicyCompanyId OR M.PolicyCompanyId = '99')
	LEFT JOIN SHPropertyLocation S with (nolock)
		ON S.AppId=@AppId AND S.LocationNbr=A.LocationNbr
	LEFT JOIN SHSeleTerritoryCodes T
		--ON T.HostCd=@HostID AND T.LineOfBusinessCd='BO' AND T.StateCd=S.StateCd AND A.TerritoryCd=T.TerritoryCd
        ON A.TerritoryCd=T.TerritoryCd
        AND T.HostCd = @HostId 
        AND (T.StateCd = '99' OR T.StateCd=@StateCd)
        AND T.LineOfBusinessCd = @LOB
    --TL BOP NY 2010 Ends    
	--WHERE A.AppId = @AppID AND A.InsuranceLineCd = 'BOP' AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
    WHERE A.AppId = @AppID AND A.InsuranceLineCd = @InsuranceLineCd AND A.ActivityStatusCd<>'D' AND A.ActivitystatusCd not in ('D', 'C')     --TL BOP NY 2010
Order By [CommlSubLocation!10!LocationRef],[CommlSubLocation!10!SubLocationRef],Tag
For Xml Explicit

GRANT EXECUTE ON [dbo].[ACORDXMLBORetrieveCommlSubLocation] TO [isol_app] AS [dbo]

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[BORetrieveInsLinecoverages]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[BORetrieveInsLinecoverages]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

-- FSIT 117502 - Requirement 1.05 - This stored procedire was completely re writtern to implement Insruance Line coverage using generic approach.
-- Author - Abhinav Khare
CREATE Procedure [dbo].[BORetrieveInsLinecoverages]
/* Parms sent to stored procedure */
@AppId char(20) = Null,
@LOB varchar(3) ,
@LocationId char(2),
@MasterCompanyId char(2),
@PolicyCompanyId char(2), 
@InsuranceLineCd char(3),
@State char(2) = null,
@ScreenName varchar(40) = Null,
@Host char(2) = null,
@LocationNumber smallint =0,--DON00001 changed to 0
@LocationCount smallint= Null, 
@ClientNumber smallint= 1,
@ClientCount smallint= Null,
@UnitNumber smallint= 1,
@UnitCount smallint=Null,
@PrimaryState char(2) =Null,
@DelAppId char(20)=null ,
/*Insurance Line */
@MedicalExpenseAmt decimal(9) =0,
@PerOccurrenceAmt decimal(9) = 0,
@FireLiabilityAmt decimal(9) = 0,
@GenAggregateAmt decimal(9) =0,
@ProdAggregateAmt decimal(9) = 0,
@AuditFreqCd char(1) = 'A',
@AuditTypeCd char(1) ='A',
@FormCodeCd char(3) ='ST'
,@InsLineCovInd bit = 0 --DON00001
,@IsUnderwriter bit = 1 --DON00001
--TP 137508 START
/*
,@MedicalExpExclusionInd char(1) ='0', 
@AssaultBatExclustionInd char(1) ='0', 
@BlanketRatingInd char(1) ='0', 
@TerrorismInd char(1) ='0', 
@LiquorComCauLimit decimal(9) = 0, 
@LiquorAggLimit decimal(9) = 0
*/
--TP 137508 END
As
Set nocount on
Declare @CoverageCount smallint, @error int,@TotalExposureAmtValue varchar(20) ,@AllSitesIndCode char(1),
@AllSitesIndValue varchar(20),@AmountCode char(11)
Declare @TempLocationId char(2)
Declare @TempMasterCompanyId char(2)
Declare @TempPolicyCompanyId char(2)
Declare @Count smallint
Declare @TempPrimaryState char(2) 
Set @PrimaryState = (Select RiskState from SHPlanInfo where appid= @AppId)
Set @TempPrimaryState = @PrimaryState 
DECLARE @RestaurantInd CHAR(1)	--DON00011
Declare @PolicyStatusCd char(1)
Declare @AmendXTransDt datetime
Declare @AmendXEffDt datetime
Declare @AmendXExpDt datetime
Declare @AmendXLastTransDt datetime
--TP BOP NY 2010, check validateion on Ins Line, (Liability) screen START
Declare @TerrorismInd CHAR(1)		
select TOp 1 @TerrorismInd = TerrorismInd from  BOPropertyInfo
Where AppId = @AppId
--TP BOP NY 2010, check validateion on Ins Line, (Liability) screen END

--don-2576 begin
Declare @effdate as date
select @effdate=effectivedate from shplaninfo where appid=@AppId
--don-2576 end

 Select @PolicyStatusCd = PolicyStatusCd,
	@AmendXTransDt = TransactionEffectiveDt,
	@AmendXEffDt = EffectiveDate,
	@AmendXExpDt = ExpirationDate,
	@AmendXLastTransDt = LastTransactionEffectiveDt
	 FROM SHPlanInfo WHERE AppId = @AppId
--If @InsuranceLineCd = '' 		--TL FSIT 144098 
--Begin							--TL FSIT 144098 	
	--Set @InsuranceLineCd = 'BOP'  --TL BOP NY 2010
    select @InsuranceLineCd=WCLineOfBusiness from SHPlanInfo (nolock) where appid=@AppId    --TL BOP NY 2010
--End							--TL FSIT 144098 
Set @TempLocationId= @LocationId
Set @TempMasterCompanyId = @MasterCompanyId
Set @TempPolicyCompanyId = @PolicyCompanyId
/* Pull Per OccurrenceAmount */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
	Set @PrimaryState = @TempPrimaryState 
 Select top 1 @LocationId=LocationId,@MasterCompanyId=MasterCompanyId,@PolicyCompanyId=PolicyCompanyId,@PrimaryState=State
	from SHSeleCovAmount with (index(IX_SHSeleCovAmount),nolock) 
	where Host=@Host and 
	(Locationid=@LocationId or Locationid='99' ) and 
	(Mastercompanyid=@MasterCompanyId or Mastercompanyid='99' ) and 
	(Policycompanyid=@PolicyCompanyId or Policycompanyid='99') and
	LOB=@LOB and (State=@PrimaryState or State='99') and CoverageCode = 'OCC'
	ORDER BY State DESC, Locationid,Mastercompanyid,Policycompanyid
select Rtrim(Code) as PerOccurrenceAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
where Host = @Host
and LocationId = @LocationId
and MasterCompanyId = @MasterCompanyId
and PolicyCompanyId = @PolicyCompanyId
and (State = @PrimaryState )
and LOB = @Lob 
and CoverageCode = 'OCC'
ORDER BY SortOrder
/*Pull FireLegal Limit Amount */
/*TP 137508 START*/
--If @PrimaryState = 'NY'		--TL FSIT 144098
If @LOB = 'BP'					--TL FSIT 144098
Begin
  --fsit 240038 dlh start
     If @PrimaryState = 'NY'
	    begin
			 declare @EffectiveDt datetime
			 set @EffectiveDt = (select effectivedate from shplaninfo with (nolock) where appid = @appid)
			 if @EffectiveDt < convert(datetime,'08/01/2016') 	 
				   if (select count(*) from SHCoverageDetails with (nolock) where AppId =@appid and  coveragecd = 'MECHBD') = 0 
					   Exec SHInsertCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, 0, 0, @LOB, @InsuranceLineCd, @TempPrimaryState, 'MECHBD'
			 if @EffectiveDt > convert(datetime,'07/31/2016') 	 
				   if (select count(*) from shcoverageDetails with (nolock) where appid = @Appid and coveragecd = 'MECHBD') > 0 
					  Begin 
						delete from shcoverageDetails where appid = @appid and coveragecd = 'MECHBD'
						delete from SHCoverageDetailitems where  AppId = @appid and coveragecd = 'MECHBD'
					  end 			   		
		  --fsit 240038 dlh end
         end
	select Rtrim(Code) as MedExpAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
	where Host = @Host
	and LocationId = @LocationId
	and MasterCompanyId = @MasterCompanyId
	and PolicyCompanyId = @PolicyCompanyId
	and (State = @PrimaryState )
	and LOB = @Lob 
	and CoverageCode = 'GEN'
	ORDER BY SortOrder
	--FSIT 144150 start PP
	If @MasterCompanyId = '02'
	Begin
		select Rtrim(Code) as OpeAggAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
		where Host = @Host
		and LocationId = @LocationId
		and MasterCompanyId = @MasterCompanyId
		and PolicyCompanyId = @PolicyCompanyId
		and (State = @PrimaryState )
		and LOB = @Lob 
		and CoverageCode = 'PRO'
		ORDER BY SortOrder
	End
	Else
	Begin
		select Rtrim(Code) as PersonalInjuryAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
		where Host = @Host
		and LocationId = @LocationId
		and MasterCompanyId = @MasterCompanyId
		and PolicyCompanyId = @PolicyCompanyId
		and (State = @PrimaryState )
		and LOB = @Lob 
		and CoverageCode = 'PRO'
		ORDER BY SortOrder
	End
	--FSIT 144150 end PP
/*
	select '' as LiqComAmt, '' as LimitValue1, '' as SortOrder
	UNION
	select Rtrim(Code) as LiqComAmt, Rtrim(LimitValue1), SortOrder from SHSeleCovAmount with (nolock) 
	where Host = @Host
	and LocationId = @LocationId
	and MasterCompanyId = @MasterCompanyId
	and PolicyCompanyId = @PolicyCompanyId
	and (State = @PrimaryState )
	and LOB = @Lob 
	and CoverageCode = 'LCL'
	ORDER BY SortOrder
	select '' as LiqAggAmt, '' as LimitValue1, '' as SortOrder
	UNION 
	select Rtrim(Code) as LiqAggAmt, Rtrim(LimitValue1), SortOrder from SHSeleCovAmount with (nolock) 
	where Host = @Host
	and LocationId = @LocationId
	and MasterCompanyId = @MasterCompanyId
	and PolicyCompanyId = @PolicyCompanyId
	and (State = @PrimaryState )
	and LOB = @Lob 
	and CoverageCode = 'LAL'
	ORDER BY SortOrder
*/
	print @InsuranceLineCd
	print @PrimaryState
	Select LookupValueCd, LookupValueDesc  from SHSeleLookupValues
	Where InsuranceLineCd =@InsuranceLineCd and LookupCd ='TERRTIER'	--TL FSIT 144098
	and (StateCd = @PrimaryState )										--TL FSIT 144098
	Order By SortOrderNbr
END
/*TP 137508 END*/
/*DON00011 Begin*/
IF @Host = 'S2' 
BEGIN
	set @LocationId = @TempLocationId
	set @MasterCompanyId = @TempMasterCompanyId
	set @PolicyCompanyId = @TempPolicyCompanyId
	Set @PrimaryState = @TempPrimaryState 
	Select top 1 @LocationId=LocationId,@MasterCompanyId=MasterCompanyId,@PolicyCompanyId=PolicyCompanyId,@PrimaryState=State
	from SHSeleCovAmount with (index(IX_SHSeleCovAmount),nolock) 
	where Host=@Host and 
	(Locationid=@LocationId or Locationid='99' ) and 
	(Mastercompanyid=@MasterCompanyId or Mastercompanyid='99') and 
	(Policycompanyid=@PolicyCompanyId or Policycompanyid='99') and
	LOB=@LOB and (State=@PrimaryState or State='99') and CoverageCode = 'FIR'
	ORDER BY State DESC, Locationid,Mastercompanyid,Policycompanyid
	/********39373 END****************/
	select Rtrim(Code) as FireLiabilityAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
	where Host = @Host
	and LocationId = @LocationId
	and MasterCompanyId = @MasterCompanyId
	and PolicyCompanyId = @PolicyCompanyId
	and (State = @PrimaryState ) 
	and LOB = @Lob 
	and CoverageCode = 'FIR'
END
/*Pull General Aggregate Limit Amount */
/*set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
	Set @PrimaryState = @TempPrimaryState 
	Select top 1 @LocationId=LocationId,@MasterCompanyId=MasterCompanyId,@PolicyCompanyId=PolicyCompanyId,@PrimaryState=State
	from SHSeleCovAmount with (index(IX_SHSeleCovAmount),nolock) 
	where Host=@Host and 
	(Locationid=@LocationId or Locationid='99') and 
	(Mastercompanyid=@MasterCompanyId or Mastercompanyid='99' ) and 
	(Policycompanyid=@PolicyCompanyId or Policycompanyid='99') and
	LOB=@LOB and (State=@PrimaryState or State='99') and CoverageCode = 'GEN'
	ORDER BY State DESC, Locationid,Mastercompanyid,Policycompanyid
select Rtrim(Code) as GenAggregateAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
where Host = @Host
and LocationId = @LocationId
and MasterCompanyId = @MasterCompanyId
and PolicyCompanyId = @PolicyCompanyId
and (State = @PrimaryState ) 
and LOB = @Lob 
and CoverageCode = 'GEN'*/
/*Pull Product Aggregate Limit Amount */
/*set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
	Set @PrimaryState = @TempPrimaryState 
	Select top 1 @LocationId=LocationId,@MasterCompanyId=MasterCompanyId,@PolicyCompanyId=PolicyCompanyId,@PrimaryState=State
	from SHSeleCovAmount with (index(IX_SHSeleCovAmount),nolock) 
	where Host=@Host and 
	(Locationid=@LocationId or Locationid='99') and 
	(Mastercompanyid=@MasterCompanyId or Mastercompanyid='99' ) and 
	(Policycompanyid=@PolicyCompanyId or Policycompanyid='99') and
	LOB=@LOB and (State=@PrimaryState or State='99') and CoverageCode = 'PRO'
	ORDER BY State DESC, Locationid,Mastercompanyid,Policycompanyid
Select Rtrim(Code) as ProdAggregateAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
where Host = @Host
and LocationId = @LocationId
and MasterCompanyId = @MasterCompanyId and PolicyCompanyId = @PolicyCompanyId
and (State = @PrimaryState )
and LOB = @Lob 
and CoverageCode = 'PRO'*/
/*DON00011 End*/
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
	Set @PrimaryState = @TempPrimaryState 
	Select top 1 @LocationId=LocationId,@MasterCompanyId=MasterCompanyId,@PolicyCompanyId=PolicyCompanyId,@PrimaryState=State
	from SHSeleCovAmount with (index(IX_SHSeleCovAmount),nolock) 
	where Host=@Host and 
	(Locationid=@LocationId or Locationid='99') and 
	(Mastercompanyid=@MasterCompanyId or Mastercompanyid='99' ) and 
	(Policycompanyid=@PolicyCompanyId or Policycompanyid='99') and
	LOB=@LOB and (State=@PrimaryState or State='99') and CoverageCode = 'MED'
	ORDER BY State DESC, Locationid,Mastercompanyid,Policycompanyid
select Rtrim(Code) as MedicalExpenseAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
where Host = @Host
and LocationId = @LocationId
and (MasterCompanyId = @MasterCompanyId or MasterCompanyId = '99')
and (PolicyCompanyId = @PolicyCompanyId or PolicyCompanyId = '99')
and (State = @PrimaryState )
and LOB = @Lob 
and CoverageCode = 'MED'
and code <> '0'		--TL BOP CA 2010 Post live issue 42
order by sortorder	--TL BOP CA 2010 Post live issue 42
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
--TP 137508 START
--DON00011 Begin
--IF @Host = 'PT' and @PrimaryState <> 'NY'	--TL FSIT 144098
IF @Host = 'PT' and @LOB <> 'BP'			--TL FSIT 144098
-- TP 137508 END
BEGIN
	SELECT TerrorismCoverageCd, TerrorismCoverageDes
	FROM SHSeleTerrorismCoverage
	WHERE HostCd = @Host
		AND LocationId IN (@LocationId, '99')
		AND PolicyCompanyId IN (@PolicyCompanyId, '99')
		AND MasterCompanyId IN (@MasterCompanyId, '99')		
		AND StateCd IN (@PrimaryState, '99')
	ORDER BY SortOrderNbr
END
--DON00012 Begin
/*IF EXISTS(SELECT 1 FROM BOSeleClassCodes
	INNER JOIN BOPropertyInfo ON
		BOSeleClassCodes.ClassCd = BOPropertyInfo.ClassCd
		AND BOSeleClassCodes.ClassDescription = BOPropertyInfo.ClassDes
		AND AppId = @AppId
	WHERE HostCd = @Host
		AND LocationId IN (@LocationId, '99')
		AND PolicyCompanyId IN (@PolicyCompanyId, '99')
		AND MasterCompanyId IN (@MasterCompanyId, '99')		
		AND StateCd IN (@PrimaryState, '99')
		AND PMACd <> 'RS')*/
IF EXISTS(SELECT 1 FROM BOPropertyInfo
			WHERE AppId = @AppId
			AND RiskTypeCd = 'RS')
BEGIN
	SET @FireLiabilityAmt = 1000000
	SET @RestaurantInd = 1
END
ELSE
BEGIN
	SET @FireLiabilityAmt = 300000
	SET @RestaurantInd = 0
END
--DON00012 End
--DON00011 End
set @count = ( select count(*) from BOInsuranceLine with (nolock) where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd)
if @count = 0 
begin
	/*TP 137508 START*/	
	--If @PrimaryState = 'NY'	--TL FSIT 144098
	If @LOB = 'BP'				--TL FSIT 144098
	Begin	
		--FSIT 144150 start PP
		If @MasterCompanyId = '01'
		Begin
			Insert into BOInsuranceLine (AppId,InsuranceLineCd,PerOccurrenceAmt,GenAggregateAmt,ProdAggregateAmt,AuditTypeCd,AuditFreqCd,
			FormCodeCd,PersonalInjuryAmt,AdvertisingInjuryAmt,FireLiabilityAmt, MedicalExpExclusionInd, AssaultBatExclustionInd, BlanketRatingInd, TerrorismInd, LiquorComCauLimit, LiquorAggLimit) 
			values (@AppId,@InsuranceLineCd,300000,600000,600000,@AuditTypeCd,@AuditFreqCd,
			@FormCodeCd,300000,300000,0,'0', '0', '0', 0, 0, 0)
		End
		Else
		Begin
			Insert into BOInsuranceLine (AppId,InsuranceLineCd,PerOccurrenceAmt,GenAggregateAmt,ProdAggregateAmt,AuditTypeCd,AuditFreqCd,
			FormCodeCd,FireLiabilityAmt, MedicalExpExclusionInd, AssaultBatExclustionInd, BlanketRatingInd, TerrorismInd, LiquorComCauLimit, LiquorAggLimit) 
			values (@AppId,@InsuranceLineCd,300000,600000,600000,@AuditTypeCd,@AuditFreqCd,
			@FormCodeCd,0,'0', '0', '0', 0, 0, 0)
		End
		--FSIT 144150 end PP
		--Make Machenical Breakdown is default coverage
		Exec SHInsertCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LOB, 0, 0, @InsuranceLineCd, @PrimaryState, 'MECHBD'
	End
	Else
	Begin
		--DON00011 Begin
		Insert into BOInsuranceLine (AppId,InsuranceLineCd,PerOccurrenceAmt,FireLiabilityAmt,GenAggregateAmt,ProdAggregateAmt,AuditTypeCd,AuditFreqCd,
		FormCodeCd,MedicalExpenseAmt,PersonalInjuryAmt,AdvertisingInjuryAmt) 
		values (@AppId,@InsuranceLineCd,1000000,@FireLiabilityAmt,2000000,@ProdAggregateAmt,@AuditTypeCd,@AuditFreqCd,
		@FormCodeCd,@MedicalExpenseAmt,1000000,1000000) 
	End
	/*TP 137508 END*/
end 
If @Host = 'S2' Begin
	Select PerOccurrenceAmt,FireLiabilityAmt,GenAggregateAmt,ProdAggregateAmt,
	MedicalExpenseAmt AS MedicalExpenseAmt, rtrim(FormCodeCd) as FormCodeCd ,
		AmendXActStat= ActivityStatusCd,	
		AmendXPolStat = @PolicyStatusCd,		
		AmendXTransDt=@AmendXTransDt,		
		AmendXEffDt=@AmendXEffDt,			
		AmendXExpDt=@AmendXExpDt,			
		AmendXLastTransDt=@AmendXLastTransDt	
	from BOInsuranceLine with (nolock) 
	where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd
 End 
Else
 Begin
	-- TP 137508 START
	--If @PrimaryState = 'NY'	--TL FSIT 144098
	If @LOB = 'BP'				--TL FSIT 144098
	Begin
        --TL BOP NY 2010 Starts issue 101 dlh
         If ((Select Top 1 TerrorismInd From BOPropertyInfo Where AppId = @AppId) = '1') 
             Update BOInsuranceLine Set TerrorismInd = 1 Where AppId = @AppId
         else
             Update BOInsuranceLine Set TerrorismInd = 0 Where AppId = @AppId        
        --TL BOP NY 2010 Ends  issue 101 dlh
		Select PerOccurrenceAmt,LiabilityMedPayment=PerOccurrenceAmt,FireLiabilityAmt,GenAggregateAmt,GenAggregateAmt2=GenAggregateAmt,ProdAggregateAmt,ProdCompletedOperation=GenAggregateAmt,MedicalExpenseAmt,MedExpAmtPerPerson=MedicalExpenseAmt, rtrim(FormCodeCd) as FormCodeCd, --FSIT 144150 PP
				PersonalInjuryAmt, AdvertisingInjuryAmt, TerrorismExclusionInd,CertifiedActTerror=TerrorismExclusionInd, --FSIT 144150 PP
				MedicalExpExclusionInd, MedExpenExclu=MedicalExpExclusionInd,  --FSIT 144150 PP
				AssaultBatExclustionInd, AssaultBatExclustionInd2=AssaultBatExclustionInd, --FSIT 144150 PP
				BlanketRatingInd,PersonAdInjuryExclu=BlanketRatingInd, --FSIT 144150 PP
				TerrorismInd,
				LiquorComCauLimit, 
				LiquorAggLimit,
				DamagePreRen,
				DamagePreRen2=DamagePreRen, --FSIT 144150 PP
				TerrorismTier,
				AmendXActStat= ActivityStatusCd,		
				AmendXPolStat = @PolicyStatusCd,	
				AmendXTransDt=@AmendXTransDt,		
				AmendXEffDt=@AmendXEffDt,			
				AmendXExpDt=@AmendXExpDt,					AmendXLastTransDt=@AmendXLastTransDt	
				, @RestaurantInd AS RestaurantInd	--DON00011			
				, @TerrorismInd AS PropertyTerrorismInd		--TP BOP NY 2010, Validate TerrorismInd
				,(SELECT count(*) from shpropertylocation with (nolock)	where appid=@AppId) as NumberOfLocations	--TL FSIT 144444 issue 206 11032012
			from BOInsuranceLine with (nolock) 
			where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd
	End
	Else
	Begin
		Select PerOccurrenceAmt,(CASE @RestaurantInd WHEN '1' THEN PerOccurrenceAmt WHEN '0' THEN 300000 END) AS FireLiabilityAmt,GenAggregateAmt,ProdAggregateAmt,MedicalExpenseAmt, rtrim(FormCodeCd) as FormCodeCd,
			PersonalInjuryAmt, AdvertisingInjuryAmt, TerrorismExclusionInd,		--DON00011
			AmendXActStat= ActivityStatusCd,		
			AmendXPolStat = @PolicyStatusCd,	
			AmendXTransDt=@AmendXTransDt,		
			AmendXEffDt=@AmendXEffDt,			
			AmendXExpDt=@AmendXExpDt,					AmendXLastTransDt=@AmendXLastTransDt	
			, @RestaurantInd AS RestaurantInd	--DON00011
		from BOInsuranceLine with (nolock) 
		where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd
	End
	-- TP 137508 END
 End
	--DON00011 End
--DON00001 starts
--	Set @PrimaryState = @TempPrimaryState 
--	Select top 1 @LocationId=LocationId,@MasterCompanyId=MasterCompanyId,@PolicyCompanyId=PolicyCompanyId,@PrimaryState=StateCD
--	from SHSeleCoveragetype with (index(IX_SHSeleCoveragetype),nolock) 
--	where HostCd=@Host and 
--	(Locationid=@LocationId or Locationid='99' ) and 
--	(Mastercompanyid=@MasterCompanyId or Mastercompanyid='99' ) and 
--	(Policycompanyid=@PolicyCompanyId or Policycompanyid='99') 
--	and LineOfBusinessCd=@LOB 
-- and CoverageTypeCd='SSS' 
--	and (StateCd=@PrimaryState or StateCd='99') 
--
--	ORDER BY StateCD Desc,Locationid,Mastercompanyid,Policycompanyid
--DON00001 ends
--DOB00011 Begin
IF @Host = 'S2' 
BEGIN
	select Rtrim(FormCodeCd) as FormCodeCd, Rtrim(FormCodeDes) from SHSeleFormCode with (nolock) 
	where HostCd = @Host 
	and (LocationId = @LocationId or LocationId = '99') --DON00001
	and (MasterCompanyId = @MasterCompanyId or MasterCompanyId = '99') --DON00001
	and (PolicyCompanyId = @PolicyCompanyId or PolicyCompanyId = '99') --DON00001
	and InsuranceLineCd=@InsuranceLineCd
	and (StateCd = @PrimaryState or StateCd = '99')  --DON00001
	and LineOfBusinessCd = @Lob 
END
--DON00011 End
--FSIT 144150 start PP
select Rtrim(Code) as PrdOprAmt, Rtrim(LimitValue1) from SHSeleCovAmount with (nolock) 
where Host = @Host
and LocationId = @LocationId
and MasterCompanyId = @MasterCompanyId
and PolicyCompanyId = @PolicyCompanyId
and (State = @PrimaryState )
and LOB = @Lob 
and CoverageCode = 'GEN'
ORDER BY SortOrder
--FSIT 144150 end PP
--DON00001 starts
--TL FSIT 14444 issue 148 10/26/2012 Starts
If @IsUnderwriter = 1
Begin
	SELECT RTRIM(CoverageCd) AS CoverageCd, CoverageDes AS CoverageTypeDes
	FROM SHSeleCoverageAttributes
	WHERE CoverageCd NOT IN (SELECT DISTINCT RTRIM(CoverageCd) FROM SHCoverageDetails 
								WHERE AppId = @AppId AND LocationNbr = @LocationNumber AND BuildingNbr = 0
										AND LineOfBusinessCd = @LOB
										AND InsuranceLineCd = @InsuranceLineCd 
										AND CoverageCd IN ( SELECT RTRIM(CoverageCd) FROM SHSeleCoverageAttributes 
															WHERE HostCd = @Host 
																AND LocationId IN ('99',@LocationId) 
																AND MasterCompanyId IN ('99',@MasterCompanyId)
																AND PolicyCompanyId IN ('99',@PolicyCompanyId)
																AND StateCd IN ('99',@PrimaryState)
																AND LineOfBusinessCd = @LOB
																AND InsuranceLineCd = @InsuranceLineCd
																AND InsuranceLineCovInd = @InsLineCovInd
																AND MultipleSelectionInd = 0
																--and Coveragecd <> 'MECHBD' --fsit 240038 dlh start
														   )
														   --and Coveragecd <> 'MECHBD' --fsit 240038 dlh start
							)
        --and Coveragecd <> 'MECHBD' --fsit 240038 dlh start
		AND HostCd = @Host 
		AND LocationId IN ('99',@LocationId) 
		AND MasterCompanyId IN ('99',@MasterCompanyId)
		AND PolicyCompanyId IN ('99',@PolicyCompanyId)
		AND LineOfBusinessCd = @LOB
		AND InsuranceLineCd = @InsuranceLineCd 
		AND StateCd IN ('99',@PrimaryState)
		AND InsuranceLineCovInd = @InsLineCovInd
		--don-2576 begin
		and CoverageCd<>
			case 
			when datediff(dd,@effdate,'5/16/2020') > 0 then
				'CONENH'
			else
				'' 
			end
		--don-2576 end
		--ORDER BY SortOrderNbr
		ORDER BY CoverageDes --FSIT 144441 PP
End
Else
Begin
	SELECT RTRIM(CoverageCd) AS CoverageCd, CoverageDes AS CoverageTypeDes
	FROM SHSeleCoverageAttributes
	WHERE CoverageCd NOT IN (SELECT DISTINCT RTRIM(CoverageCd) FROM SHCoverageDetails 
								WHERE AppId = @AppId AND LocationNbr = @LocationNumber AND BuildingNbr = 0
										AND LineOfBusinessCd = @LOB
										AND InsuranceLineCd = @InsuranceLineCd 
										AND CoverageCd IN ( SELECT RTRIM(CoverageCd) FROM SHSeleCoverageAttributes 
															WHERE HostCd = @Host 
																AND LocationId IN ('99',@LocationId) 
																AND MasterCompanyId IN ('99',@MasterCompanyId)
																AND PolicyCompanyId IN ('99',@PolicyCompanyId)
																AND StateCd IN ('99',@PrimaryState)
																AND LineOfBusinessCd = @LOB
																AND InsuranceLineCd = @InsuranceLineCd
																AND InsuranceLineCovInd = @InsLineCovInd
																AND MultipleSelectionInd = 0
																--and Coveragecd <> 'MECHBD' --fsit 240038 dlh start
														   )
														   --and Coveragecd <> 'MECHBD' --fsit 240038 dlh start
							)
        --and Coveragecd <> 'MECHBD' --fsit 240038 dlh start
		AND HostCd = @Host 
		AND LocationId IN ('99',@LocationId) 
		AND MasterCompanyId IN ('99',@MasterCompanyId)
		AND PolicyCompanyId IN ('99',@PolicyCompanyId)
		AND LineOfBusinessCd = @LOB
		AND InsuranceLineCd = @InsuranceLineCd 
		AND StateCd IN ('99',@PrimaryState)
		AND InsuranceLineCovInd = @InsLineCovInd
		AND IsAppliedForAgent = 1
		--ORDER BY SortOrderNbr
		ORDER BY CoverageDes --FSIT 144441 PP
End
--TL FSIT 14444 issue 148 10/26/2012 Ends
--Select upper(ltrim(rtrim(CoverageCd))) as CoverageCd,ltrim(rtrim(CoverageTypeDes)) as CoverageTypeDes 
--From SHSeleCoveragetype A with (nolock) --DON00001
--where InsuranceLineCd = @InsuranceLineCd
--And LocationId=@LocationId
--And MasterCompanyId =@MasterCompanyId
--And PolicyCompanyId =@PolicyCompanyId
--And HostCd = @Host
--And CoverageTypeCd='SSS'
--And (StateCd = @PrimaryState ) 
--AND CoverageCd NOT IN (select CoverageCd from SHInsLineCoverageDetails where Appid = @AppId and A.AcordCD <> 'B')
----DON00001 Added the above condition to select coverages that are not selected
--order By CoverageTypeDes
--DON00001 ends
If @Host = 'PT' 
Begin
--DON00001 starts
--DON00001 Added ltrim(rtrim(convert(varchar,CoverageSequenceNbr))) + ' - ' +  in select query
--Select ltrim(rtrim(convert(varchar,CoverageSequenceNbr))) + ' - ' + Ltrim(Rtrim(A.CoverageCd)) As CovCode,
--ltrim(rtrim(convert(varchar,CoverageSequenceNbr))) + ' - ' + (Select DISTINCT CoverageTypeDes From SHSeleCoverageAttributes Where 
--CoverageCd=A.CoverageCD And LineOfBusinessCd='BO') As Description,CoverageSequenceNbr 
----From SHInsLineCoverageDetails A 
--From SHCoverageDetails A 
--Where AppID=@AppID 
SELECT CONVERT(VARCHAR,CoverageSequenceNbr) +  ' - ' + RTRIM(SHCoverageDetails.CoverageCd) AS CovCode 
	, CONVERT(VARCHAR,CoverageSequenceNbr) + ' - ' +  CoverageDes  AS Description
FROM SHCoverageDetails INNER JOIN SHSeleCoverageAttributes ON
	SHCoverageDetails.CoverageCd = SHSeleCoverageAttributes.CoverageCd
	AND SHCoverageDetails.LineOfBusinessCd = SHSeleCoverageAttributes.LineOfBusinessCd
	AND SHCoverageDetails.InsuranceLineCd = SHSeleCoverageAttributes.InsuranceLineCd
	AND SHSeleCoverageAttributes.HostCd = @Host
	AND SHSeleCoverageAttributes.LocationId IN ('99',@LocationId) 
	AND SHSeleCoverageAttributes.MasterCompanyId IN ('99',@MasterCompanyId)
	AND SHSeleCoverageAttributes.PolicyCompanyId IN ('99',@PolicyCompanyId)
	AND StateCd IN ('99',@PrimaryState)
WHERE AppId = @AppId AND LocationNbr = @LocationNumber AND BuildingNbr = 0
AND SHCoverageDetails.LineOfBusinessCd = @LOB
AND SHCoverageDetails.InsuranceLineCd = @InsuranceLineCd 
ORDER BY SHCoverageDetails.CoverageCd, CoverageSequenceNbr 
--CREATE TABLE #OptionalCoverageControlData(
--
--CoverageCd CHAR(6) ,
--CoverageSequenceNbr SMALLINT,
--CoverageParmSeqNbr SMALLINT, 
--CoverageParmHeadingTxt VARCHAR(900),
--CoverageParmFieldTxt VARCHAR(30), 
--CoverageParmTypeTxt VARCHAR(300) ,
--CoverageParmSizeTxt VARCHAR(200), 
--CoverageParmFieldRowNbr SMALLINT,
--MandatoryFields CHAR(2), 
--MandatoryFieldsEditMsgTxt VARCHAR(900),
--MandatoryFieldsEditTypeCd CHAR(5)
--)
--
--Declare Cursor1 cursor -- Declare Cursor1
--for Select DISTINCT CoverageCd, CoverageSequenceNbr from SHOptionalCoverageDetailItem WHere AppID=@AppID
--order by CoverageCd,CoverageSequenceNbr
--Declare @CovCd char(6) 
--Declare @CovSeq smallint
--
--OPEN Cursor1 -- Open Cursor1
--	FETCH NEXT FROM Cursor1 INTO @CovCd,@CovSeq
--
--		while @@fetch_status=0
--			BEGIN
--
--				INSERT INTO #OptionalCoverageControlData -- Populate Temporaray Table
--
--					Select B.CoverageCd,A.CoverageSequenceNbr, 
--					A.DisplaySequenceNbr ,
--					B.CoverageParmHeadingTxt ,
--					A.FieldNameTxt,
--					B.CoverageParmTypeTxt ,
--					B.CoverageParmSizeTxt , 
--					A.ControlRowNbr ,
--					B.MandatoryFields , 
--					B.MandatoryFieldsEditMsgTxt ,
--					B.MandatoryFieldsEditTypeCd from SHSeleCovParms B --WHere Appid ='28812876595765468750' and CoverageCd = 'EMPDIS' and CoverageSequenceNbr = '1'
--					 join SHOptionalCoverageDetailItem A on A.CoverageCd = B.CoverageCd And A.CoverageSequenceNbr = @CovSeq AND B.ScheduleItemInd = A.ScheduleItemInd and ((Substring(A.FieldNameTxt,Len(A.CoverageCd) + 1,Len(A.FieldNameTxt) - Len(A.CoverageCd) - 2) = B.CoverageParmFieldTxt) )
--					where B.CoverageCd = @CovCd and A.CoverageSequenceNbr = @CovSeq And AppID=@AppID order by DisplaySequenceNbr
--
--				FETCH NEXT FROM Cursor1 INTO @CovCd,@CovSeq -- Fetch Next Record
--			END
--CLOSE Cursor1
--DEALLOCATE Cursor1
--
--select ltrim(rtrim(convert(varchar,CoverageSequenceNbr))) + ' - ' + Ltrim(Rtrim(CoverageCd)) As CoverageCd,CoverageSequenceNbr,CoverageParmSeqNbr As CoverageParmSeqNbr,
--CoverageParmHeadingTxt As CoverageParmHeadingTxt,CoverageParmFieldTxt As CoverageParmFieldTxt, 
--CoverageParmTypeTxt As CoverageParmTypeTxt,CoverageParmSizeTxt As CoverageParmSizeTxt, 
--CoverageParmFieldRowNbr As CoverageParmFieldRowNbr,MandatoryFields As MandatoryFields, 
--MandatoryFieldsEditMsgTxt As MandatoryFieldsEditMsgTxt,
--isnull(A.MandatoryFieldsEditTypeCd, '') as CoverageEditType,
--
--(Select count(*) from #OptionalCoverageControlData B Where 
--A.CoverageParmFieldRowNbr = B.CoverageParmFieldRowNbr AND A.CoverageCd=B.CoverageCD) as ColumnCount
--
--from #OptionalCoverageControlData A
--
--DROP TABLE #OptionalCoverageControlData -- Drop Temporary Table
-- 
-- 
-------------------------------------------------------------------------------------------------------------------------------------- 
---- now fetch the fields 
-- 
--select Ltrim(Rtrim(FieldValueTxt)) AS FieldValueTxt 
--,Ltrim(Rtrim(FieldNameTxt)) AS FieldNameTxt from 
--SHOptionalCoverageDetailItem Where AppId=@AppID And InsuranceLineCd='BO' 
--DON00001 ends
End
Set @error = @@error
If @error <> 0
 Return @error
Else
 Return 0

GRANT EXECUTE ON [dbo].[BORetrieveInsLinecoverages] TO [isol_app] AS [dbo]

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[BPRetrieveBuildingInfo]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[BPRetrieveBuildingInfo]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

CREATE Procedure [dbo].[BPRetrieveBuildingInfo]
/* Parms sent to stored procedure */
@AppId varchar(20) = Null,
@LocationNumber smallint = 1,
@LocationCount smallint = Null, 
@BuildingNumber smallint = 1,
@BuildingCount smallint = Null,
@LOB char(3) = null,
@ScreenName varchar(40) = Null,
@Host char(2) = null,
@PrimaryState varchar(10) = Null,
--@InsuranceLineCd CHAR(3)='BOP', --Case 34771      --TL BOP NY 2010
@InsuranceLineCd CHAR(3),       --TL BOP NY 2010
@StateCd varchar(2)=null, 
@LocationId varchar(2) =null, 
@MasterCompanyId varchar(2) =null, 
@PolicyCompanyId varchar(2) =null,
@ClassCd varchar(18) = Null, -- Case 28037
@ClassDesc varchar(100) = '', -- Case 28037
@SearchError varchar(1) = 'N', -- Case 28037
@GroupCd varchar(2) --fsit 144098
,@IsFilterOccupancy smallint = 0 -- 05/18/2018 DeveloperName: DON-1970 Start
As
Set nocount on
Declare @LocationRowCount smallint, @BuildingRowCount Smallint, @RecordCount SmallInt, @error int
Declare @LocationAddress varchar(30), @count smallint
Declare @TempLocationId char(2)
Declare @TempMasterCompanyId char(2)
Declare @TempPolicyCompanyId char(2)
Declare @ClsCd char(18)
Declare @CmpnyBusLiabExclInd char(5), @WaterSupplyPrpInd char(5), @CommSupplyInd char(5)
Declare @OverHdPwdInd char(5), @PowerSupplyInd char(5), @OverHdCommnInd char(5)
Declare @TempClassCd varchar(60) -- Case 28037
Declare @iCount int -- Case 28037
Declare @check char(1) -- Case 28037
--DON00013 Begin
--Declare @RateGroupCd varchar(10) -- Case 28037
--Declare @RateNumberCd varchar(10) -- Case 28037
--Declare @RiskTypeCd varchar(10) -- Case 28037
--DON00013 End
Declare @ClassGroupCd char(2) -- Issue 35271
DECLARE @TempStateCd varchar(2) --39373
DECLARE @TempInsuranceLineCd varchar(3) --39373
/*-- 34771 start --*/
Declare @PolicyStatusCd char(1)
Declare @AmendXTransDt datetime
Declare @AmendXEffDt datetime
Declare @AmendXExpDt datetime
Declare @AmendXLastTransDt datetime
declare @BlanketBldgAndBPPInd char(5)	--DON00084
declare @BldgOrdinanceInd char(5)	--DON00084
DECLARE @BldgCoverageCd VARCHAR(6)	--DON00089
Declare @TempGroupCd char(2) --fsit 144098
 Select @PolicyStatusCd = PolicyStatusCd,
	@AmendXTransDt = TransactionEffectiveDt,
	@AmendXEffDt = EffectiveDate,
	@AmendXExpDt = ExpirationDate,
	@AmendXLastTransDt = LastTransactionEffectiveDt
	 FROM SHPlanInfo with (nolock) WHERE AppId = @AppId
/*-- 34771 end --*/
--If @InsuranceLineCd = '' 		--TL FSIT 144098
--Begin							--TL FSIT 144098
	--Set @InsuranceLineCd = 'BOP'  --TL BOP NY 2010
    select @InsuranceLineCd=WCLineOfBusiness from SHPlanInfo (nolock) where appid=@AppId    --TL BOP NY 2010
--End
--don-2576 begin
	Declare @effdate as date
	select @effdate=effectivedate from shplaninfo where appid=@AppId
--don-2576 end							--TL FSIT 144098
--print 'PolicyId '
--print 'PolicyId : ' + @PolicyCompanyId
SET @TempInsuranceLineCd=@InsuranceLineCd --39373
set @TempLocationId = @LocationId
set @TempMasterCompanyId = @MasterCompanyId
set @TempPolicyCompanyId = @PolicyCompanyId
 
Set @LocationRowCount = ( Select Max(LocationNbr)
 From SHPropertyLocation with (nolock) 
 Where AppId = @AppId 
 			 And RTrim(HostCd) = RTrim(@Host) ) 
/*And InsuranceLineCd = @InsuranceLineCd)*/
Set @LocationAddress = ( Select Address1Txt
 From SHPropertyLocation with (nolock) 
 Where AppId = @AppId 
			 And LocationNbr = @LocationNumber 
			 And RTrim(HostCd) = RTrim(@Host) )
-- 34771 start
/*
Set @BuildingRowCount = ( Select Max(StructureNbr) 
 From BOPropertyInfo with (nolock) 
 Where AppId = @AppId
 And LocationNbr=@LocationNumber
 And InsuranceLineCd = @InsuranceLineCd)
*/
Set @BuildingRowCount = ( Select Count(StructureNbr) 
 From BOPropertyInfo with (nolock) 
 Where AppId = @AppId
 And LocationNbr=@LocationNumber
 And InsuranceLineCd = @InsuranceLineCd
			 And ActivityStatusCd<>'D')
If @BuildingNumber=0
	set @BuildingNumber = (Select max (StructureNbr) From BOPropertyInfo with (nolock) 
 Where AppId = @AppId
 And LocationNbr=@LocationNumber)
-- 34771 end
Set @RecordCount = ( Select Count(*) 
 From BOPropertyInfo with (nolock) 
 Where AppId = @AppId
 And LocationNbr=@LocationNumber 
 And StructureNbr=@BuildingNumber 
			 And InsuranceLineCd = @InsuranceLineCd) 
/*start case 13434 */
--sys/dst log 251 starts
--Set @StateCd = (Select StateCd from SHPropertyLocation with (nolock) Where AppId= @AppId and LocationNbr=@LocationNumber)
Set @StateCd = (Select RiskState from SHPlanInfo with (nolock) Where AppId= @AppId)
--sys/dst log 251 ends
Set @PrimaryState = @StateCd --fsit 144098
SET @TempStateCd=@StateCd --39373
/*end case 13434 */
If @RecordCount = 0 
Begin
-- Start Issue 35271 
--	Insert Into BOPropertyInfo ( AppId, LocationNbr, StructureNbr, InsuranceLineCd)	
--	Values ( @AppId, @LocationNumber, @BuildingNumber, @InsuranceLineCd)
	If @Host = 'S2'
	 Begin
		Insert Into BOPropertyInfo ( AppId, LocationNbr, StructureNbr, InsuranceLineCd, RiskTypeCd, BOPAutoIncPctCd)	
		Values ( @AppId, @LocationNumber, @BuildingNumber, @InsuranceLineCd, 'NA', '8')
	 End
	Else
	 Begin
		--Insert Into BOPropertyInfo ( AppId, LocationNbr, StructureNbr, InsuranceLineCd)	
		--Values ( @AppId, @LocationNumber, @BuildingNumber, @InsuranceLineCd)
		Insert Into BOPropertyInfo ( AppId, LocationNbr, StructureNbr, InsuranceLineCd,HostStructureNbr,NextAvailableStructureNbr)	-- 34771
		Values ( @AppId, @LocationNumber, @BuildingNumber, @InsuranceLineCd, @BuildingNumber, @BuildingNumber+1)	-- 34771
		--DON00089 Begin
		DECLARE BuildingCovCursor CURSOR FOR 
		SELECT CoverageCd FROM SHSeleCoverageAttributes 
			WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
			AND LineOfBusinessCd = @LOB
			AND InsuranceLineCd = @InsuranceLineCd
			AND StateCd IN ('99' , @StateCd)
			AND InsuranceLineCovInd = 2 
		ORDER BY SortOrderNbr
		OPEN BuildingCovCursor
		FETCH NEXT FROM BuildingCovCursor INTO @BldgCoverageCd
		WHILE (@@FETCH_STATUS = 0)
		BEGIN
			EXEC SHInsertCoverage @AppId = @AppId
				, @HostCd = 'PT'
				, @LocationId = @LocationId
				, @MasterCompanyId = @MasterCompanyId
				, @PolicyCompanyId = @PolicyCompanyId
				, @LocationNbr = @LocationNumber		
				, @BuildingNbr = @BuildingNumber
				, @LineOfBusinessCd = @LOB
				, @InsuranceLineCd = @InsuranceLineCd
				, @StateCd = @StateCd
				, @CoverageCd = @BldgCoverageCd
		FETCH NEXT FROM BuildingCovCursor INTO @BldgCoverageCd
		END
		CLOSE BuildingCovCursor
		DEALLOCATE BuildingCovCursor
		--DON00089 End
		--TL BOP CA 2010 Post Live issue 85 Starts
		If @InsuranceLineCd = 'CBP' Exec SHInsertCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber, @LOB, @InsuranceLineCd, @StateCd, 'EQBDN'		
		--TL BOP CA 2010 Post Live issue 85 Ends
		--fsit 240038 dlh start
		 --If @InsuranceLineCd = 'NBP'
		 --   Begin
   --           declare @EffectiveDt datetime
	  --        set @EffectiveDt = (select effectivedate from shplaninfo with (nolock) where appid = @appid)
   --           if @EffectiveDt > convert(datetime,'07/29/2016') 	 
		 --        if (select count(*) from SHCoverageDetails with (nolock) where AppId =@appid and  LocationNbr = @LocationNumber and buildingNbr= @BuildingNumber and coveragecd = 'EQBDN') = 0 
	  --               Exec SHInsertCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber, @LOB, @InsuranceLineCd, @StateCd, 'EQBDN'		
			--end   		
         --fsit 240038 dlh end
	 End
-- End Issue 35271 
	Set @error = @@error
	If @error <> 0 Return @error
	Set @BuildingRowCount = @BuildingNumber
End
set @CmpnyBusLiabExclInd = ( Select CmpnyBusLiabExclInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
 And LocationNbr = @LocationNumber And StructureNbr = @BuildingNumber And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
if RTrim(@CmpnyBusLiabExclInd) = 'Y'
   set @CmpnyBusLiabExclInd = 'True'
else
   set @CmpnyBusLiabExclInd = 'False'
set @WaterSupplyPrpInd = ( Select WaterSupplyPrpInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
                                  And LocationNbr = @LocationNumber And StructureNbr = @BuildingNumber And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
if RTrim(@WaterSupplyPrpInd) = 'Y'
   set @WaterSupplyPrpInd = 'True'
else
   set @WaterSupplyPrpInd = 'False'
set @CommSupplyInd = ( Select CommSupplyInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
                              And LocationNbr = @LocationNumber 
                              And StructureNbr = @BuildingNumber 
                              And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
if RTrim(@CommSupplyInd) = 'Y'
   set @CommSupplyInd = 'True'
else
   set @CommSupplyInd = 'False'
set @OverHdPwdInd = ( Select OverHdPwdInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
                             And LocationNbr = @LocationNumber 
                             And StructureNbr = @BuildingNumber 
                             And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
if RTrim(@OverHdPwdInd) = 'Y'
   set @OverHdPwdInd = 'True'
else
   set @OverHdPwdInd = 'False'
set @PowerSupplyInd = ( Select PowerSupplyInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
                               And LocationNbr = @LocationNumber 
                               And StructureNbr = @BuildingNumber 
                               And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
if RTrim(@PowerSupplyInd) = 'Y'
   set @PowerSupplyInd = 'True'
else
   set @PowerSupplyInd = 'False'
set @OverHdCommnInd = ( Select OverHdCommnInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
                               And LocationNbr = @LocationNumber 
                               And StructureNbr = @BuildingNumber 
                               And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
 if RTrim(@OverHdCommnInd) = 'Y'
    set @OverHdCommnInd = 'True'
 else
    set @OverHdCommnInd = 'False'
--DON00084 begin
set @BlanketBldgAndBPPInd = ( Select BlanketBldgAndBPPInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
                                     And LocationNbr = @LocationNumber 
                                     And StructureNbr = @BuildingNumber 
                                     And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
if RTrim(@BlanketBldgAndBPPInd) = 'Y'
   set @BlanketBldgAndBPPInd = 'True'
else
   set @BlanketBldgAndBPPInd = 'False'
set @BldgOrdinanceInd = ( Select BldgOrdinanceInd From BOPropertyInfo with (nolock) Where AppId=@AppId 
                                 And LocationNbr = @LocationNumber 
                                 And StructureNbr = @BuildingNumber 
                                 And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd))
 if RTrim(@BldgOrdinanceInd) = 'Y'
    set @BldgOrdinanceInd = 'True'
 else
    set @BldgOrdinanceInd = 'False'
--DON00084 end
--Start:Case 28037
Set @check='F'
Set @SearchError ='N'
Set @TempClassCd = @ClassCd
Declare @State char(2)
-- Issue 116432 Starts
SET @StateCd = (SELECT StateCd FROM SHPropertyLocation with (nolock) WHERE AppId=@AppId 
                                    And LocationNbr = @LocationNumber )
-- Issue 116432 Ends
Set @State=@StateCd
Select Top 1 @State = StateCd from BPSeleClassCodes with(nolock)
Where HostCd= @Host and (StateCd=@State or StateCd='99')
Order By statecd Desc
--CASE1 : While screen is being retrieved, Select already exisitng value
--
--If @TempClassCd is Null -- Default value of class code as it will not be passed by retrieve function
--	Begin
----DON00013 Begin
--	--Set @ClassCd = (Select ClassCd from BOPropertyInfo with(nolock) 
--	--			 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId )
--	SELECT @ClassCd = ISNULL(ClassCd, ''), @ClassDesc = ISNULL(ClassDes, '')
--	FROM BOPropertyInfo WITH(NOLOCK) 
--		WHERE LocationNbr = @LocationNumber 
--			AND StructureNbr = @BuildingNumber 
--			AND AppId = @AppId
--
--	SELECT ClassDescription AS ClassCd, 
--		RTRIM(ClassCd) + '/' + ClassDescription as ClassDesc
--	FROM BPSeleClassCodes WITH(NOLOCK)
--		WHERE HostCd= @Host 
--			AND LocationId IN (@LocationId, '99')
--			AND MasterCompanyId IN (@MasterCompanyId, '99')
--			AND PolicyCompanyId IN (@PolicyCompanyId, '99')
--			AND StateCd IN (@StateCd, '99')
--			AND RTRIM(ClassCd) = RTRIM(@ClassCd)
--			AND ClassDescription = @ClassDesc 
--
--		--set @RateGroupCd = (select RateGroupCd from BOPropertyInfo with(nolock) where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId ) -- Issue 35271
--		--set @RateNumberCd = (select RateNumberCd from BOPropertyInfo with(nolock) where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId ) -- Issue 35271
--		--set @RiskTypeCd = ( select RiskTypeCd from BOPropertyInfo with(nolock) where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId ) -- Issue 35271
--		/*
--		set @RateGroupCd = (select RateGroupCd from BOPropertyInfo where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId)	-- 34771
--		set @RateNumberCd = (select RateNumberCd from BOPropertyInfo where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId)	-- 34771
--	 	set @RiskTypeCd = ( select RiskTypeCd from BOPropertyInfo where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId)	-- 34771
--		*/
--	End 
--ELSE
-- Begin
--	-- CASE2 : User search using Code or Description
--	if ( rtrim(@TempClassCd) <> '' ) And (ltrim(rtrim(@ClassDesc)) = '' Or @ClassDesc is Null)
--	Begin
--		set @check='T'
--		Set @ClassCd = @TempClassCd
--		/*
--		set @RateGroupCd = (select RateGroupCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd) and hostcd=@host )		-- 34771and hostcd=@host 
--		set @RateNumberCd = (select RateNbr from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd) and hostcd=@host)			-- 34771and hostcd=@host 
--	 	set @RiskTypeCd = ( select RiskTypeCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd) and hostcd=@host)			-- 34771and hostcd=@host 
--		*/
--
--		SET @iCount = (SELECT COUNT(*)
--		FROM BPSeleClassCodes WITH(NOLOCK)
--				WHERE HostCd= @Host 
--				AND LocationId IN ('99', @LocationId)
--				AND MasterCompanyId IN ('99', @MasterCompanyId)
--				AND PolicyCompanyId IN ('99', @PolicyCompanyId)
--				AND StateCd IN (@StateCd, '99')
--				AND ((ClassCd LIKE @ClassCd + '%' ) Or (ClassDescription LIKE '%' + @ClassCd + '%' )))		--DON00203
--
--		If (@iCount >0)
--		 Begin
--			SELECT '' AS ClassCd, CONVERT(VARCHAR(10),@iCount) + ' result(s) found' AS ClassDesc
--			UNION
--			SELECT RTRIM(ClassDescription) AS ClassCd, 
--				RTRIM(ClassCd) + '/' + RTRIM(ClassDescription) AS ClassDesc
--			FROM BPSeleClassCodes WITH(NOLOCK)
--				WHERE HostCd= @Host 
--				AND LocationId IN ('99', @LocationId)
--				AND MasterCompanyId IN ('99', @MasterCompanyId)
--				AND PolicyCompanyId IN ('99', @PolicyCompanyId)
--				AND StateCd IN (@StateCd, '99')
--				AND ((ClassCd LIKE @ClassCd + '%' ) Or (ClassDescription LIKE '%' + @ClassCd + '%' ) )		--DON00203
--			ORDER BY ClassCd
--
--		 /*Set @ClassCd = (Select top 1 ClassCd from BOSeleClassCodes with(nolock) 
--		 Where HostCd= @Host 
--			and StateCd=@State 
--			and ( (ClassCd like @ClassCd + '%' ) Or (ClassDescription like @ClassCd + '%' ) ) 
--			Order By ClassDescription, ClassCd )
--			set @RateGroupCd = (select RateGroupCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd) and hostcd=@host) -- Issue 35271
--			set @RateNumberCd = (select RateNbr from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd) and hostcd=@host) -- Issue 35271
--			set @RiskTypeCd = ( select RiskTypeCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd) and hostcd=@host) -- Issue 35271
--		*/
--		 End
--		Else
--	 	 Begin
--			--Set @SearchError ='Y'
--			SELECT '' AS ClassCd, '* No items match found' AS ClassDesc			--Set @SearchError ='Y'
--		 End
--	End 
--
--	-- CASE3 : User changes Selection in Description Combo Box.
--	If ltrim(rtrim(@ClassDesc)) <>''
--	Begin
--		Set @check='T'
--		/*Set @ClassCd = (Select top 1 ClassCd from BOSeleClassCodes with(nolock) 
--			where HostCd=@Host 
--			and ClassDescription=@ClassDesc
--			AND StateCd = @State 
--			Order By ClassDescription, ClassCd )*/
--/* Commented - BOP .Net
--		set @RateGroupCd = (select RateGroupCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd))		-- 34771
--		set @RateNumberCd = (select RateNbr from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd))			-- 34771
--	 	set @RiskTypeCd = ( select RiskTypeCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd))			-- 34771
--*/
--		SELECT ClassDescription AS ClassCd 
--				, RTRIM(ClassCd) + '/' + ClassDescription AS ClassDesc
--			FROM BPSeleClassCodes
--			WHERE HostCd = @Host
--				AND LocationId IN ('99', @LocationId)
--				AND MasterCompanyId IN ('99', @MasterCompanyId)
--				AND PolicyCompanyId IN ('99', @PolicyCompanyId)
--				AND StateCd IN ('99', @StateCd)
--				AND ClassCd = @ClassCd
--				AND ClassDescription = @ClassDesc
--				ORDER BY ClassCd
--
--TL BOP NY 2010 Starts        
/* new code for CA/NY start */
If @TempClassCd is Null  -- Default value of class code as it will not be passed by retrieve function
	Begin
	  print 'Class Code Null'
	  if Rtrim(@GroupCd) <> 'A' 
	     Begin
		   Set @ClassCd = (Select ISNULL(ClassCd, '') from BOPropertyInfo with(nolock) 
					 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId )
		   Set @ClassDesc = (Select ISNULL(ClassDes, '') from BOPropertyInfo with(nolock) 
					 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId )
		   Set @GroupCd = (Select RiskTypeCd from BOPropertyInfo with(nolock) 
					 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId )			 
			Select rtrim(ClassDescription) as ClassCd, 
			rtrim(ClassCd) + '/' + rtrim(ClassDescription) as ClassDesc
			from BPSeleClassCodes with(nolock)
			 Where HostCd= @Host 
				AND LocationId IN ('99', @LocationId)
				AND MasterCompanyId IN ('99', @MasterCompanyId)
				AND PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND StateCd=@State 
				AND LineOfBusinessCd = @LOB --fsit 144098
				and StateCd=@State 
				and (rtrim(ClassCd) = rtrim(@ClassCd)) 
				and (rtrim(GroupCd) = rtrim(@GroupCd))
				and (ltrim(rtrim(ClassDescription)) = ltrim(rtrim(@ClassDesc))) -- BP 2010 Fix class code does not appear in Building tab 		   		
		 End
	  Else
	     Begin
		   Set @ClassCd = (Select ISNULL(ClassCd, '') from BOPropertyInfo with(nolock) 
					 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId )
		   Set @ClassDesc = (Select ISNULL(ClassDes, '') from BOPropertyInfo with(nolock) 
					 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId )
			Select rtrim(ClassDescription) as ClassCd, 
			rtrim(ClassCd) + '/' + rtrim(ClassDescription) as ClassDesc
			from BPSeleClassCodes with(nolock)
			 Where HostCd= @Host 
				AND LocationId IN ('99', @LocationId)
				AND MasterCompanyId IN ('99', @MasterCompanyId)
				AND PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND StateCd=@State 
				AND LineOfBusinessCd = @LOB --fsit 144098
				and StateCd=@State 
				and (rtrim(ClassCd) = rtrim(@ClassCd)) 		
				and (ltrim(rtrim(ClassDescription)) = ltrim(rtrim(@ClassDesc))) -- BP 2010 Fix class code does not appear in Building tab 		   			   						  
	    End	   
	End 
ELSE
    Begin
	  -- CASE2 : User search using Code or Description
	  
	  if ( rtrim(@TempClassCd) <> '' 
	     And (ltrim(rtrim(@ClassDesc)) = '' Or @ClassDesc is Null)
	     AND (ltrim(rtrim(@GroupCd)) = 'A' or (ltrim(rtrim(@GroupCd)) <> 'A'))
	     )
	    Begin
	        print 'Level 1' 
			set @check='T'
			Set @ClassCd = @TempClassCd
			set @GroupCd = @TempGroupCd
			--DON00014 Begin
			if rtrim(@GroupCd) <> '' 
			   Begin
					Set @iCount = ( Select Count(*)
					from BPSeleClassCodes with(nolock)
					 Where HostCd= @Host 
						AND LocationId IN ('99', @LocationId)
						AND MasterCompanyId IN ('99', @MasterCompanyId)
						AND PolicyCompanyId IN ('99', @PolicyCompanyId)
						AND StateCd=@State 
						AND LineOfBusinessCd = @LOB --fsit 144098
						and StateCd=@State 
						and ( (ClassCd like '%' + @ClassCd + '%' ) Or (ClassDescription like '%' + @ClassCd + '%' ) )
						--AND rtrim(GroupCd) = rtrim(@GroupCd)  							
						 )		--DON00203			         
				end
			else
				Begin
					Set @iCount = ( Select Count(*)
					from BPSeleClassCodes with(nolock)
					 Where HostCd= @Host 
						AND LocationId IN ('99', @LocationId)
						AND MasterCompanyId IN ('99', @MasterCompanyId)
						AND PolicyCompanyId IN ('99', @PolicyCompanyId)
						AND StateCd=@State 
						AND LineOfBusinessCd = @LOB --fsit 144098
						and StateCd=@State 
						and ( (ClassCd like '%' + @ClassCd + '%' ) Or (ClassDescription like '%' + @ClassCd + '%' ) )													
						 )		--DON00203			       
				End
			If (@iCount >0)
			 Begin
				if rtrim(@GroupCd) <> 'A' 
					Begin
						SELECT '' AS ClassCd, CONVERT(VARCHAR(10),@iCount) + ' result(s) found' AS ClassDesc
						UNION
						SELECT RTRIM(ClassDescription) AS ClassCd, 
							RTRIM(ClassCd) + '/' + RTRIM(ClassDescription) AS ClassDesc
						FROM BPSeleClassCodes WITH(NOLOCK)
							WHERE HostCd= @Host 
							AND LocationId IN ('99', @LocationId)
							AND MasterCompanyId IN ('99', @MasterCompanyId)
							AND PolicyCompanyId IN ('99', @PolicyCompanyId)
							AND StateCd=@State 
							AND LineOfBusinessCd = @LOB --fsit 144098
							AND ((ClassCd LIKE '%' + @ClassCd + '%' ) Or (ClassDescription LIKE '%' + @ClassCd + '%' ) )
							AND rtrim(GroupCd) = rtrim(@GroupCd)		--DON00203
						ORDER BY ClassCd
					End
				Else
					 Begin
						SELECT '' AS ClassCd, CONVERT(VARCHAR(10),@iCount) + ' result(s) found' AS ClassDesc
						UNION
						SELECT RTRIM(ClassDescription) AS ClassCd, 
							RTRIM(ClassCd) + '/' + RTRIM(ClassDescription) AS ClassDesc
						FROM BPSeleClassCodes WITH(NOLOCK)
							WHERE HostCd= @Host 
							AND LocationId IN ('99', @LocationId)
							AND MasterCompanyId IN ('99', @MasterCompanyId)
							AND PolicyCompanyId IN ('99', @PolicyCompanyId)
							AND StateCd=@State 
							AND LineOfBusinessCd = @LOB --fsit 144098
							AND ((ClassCd LIKE '%' + @ClassCd + '%' ) Or (ClassDescription LIKE '%' + @ClassCd + '%' ) )						
						ORDER BY ClassCd
					 End		
			  End
			Else
	 		  Begin			
	 			SELECT '' AS ClassCd, '* No items match found' AS ClassDesc			--Set @SearchError ='Y'
			  End
		End 
		-- CASE3 : User changes Selection in Description Combo Box.
		If ltrim(rtrim(@ClassDesc)) <>'' 
		Begin
		     print 'Level 2' 
			Set @check='T'
			Set @ClassCd = (Select top 1 ClassCd from BPSeleClassCodes with(nolock) 
				where HostCd=@Host 
				AND LocationId IN ('99', @LocationId)
				AND MasterCompanyId IN ('99', @MasterCompanyId)
	 			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND LineOfBusinessCd = @LOB --fsit 144098
				and ClassDescription=@ClassDesc
				AND StateCd = @State 
				Order By ClassDescription, ClassCd )
			SELECT ClassDescription AS ClassCd 
					, RTRIM(ClassCd) + '/' + ClassDescription AS ClassDesc
				FROM BPSeleClassCodes
				WHERE HostCd = @Host
					AND LocationId IN ('99', @LocationId)
					AND MasterCompanyId IN ('99', @MasterCompanyId)
					AND PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND LineOfBusinessCd = @LOB --fsit 144098
					AND StateCd IN ('99', @StateCd)
					AND ClassCd = @ClassCd	
					AND rtrim(ClassDescription) = rtrim(@ClassDesc)							
					ORDER BY ClassCd
			
		--DON00014 End
		End
		-- CASE4 : User changes Selection in Description DropDown Box.
		If ltrim(rtrim(@GroupCd)) <>'' and ( ltrim(rtrim(@ClassCd)) = '' or ltrim(rtrim(@ClassDesc)) = '') and
			rtrim(@TempClassCd) = '' 
		   Begin
		      print 'Level 3' 
			 Set @check='T'
			 if @GroupCd = 'A'	
			   Begin	   
				 Set @iCount = ( Select Count(*)
				 from BPSeleClassCodes with(nolock)
				 Where HostCd= @Host 
				 AND LocationId IN ('99', @LocationId)
				 AND MasterCompanyId IN ('99', @MasterCompanyId)
				 AND PolicyCompanyId IN ('99', @PolicyCompanyId)
				 AND StateCd=@State 
				 AND LineOfBusinessCd = @LOB --fsit 144098
				 AND StateCd=@State)
			   End	  		    
			 Else	
			   Begin	  	 
				 Set @iCount = ( Select Count(*)
				 from BPSeleClassCodes with(nolock)
				 Where HostCd= @Host 
				 AND LocationId IN ('99', @LocationId)
				 AND MasterCompanyId IN ('99', @MasterCompanyId)
				 AND PolicyCompanyId IN ('99', @PolicyCompanyId)
				 AND StateCd=@State 
				 AND LineOfBusinessCd = @LOB --fsit 144098
				 AND StateCd=@State 
				 AND rtrim(GroupCd) = rtrim(@GroupCd))		   
			   End
			 If (@iCount >0)
			  Begin
				if ltrim(rtrim(@GroupCd)) = 'A'
				  Begin
					SELECT '' AS ClassCd, CONVERT(VARCHAR(10),@iCount) + ' result(s) found' AS ClassDesc
					UNION
					SELECT ClassDescription AS ClassCd 
						, RTRIM(ClassCd) + '/' + ClassDescription AS ClassDesc
					FROM BPSeleClassCodes
					WHERE HostCd = @Host
						AND LocationId IN ('99', @LocationId)
						AND MasterCompanyId IN ('99', @MasterCompanyId)
						AND PolicyCompanyId IN ('99', @PolicyCompanyId)
						AND LineOfBusinessCd = @LOB --fsit 144098
						AND StateCd IN ('99', @StateCd)				
						ORDER BY ClassCd
				  End
				Else
				  Begin 
					SELECT '' AS ClassCd, CONVERT(VARCHAR(10),@iCount) + ' result(s) found' AS ClassDesc
					UNION  
					SELECT ClassDescription AS ClassCd 
						, RTRIM(ClassCd) + '/' + ClassDescription AS ClassDesc
					FROM BPSeleClassCodes
					WHERE HostCd = @Host
						AND LocationId IN ('99', @LocationId)
						AND MasterCompanyId IN ('99', @MasterCompanyId)
						AND PolicyCompanyId IN ('99', @PolicyCompanyId)
						AND LineOfBusinessCd = @LOB --fsit 144098
						AND StateCd IN ('99', @StateCd)
						AND rtrim(GroupCd) = rtrim(@GroupCd)
						ORDER BY ClassCd
				  End
			  	  		
			  End
		   else 
		      SELECT '' AS ClassCd, CONVERT(VARCHAR(10),@iCount) + ' result(s) found' AS ClassDesc	  
		End		               
/* new code for CA/NY end */        
        IF @LOB='BP' and @StateCd = 'CA'
			BEGIN
			print 'update'
			UPDATE BOPropertyInfo
				SET SICCd = substring(SICCode,1,6)
					, PersonalPropertyValuationCd = ContentsRateGroupCd	--DON00084                
					, RateNumberCd = ClassRateGroupCd					--DON00084 changed to RateNumberCd from RateCd
					, ProgramCd = ExcludeOptCov2Cd						--DON00084
					, RiskTypeCd = GroupCD								--DON00084
					, SubTypeCd = ExposureBasisCd						--DON00084
					, BaileeInd = ExcludeOptCov1Cd						--DON00084
					, ProfessionalLiabilityInd = EQRateGrade		--DON00084
					, LiquorInd = EQSprinklerLeakage			--DON00084
					, PropertyRateNumberCd = PropertyRateNumber
					, LiabClassGroupCd = LiabilityClassGroup
			FROM BPSeleClassCodes
				WHERE HostCd = @Host
					AND LocationId IN ('99', @LocationId)
					AND MasterCompanyId IN ('99', @MasterCompanyId)
					AND PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND StateCd IN ('99', @StateCd)
					AND BPSeleClassCodes.ClassCd = @ClassCd
					AND BPSeleClassCodes.ClassDescription = @ClassDesc
					AND AppId = @AppId
					And LocationNbr = @LocationNumber 
					And StructureNbr = @BuildingNumber 
					And InsuranceLineCd = @InsuranceLineCd
			END
        ELSE
			BEGIN
			--no need to set SIC code for BOP NY
			UPDATE BOPropertyInfo
				SET PersonalPropertyValuationCd = ContentsRateGroupCd	--DON00084                
					, RateNumberCd = ClassRateGroupCd					--DON00084 changed to RateNumberCd from RateCd
					, ProgramCd = ExcludeOptCov2Cd						--DON00084
					--, RiskTypeCd = PMACd								--DON00084
					, SubTypeCd = ExposureBasisCd						--DON00084
					, BaileeInd = ExcludeOptCov1Cd						--DON00084
					--, ProfessionalLiabilityInd = GLPremisesOprIncreasedLimitCd		--DON00084
					--, LiquorInd = GLProductCplOprIncreasedLimCd			--DON00084
					, PropertyRateNumberCd = PropertyRateNumber
					, LiabClassGroupCd = LiabilityClassGroup
			FROM BPSeleClassCodes
				WHERE HostCd = @Host
					AND LocationId IN ('99', @LocationId)
					AND MasterCompanyId IN ('99', @MasterCompanyId)
					AND PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND StateCd IN ('99', @StateCd)
					AND BPSeleClassCodes.ClassCd = @ClassCd
					AND BPSeleClassCodes.ClassDescription = @ClassDesc
					AND AppId = @AppId
					And LocationNbr = @LocationNumber 
					And StructureNbr = @BuildingNumber 
					And InsuranceLineCd = @InsuranceLineCd
			END
        --TL BOP NY 2010 Ends
		--DON00084 Begin
		IF EXISTS(SELECT 1 FROM BOPropertyInfo with (nolock)
					WHERE AppId = @AppId
					AND LocationNbr = @LocationNumber 
					AND StructureNbr = @BuildingNumber 
					And InsuranceLineCd = @InsuranceLineCd
					AND SubTypeCd = 'DC')
			BEGIN
					UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = (SELECT GrossSalesAmt FROM BOPropertyInfo with (nolock)
													WHERE AppId = @AppId
														AND LocationNbr = @LocationNumber 
														AND StructureNbr = @BuildingNumber 
														And InsuranceLineCd = @InsuranceLineCd)
					WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'
						AND CoverageSequenceNbr = 1
						AND FieldNameTxt = 'BAILEE_LimitAmt'
					UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = '100%'
					WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'
						AND CoverageSequenceNbr = 1
						AND FieldNameTxt = 'BAILEE_AdjustmentFactor'
			END
		ELSE
			BEGIN
					UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = '0'
					WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'
						AND CoverageSequenceNbr = 1
						AND FieldNameTxt = 'BAILEE_LimitAmt'
					UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = '100%'
					WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'
						AND CoverageSequenceNbr = 1
						AND FieldNameTxt = 'BAILEE_AdjustmentFactor'
			END
	End
--	If ( @check='F' )
--		Begin
-- 			-- If there is no select executed, reserve the place in vRecords by Null values, otherwise it gives errors in BLL		
--			Select ' ' as ClassCd, ' ' as ClassDesc 
--		End
--DON00013 End
-- set @RateGroupCd = (select RateGroupCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd)) -- Issue 35271
-- set @RateNumberCd = (select RateNbr from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd)) -- Issue 35271
-- set @RiskTypeCd = ( select RiskTypeCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd)) -- Issue 35271
--End:Case 28037
--DON00084 begin
--TL BOP NY 2010 Starts
IF @LOB='BP' and @StateCd = 'CA'
	BEGIN
	print 'update nxt'
		print @LocationId
		print @MasterCompanyId
		print @PolicyCompanyId
		print @StateCd
		print @ClassCd
		print @ClassDesc
		print @InsuranceLineCd
		print @LocationNumber
		print @BuildingNumber
	UPDATE BOPropertyInfo
		SET SICCd = substring(SICCode,1,6)
			, PersonalPropertyValuationCd = ContentsRateGroupCd	--DON00084                
			, RateNumberCd = ClassRateGroupCd					--DON00084 changed to RateNumberCd from RateCd
			, ProgramCd = ExcludeOptCov2Cd						--DON00084
			, RiskTypeCd = GroupCD								--DON00084
			, SubTypeCd = ExposureBasisCd						--DON00084
			, BaileeInd = ExcludeOptCov1Cd						--DON00084
			, ProfessionalLiabilityInd = EQRateGrade		--DON00084
			, LiquorInd = EQSprinklerLeakage			--DON00084
			, PropertyRateNumberCd = PropertyRateNumber
			, LiabClassGroupCd = LiabilityClassGroup
	FROM BPSeleClassCodes
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99', @StateCd)
			AND BPSeleClassCodes.ClassCd = @ClassCd
			AND BPSeleClassCodes.ClassDescription = @ClassDesc
			AND AppId = @AppId
			And LocationNbr = @LocationNumber 
			And StructureNbr = @BuildingNumber 
			And InsuranceLineCd = @InsuranceLineCd
	--TP BPCA 2010 230 11062012 START, Flood for all building
	IF @StateCd = 'CA' and @LOB = 'BP' and @InsuranceLineCd = 'CBP'
	Begin
		Update BOPropertyInfo Set BuildingBlanketTypeCd = (select top 1 BuildingBlanketTypeCd from BOPropertyInfo Where AppId = @AppId and LocationNbr=1 and StructureNbr=1)
		Where AppId = @AppId
		Update BOPropertyInfo Set PersonalPropertyBlanketTypeCd = (select top 1 PersonalPropertyBlanketTypeCd from BOPropertyInfo Where AppId = @AppId and LocationNbr=1 and StructureNbr=1)
		Where AppId = @AppId
	End
	END	
ELSE
	BEGIN
	--no need to set SIC code for BOP NY
	UPDATE BOPropertyInfo
		SET PersonalPropertyValuationCd = ContentsRateGroupCd	--DON00084                
			, RateNumberCd = ClassRateGroupCd					--DON00084 changed to RateNumberCd from RateCd
			, ProgramCd = ExcludeOptCov2Cd						--DON00084
			--, RiskTypeCd = PMACd								--DON00084
			, SubTypeCd = ExposureBasisCd						--DON00084
			, BaileeInd = ExcludeOptCov1Cd						--DON00084
			--, ProfessionalLiabilityInd = GLPremisesOprIncreasedLimitCd		--DON00084
			--, LiquorInd = GLProductCplOprIncreasedLimCd			--DON00084
			, PropertyRateNumberCd = PropertyRateNumber
			, LiabClassGroupCd = LiabilityClassGroup
	FROM BPSeleClassCodes
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99', @StateCd)
			AND BPSeleClassCodes.ClassCd = @ClassCd
			AND BPSeleClassCodes.ClassDescription = @ClassDesc
			AND AppId = @AppId
			And LocationNbr = @LocationNumber 
			And StructureNbr = @BuildingNumber 
			And InsuranceLineCd = @InsuranceLineCd
--TL BOP NY 2010 Starts issue 101 dlh
If ((Select TerrorismInd From BOInsuranceLine with (nolock) Where AppId = @AppId) = '1') 
    Update BOPropertyInfo Set TerrorismInd = 1 Where AppId = @AppId
else
    Update BOPropertyInfo Set TerrorismInd = 0 Where AppId = @AppId
--TL BOP NY 2010 Ends issue 101 dlh
            
END
--TL BOP NY 2010 Ends
--DON00084 end
-- Start Issue 35271
if @Host= 'S2' 
Begin
	Set @ClassGroupCd = (Select top 1 SpoilageGroupCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd) and hostcd=@host) 
	If @ClassGroupCd is null 	set @ClassGroupCd = '1'
	Update BOPropertyInfo Set ClassGroupCd = @ClassGroupCd
	Where AppId=@AppId 
	 And LocationNbr = @LocationNumber 
	 And StructureNbr = @BuildingNumber 
	 And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd)
End
-- End Issue 35271
Select RTrim(InsuranceLineCd) as InsuranceLineCd, 
	LocationNbr As LocationNumber, @LocationRowCount As LocationCount, 
	StructureNbr As BuildingNumber , @BuildingRowCount As BuildingCount, 
	RTrim(BuildingDes) As BuildingDes, 
--	RTrim(ClassCd) As ClassCd, -- Case 28037
	RTrim(@ClassCd) As ClassCd, -- Case 28037
--	RTrim(ClassDes) As ClassDes, -- Case 28037
	RTrim(TerritoryCd) As TerritoryCd, 
	RTrim(ProtectionClassCd) As ProtectionClassCd, ISNULL(NULLIF(RTrim(ConstructionCd),''),'F') As ConstructionCd, --DON-1416
	RTrim(UnitDeductCd) As UnitDeductCd, RTrim(WindHailInd) As WindHailInd, 
	RTrim(OccupancyCd) As OccupancyCd, RTrim(ACVCd) As ACVCd, RTrim(BOPAutoIncPctCd) As BOPAutoIncPctCd, 
	RTrim(SprinklerInd) As SprinklerInd, RTrim(CoinsurancePctCd) As CoinsurancePctCd, 
	BuildingLimitAmt as BuildingLimitAmt, PropOwnedAmt, RTrim(RiskTypeCd) As RiskTypeCd, RTrim(ShuttersInd) As ShuttersInd, --28037	--DON00013
--	BuildingLimitAmt, PropOwnedAmt, RTrim(@RiskTypeCd) As RiskTypeCd, RTrim(ShuttersInd) As ShuttersInd, --28037	--DON00013
	RTrim(@CmpnyBusLiabExclInd) As CmpnyBusLiabExclInd, RTrim(BurglarAlarmInd) As BurglarAlarmInd, 
	RTrim(BCEGCd) As BCEGCd, RTrim(BCEGTypeCd) As BCEGTypeCd, InflationPct, RTrim(YearBuilt) As YearBuilt, PremiumBasisAmt, 	-- Case 37091 (Added RTrim to YearBuild)
	SquareFtAreaAmt as SquareFtAreaAmt, UnitCountNbr as UnitCountNbr, StoriesCountNbr as StoriesCountNbr, AreaSprinkledPct, BusinessPPAmt as BusinessPPAmt, 
	RTrim(RateGroupCd) As RateGroupCd, RTrim(RateNumberCd) As RateNumberCd, GrossSalesAmt as GrossSalesAmt, 	--28037		--DON00013
--	RTrim(@RateGroupCd) As RateGroupCd, RTrim(@RateNumberCd) As RateNumberCd, GrossSalesAmt, --28037	--DON00013
	SwimmingPoolCntNbr, RTrim(HurricaneDeductInd) As HurricaneDeductInd, 
	RTrim(@WaterSupplyPrpInd) As WaterSupplyPrpInd, RTrim(UtilitiesInd) As UtilitiesInd, 
	RTrim(@CommSupplyInd) As CommSupplyInd, RTrim(@OverHdPwdInd) As OverHdPwdInd, 
	RTrim(@PowerSupplyInd) As PowerSupplyInd, RTrim(@OverHdCommnInd) As OverHdCommnInd, 
	PayRollAmt as PayRollAmt, RTrim(ClassGroupCd) As ClassGroupCd, RTrim(DamageLiabDeductCd) As DamageLiabDeductCd, 
	RTrim(MaryLandZoneInd) As MaryLandZoneInd, @LocationAddress As LocationAddress,
	LocationNbr As SeleLocationAddress, StructureNbr As BuildingDescription, -- Case 13851
	@PolicyStatusCd as AmendXPolStat, 			-- Case 34771
	ActivityStatusCd	as AmendXActStat, 			-- Case 34771
	@AmendXTransDt as AmendXTransDt,			-- Case 34771
	AmendXEffDt=@AmendXEffDt,				-- Case 34771
	AmendXExpDt=@AmendXExpDt,				-- Case 34771
	AmendXLastTransDt=@AmendXLastTransDt,		-- Case 34771
	RTrim(@SearchError) as SearchError, -- Case 28037
--	(Case BuildingPremiumOverrideInd when 'Y' then 'True' else 'False' End) as BldgPremiumOverrideInd, BuildingPremiumAmt as BldgPremiumAmt, -- Issue 35271 -- Changed .Net code
--	(Case PropertyPremiumOverrideInd when 'Y' then 'True' else 'False' End) as PropPremiumOverrideInd, PropertyPremiumAmt as PropPremiumAmt -- Issue 35271 -- Changed .Net code
	(Case BuildingPremiumOverrideInd when 'Y' then 'True' when '1' then 'True' else 'False' End) as BldgPremiumOverrideInd, BuildingPremiumAmt as BldgPremiumAmt, -- Issue 35271
	(Case PropertyPremiumOverrideInd when 'Y' then 'True' when '1' then 'True' else 'False' End) as PropPremiumOverrideInd, PropertyPremiumAmt as PropPremiumAmt -- Issue 35271
--DON00013 Begin
	, SICCd as SICCd
	, WindHailDeductiblePct as WindHailDeductiblePct
	, BuildingValuationCd
	, BuildingBlanketTypeCd as BuildingBlanketTypeCd
	, PersonalPropertyValuationCd
	, PersonalPropertyBlanketTypeCd as PersonalPropertyBlanketTypeCd
	, (Case RTRIM(WindHailExclInd) when 'Y' then 'True' else 'False' End) AS WindHailExclInd
	, (Case ActualCashValueInd when 1 then 'True' else 'False' End) AS ActualCashValueInd
	, (Case AutomaticSprinklerSytemInd when 1 then 'True' else 'False' End) AS AutomaticSprinklerSytemInd
	, (Case AutomaticFireAlarmInd when 1 then 'True' else 'False' End) AS AutomaticFireAlarmInd
	, (Case SecurityServiceInd when 1 then 'True' else 'False' End) AS SecurityServiceInd
	, (Case SecurityContractInd when 1 then 'True' else 'False' End) AS SecurityContractInd
	, (Case DeviceInPolicyNoteInd when 1 then 'True' else 'False' End) AS DeviceInPolicyNoteInd
	, ListOfProtectionEquipTxt
	, FixturesEquipLimitAmt	--DON00247
--DON00013 End
--DON00084 begin
	, ProgramCd AS ProgramCd
	, SubTypeCd AS SubTypeCd
	, LiquorSalesAmt AS LiquorSalesAmt
	, EmployeeCountNbr AS EmployeeCountNbr
	, rtrim(@BlanketBldgAndBPPInd) AS BlanketBldgAndBPPInd
	, rtrim(@BldgOrdinanceInd) AS BldgOrdinanceInd
	, (Case BaileeInd when 'Y' then 'Y' else 'N' End) AS BaileeInd
	, (Case ProfessionalLiabilityInd when 'Y' then 'Y' else 'N' End) AS ProfessionalLiabilityInd
	, (Case LiquorInd when 'Y' then 'Y' else 'N' End) AS LiquorInd
	, (Case InsSoleOccFreeStandBldgInd when 1 then 'True' else 'False' End) AS InsSoleOccFreeStandBldgInd
	, (Case MemberShoppingMallOver10StoresInd when 1 then 'True' else 'False' End) AS MemberShoppingMallOver10StoresInd
	, (Case Sprinklered100PercentInd when 1 then 'True' else 'False' End) AS Sprinklered100PercentInd
	, (Case BldgLessThan10YrOrRenovatedInd when 1 then 'True' else 'False' End) AS BldgLessThan10YrOrRenovatedInd
	, (Case CentralStationBurglarAlarmInd when 1 then 'True' else 'False' End) AS CentralStationBurglarAlarmInd
	, (Case TheftExclusionInd when 1 then 'True' else 'False' End) AS TheftExclusionInd
	, (Case FranchiseAdjFctrInd when 1 then 'True' else 'False' End) AS FranchiseAdjFctrInd
	, (Case MultiLocAdjFctrInd when 1 then 'True' else 'False' End) AS MultiLocAdjFctrInd
	, (Case PlaygroundOrMechDeviceAdjFctrInd when 1 then 'True' else 'False' End) AS PlaygroundOrMechDeviceAdjFctrInd
	, (Case MultiNonMechAmuseDevAdjFctrInd when 1 then 'True' else 'False' End) AS MultiNonMechAmuseDevAdjFctrInd
--DON00084 end
    --TL BOP NY 20210 Starts
    , (Case BuildingNamedPerilsInd when 1 then 'True' else 'False' End) AS BuildingNamedPerilsInd
    , (Case PePropNamedPerilsInd when 1 then 'True' else 'False' End) AS PePropNamedPerilsInd
    , (Case BurglaryRobberyInd when 1 then 'True' else 'False' End) AS BurglaryRobberyInd
    , RTrim(RenovationYear) As RenovationYear
    , (Case TerrorismInd when 1 then 'True' else 'False' End) AS TerrorismInd
    , RTrim(TerrorismPropTerrCd) As TerrorismPropTerrCd
    , (Case WindstormProtectiveInd when 1 then 'True' else 'False' End) AS WindstormProtectiveInd
    , (Case EmploymentLiabilityInd when 1 then 'True' else 'False' End) AS EmploymentLiabilityInd
    , isnull(RTrim(PropertyRateNumberCd),'') As PropertyRateNumberCd
    , isnull(RTrim(LiabClassGroupCd),'') As LiabClassGroupCd
    , isnull(RTrim(TenantsImprovementsCov),'') As TenantsImprovementsCov
    , RTrim(LiabDeductAmt) As LiabDeductAmt
    , RTrim(LiabDeductType) As LiabDeductType
    , (Case LargeRestaurantInd when 1 then 'True' else 'False' End) AS LargeRestaurantInd
    , (Case SwimmingPoolInd when 1 then 'True' else 'False' End) AS SwimmingPoolInd
    --TL BOP NY 2010 Ends
	--TL BOP NY 2010, Add LeadExclusionInd
	, (Case LeadExclusionInd when 1 then 'True' else 'False' End) AS LeadExclusionInd
	--TL BOP CA 2010 Post live issue 40 Starts 
	, (Case When ((Select count(*) From SHCoverageDetailItems Where CoverageCd='LIQUOR' and AppId=@AppId) > 1)
		    Then (Case when rtrim(ClassDes)='' Then '0'
					 Else (Select isnull(DeclarationClassCd,'0') from BPSeleClassCodes where statecd=@StateCd and LineofBusinesscd=@LOB and ClassCd=RTrim(ClassCd) and ClassDescription=RTrim(ClassDes))
				  End)	
		Else '0' End
	) 
	as LiquorLiabilityInd --TL FSIT 144444 issue 187 11/01/2012
	--TL BOP CA 2010 Post live issue 40 Starts
	--TL FSIT 151183 Starts
	, (Case When BuildingBlanketTypeCd='1' 
			Then (Select SortOrder From BPSeleCoinsurance Where CoinsuranceCd = (select top 1 CoinsurancePctCd from BOPropertyInfo where AppId=@AppId and BuildingLimitAmt >0)
																and LocationId=@LocationId
																and MasterCompanyId=@MasterCompanyId
																and PolicyCompanyId=@PolicyCompanyId
																and StateCd=@StateCd
																and InsuranceLineCd=@InsuranceLineCd)
		Else 2 End	--default value 90%
	) as BlanketCoinsurancePctCd
	--TL FSIT 151183 Ends
	--DON-2576 begin
	, isnull(CondoAssociation,'') as CondoAssociation
	,case 
	--when (select count(*) from SHCoverageDetails where appid=@appid and coveragecd='CONENH')> 0 then 'Y'
	when datediff(dd,'5/16/2020',@effdate) >= 0 then 'Y'
	else 'N'
	end as CONENH_selected
	--DON-2576 end
 From BOPropertyInfo with (nolock) 
Where AppId=@AppId 
 And LocationNbr = @LocationNumber 
 And StructureNbr = @BuildingNumber 
 And RTrim(InsuranceLineCd) = RTrim(@InsuranceLineCd)
Set @error = @@error
If @error <> 0 Return @error
/* Territory Support Table */
set @Count = (Select Count(*) from SHSeleTerritoryCodes with (nolock) 
	where HostCd=@Host 
	and LineOfBusinessCd=@LOB 
	and statecd = @StateCd)
/* For Getting Support Table Data */
/*********** 39373 START *********************/
--Set @StateCd=@TempStateCd --Issue # 116432 --Commented because Statcd should be same as what has been set above. 
select TOP 1 @StateCd =StateCd
 from SHSeleTerritoryCodes with (nolock) 
	where HostCd=@Host 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 	and (StateCd = @StateCd Or StateCd = '99' )
	ORDER BY StateCd Desc
/*********** 39373 END ************************/
--DON00248 Begins Here
--SELECT 'A' AS TerritoryCd , @LOB+'TR '+@StateCd+'TR '+@Host+'TR '+ @TempStateCd AS TerritoryDe
--select LTrim(RTrim(TerritoryCd)) As TerritoryCd, TerritoryDes
-- from SHSeleTerritoryCodes with (nolock) 
--	where HostCd=@Host 
--	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
---- 	and (StateCd = @StateCd Or StateCd = '99' ) --39373
-- 	and (StateCd = @StateCd )
--Order By TerritoryDes
--DON00248 Ends Here
/* End Territory */
/* Protection Class Support Table */
print 'PolicyID: ' + @TempPolicyCompanyId
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/* Start Case #15341 */
/********************** 39373 START **********************/
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleProtectionClass with (index(IX_BOSeleProtectionClass),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd) AND
LineOfBusinessCd=@LOB */
Set @StateCd=@TempStateCd
SET @InsuranceLineCd = @TempInsuranceLineCd
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,@InsuranceLineCd=InsuranceLineCd,@StateCd =StateCd
FROM BOSeleProtectionClass with (index(IX_BOSeleProtectionClass),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid=@PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd = '999') 
and (StateCd = @StateCd Or StateCd = '99' ) and
LineOfBusinessCd=@LOB ORDER BY StateCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/*************** 39373 END *****************************/
/* For Getting Support Table Data */
print @InsuranceLineCd
print @LOB
print @LocationId
print @MasterCompanyId
print @PolicyCompanyId
print @Host
print @StateCd
select LTrim(RTrim(ProtectionClassCd)) As ProtectionClassCd, ProtectionClassDes
 from BOSeleProtectionClass with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--	and (StateCd = @StateCd Or StateCd = '99' ) 39373
	and (StateCd = @StateCd)
/* Construction Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/********************* 39373 START *************************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleConstruction with (index(IX_SHSeleConstruction),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
--select @StateCD ,@locationid,@mastercompanyid,@policycompanyid,@LOB
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,@StateCd=StateCd
FROM SHSeleConstruction with (index(IX_SHSeleConstruction),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB
and (StateCd = @StateCd Or StateCd = '99' )
ORDER BY StateCD Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/********************* 39373 END *************************/
/* For Getting Support Table Data */
select LTrim(RTrim(ConstructionCd)) As ConstructionCd, ConstructionDes
 from SHSeleConstruction with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
	and (StateCd = @StateCd) ---39373
---and (StateCd = @StateCd Or StateCd = '99' )----39373
/* Unit Deductible Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/********************* 39373 START *************************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleUnitDeductible with (index(IX_BOSeleUnitDeductible),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
--select @MasterCompanyId AS mco,@PolicyCompanyId as PCO, @StateCd as Stcd ,@LocationId as Loc, @InsuranceLineCd as InsCd
SET @InsuranceLineCd=@TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd =StateCd ,
@InsuranceLineCd =InsuranceLineCd
FROM BOSeleUnitDeductible with (index(IX_BOSeleUnitDeductible),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd ='999' ) AND
LineOfBusinessCd=@LOB
and (StateCd = @StateCd)    --TL BOP NY 2010
ORDER BY StateCD Desc,InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
--select @MasterCompanyId,@PolicyCompanyId, @StateCd ,@LocationId,@InsuranceLineCd 
/* End Case #15341 */
/********************* 39373 END **********************/
/* For Getting Support Table Data */
select LTrim(RTrim(UnitDeductibleCd)) As UnitDeductibleCd, UnitDeductibleDes, SortOrder as OrderByThis
 from BOSeleUnitDeductible with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--and (StateCd = @StateCd Or StateCd = '99' )--- 39373
	and (StateCd = @StateCd)
	--don-2576 begin
    and UnitDeductibleCd <>
			case 
			when datediff(dd,'5/16/2020',@effdate) < 0 then
				'25000' 
			else
				'' 
			end
	and UnitDeductibleCd <>
			case 
			when datediff(dd,'5/16/2020',@effdate) < 0 then
				'50000' 
			else
				'' 
			end
	--don-2576 end
order by OrderByThis
/* wind/Hail Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/*********************** 39373 START *****************************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleWindHailExcl with (index(IX_SHSeleWindHailExcl),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
--select @MasterCompanyId AS mco,@PolicyCompanyId as PCO, @StateCd as Stcd ,@LocationId as Loc, @InsuranceLineCd as InsCd
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd=@TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM SHSeleWindHailExcl with (index(IX_SHSeleWindHailExcl),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd = '999')
and (StateCd = @StateCd)    --TL BOP NY 2010
and LineOfBusinessCd=@LOB
ORDER BY StateCd Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
--select @MasterCompanyId AS mco,@PolicyCompanyId as PCO, @StateCd as Stcd ,@LocationId as Loc, @InsuranceLineCd as InsCd
/* End Case #15341 */
/*********************** 39373 END *****************************/
/* For Getting Support Table Data */
select LTrim(RTrim(WindHailExclCd)) As WindHailExclCd, WindHailExclDes
 from SHSeleWindHailExcl with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--	and (StateCd = @StateCd Or StateCd = '99' ) 39373
	and (StateCd = @StateCd)
/* Occupancy Support Table Here */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/******************** 39373 START **********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleOccupancy with (index(IX_SHSeleOccupancy),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM SHSeleOccupancy with (index(IX_SHSeleOccupancy),nolock)where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999')AND
(StateCd = @StateCd) and LineOfBusinessCd=@LOB  --TL BOP NY 2010
ORDER BY stateCD DESC,InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/******************** 39373 END *********************/
/* For Getting Support Table Data */
-- 05/18/2018 DeveloperName: DON-1970 Start
 IF @IsFilterOccupancy <> 0
 begin
	select LTrim(RTrim(OccupancyCd)) As OccupancyCd, OccupancyDes
	from SHSeleOccupancy with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--	and (StateCd = @StateCd Or StateCd = '99' )
	and (StateCd = @StateCd)
	and OccupancyCd IN ('','L')
	Order by SortOrder
	end
-- 05/18/2018 DeveloperName: DON-1970 end
else --DON-1970
begin --DON-1970
	select LTrim(RTrim(OccupancyCd)) As OccupancyCd, OccupancyDes
	from SHSeleOccupancy with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--	and (StateCd = @StateCd Or StateCd = '99' ) 39373
	and (StateCd = @StateCd)
Order by SortOrder --TL BOP NY 2010
end --DON-1970
/* ACV Code ( Valuation) Support Table Here */
/*DON00013 Begin
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
DON00013 End*/
/*********************************** 39373 START ******************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleACV with (index(IX_SHSeleACV),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
/*DON00013 Begin
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM SHSeleACV with (index(IX_SHSeleACV),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd Or StateCd = '99' ) and 
LineOfBusinessCd=@LOB
ORDER BY StateCd DESC, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/*********************************** 39373 END ******************/
/* For Getting Support Table Data */
Select LTrim(RTrim(ACVCode)) As Code, ACVDescription
 from SHSeleACV with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' )
	and (StateCd = @StateCd)
*/
--For PD Liability Deductible
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)   --TL BOP NY 2010
			AND LookupCd = 'PDLIABDED'
		ORDER BY SortOrderNbr
--DON00013 End
/* Auto Inc Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/********************** 39373 START**************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleAutoInc with (index(IX_BOSeleAutoInc),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
--select @MasterCompanyId AS mco,@PolicyCompanyId as PCO, @StateCd as Stcd ,@LocationId as Loc, @InsuranceLineCd as InsCd
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd = StateCd,
@InsuranceLineCd =insuranceLineCd
FROM BOSeleAutoInc with (index(IX_BOSeleAutoInc),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
LineOfBusinessCd=@LOB 
and (StateCd = @StateCd)    --TL BOP NY 2010
ORDER BY StateCD Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/********************* 39373 END *****************/
--select @MasterCompanyId AS mco,@PolicyCompanyId as PCO, @StateCd as Stcd ,@LocationId as Loc, @InsuranceLineCd as InsCd
/* For Getting Support Table Data */
select LTrim(RTrim(AutoIncCd)) As AutoIncCd, AutoIncDes
 from BOSeleAutoInc with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
	and (StateCd = @StateCd ) ----39373
--	and (StateCd = @StateCd Or StateCd = '99' ) ---39373
/* Sprinkler Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/********************* 39373 START *******************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleSprinkler with (index(IX_BOSeleSprinkler),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSeleSprinkler with (index(IX_BOSeleSprinkler),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd) and    --TL BOP NY 2010
LineOfBusinessCd=@LOB
ORDER BY StateCd Desc,InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/***************************** 39373 END **********************/
/* For Getting Support Table Data */
select LTrim(RTrim(SprinklerCd)) As SprinklerCd, SprinklerDes as SprinklerDes
 from BOSeleSprinkler with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--	and (StateCd = @StateCd Or StateCd = '99' ) 39373
	and (StateCd = @StateCd) ----- 39373
/* CoInsurance Support Table */
/*DON00013 Begin
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
DON00013 End*/
/***************** 39373 START********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleCoinsurancePct with (index(IX_BOSeleCoinsurancePct),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
/*DON00013 Begin
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSeleCoinsurancePct with (index(IX_BOSeleCoinsurancePct),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd Or StateCd = '99' ) and
 LineOfBusinessCd=@LOB
ORDER BY StateCD Desc,InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/***************** 39373 END ********************/
/* For Getting Support Table Data */
select LTrim(RTrim(CoinsurancePctCd)) As CoinsurancePctCd, CoinsurancePctDes
 from BOSeleCoinsurancePct with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--	and (StateCd = @StateCd Or StateCd = '99' ) --39373	
	and (StateCd = @StateCd)
*/
--For Windstorm/Hail % Deductible
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)   --TL BOP NY 2010
			AND LookupCd = 'WINHAILDED'
		ORDER BY SortOrderNbr
--DON00013 End
/* Risk Type Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/******************* 39373 START ***********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleRiskType with (index(IX_SHSeleRiskType),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCD=StateCD
FROM SHSeleRiskType with (index(IX_SHSeleRiskType),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB and (StateCd = @StateCd)  --TL BOP NY 2010
ORDER BY StateCD Desc,locationid,mastercompanyid,policycompanyid
/******************* 39373 END ***********************/
/* End Case #15341 */
/* For Getting Support Table Data */
select LTrim(RTrim(RiskTypeCd)) As RiskTypeCd, RiskTypeDes
 from SHSeleRiskType with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
---	and (StateCd = @StateCd Or StateCd = '99' ) ---39373
 and (StateCd = @StateCd) --39373
/* Shutters Support Table */
/*DON000013 Begin
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/********************** 39373 START ****************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleShutters with (index(IX_SHSeleShutters),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM SHSeleShutters with (index(IX_SHSeleShutters),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') 
 and (StateCd = @StateCd) and   --TL BOP NY 2010
LineOfBusinessCd=@LOB
ORDER BY StateCD Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/********************** 39373 END ****************/
/* For Getting Support Table Data */
select LTrim(RTrim(ShuttersCd)) As ShuttersCd, ShuttersDes
 from SHSeleShutters with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) --39373
 and (StateCd = @StateCd) --39373
*/
--For Building Valuation
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)   --TL BOP NY 2010
			AND LookupCd = 'BLDGVALCD'
		ORDER BY SortOrderNbr
--DON00013 End
/* Compny Bus Support Table */
/*set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSeleCmpnyBusLiabExcl with (nolock) 
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSeleCmpnyBusLiabExcl with (nolock) 
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSeleCmpnyBusLiabExcl with (nolock) 
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end */
/* For Getting Support Table Data */
/*select LTrim(RTrim(CmpnyBusLiabExclTypeCd)) As CmpnyBusLiabExclTypeCd, CmpnyBusLiabExclTypeDes
 from BOSeleCmpnyBusLiabExcl with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' ) */
/* Burglar Alarm Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/********************** 39373 START ****************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleBurglarAlarmInd with (index(IX_BOSeleBurglarAlarmInd),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSeleBurglarAlarmInd with (index(IX_BOSeleBurglarAlarmInd),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd) and --TL BOP NY 2010
LineOfBusinessCd=@LOB
ORDER BY StateCd Desc,InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/********************** 39373 END ****************/
/* For Getting Support Table Data */
select LTrim(RTrim(BurglarAlarmIndTypeCd)) As BurglarAlarmIndTypeCd, BurglarAlarmIndDes
 from BOSeleBurglarAlarmInd with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
--	and (StateCd = @StateCd Or StateCd = '99' ) -- 39373
 and (StateCd = @StateCd) --39373
/* BCEG Code Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/************************ 39373 START **********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleBCEG with (index(IX_SHSeleBCEG),nolock)
where HostCd=@Host AND(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd =StateCd
FROM SHSeleBCEG with (index(IX_SHSeleBCEG),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB AND (StateCd = @StateCd)  --TL BOP NY 2010
ORDER BY StateCD Desc ,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/******************* 39373 END *******************/
/* For Getting Support Table Data */
select LTrim(RTrim(BCEGCd)) As BCEGCd, RTrim(BCEGDes) As BCEGCodedDes
 from SHSeleBCEG with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) 39373
 and (StateCd = @StateCd) --39373
ORDER BY SortOrder		--DON00013
/* BCEG Type Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/******************** 39373 START ****************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleBCEGType with (index(IX_SHSeleBCEGType),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM SHSeleBCEGType with (index(IX_SHSeleBCEGType),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd) and    --TL BOP NY 2010
LineOfBusinessCd=@LOB
ORDER BY StateCd Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/***************** 39373 END ***********************/
/* For Getting Support Table Data */
select LTrim(RTrim(BCEGTypeCd)) As BCEGCd, RTrim(BCEGCodedDes) As BCEGCodedDes
 from SHSeleBCEGType with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) 39373
	and (StateCd = @StateCd)
/* Inflation Per Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/*********************** 39373 START *****************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleInflationGuardPct with (index(IX_SHSeleInflationGuardPct),nolock)
where HostCd=@Host AND(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleInflationGuardPct with (index(IX_SHSeleInflationGuardPct),nolock)
where HostCd=@Host AND(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99') and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB
/* End Case #15341 */
/*********************** 39373 END *****************/
/* For Getting Support Table Data */
select LTrim(RTrim(InflationGuardPctCd)) As InflationGuardCd, InflationGuardPctDes
 from SHSeleInflationGuardPct with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
/* and (StateCd = @StateCd Or StateCd = '99' ) */
    and (StateCd = @StateCd)
/* Premium Basis Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/**************** 39373 START *******************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSelePremBasis with (index(IX_BOSelePremBasis),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSelePremBasis with (index(IX_BOSelePremBasis),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd) and    --TL BOP NY 2010
LineOfBusinessCd=@LOB
ORDER BY StateCd Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/************************ 39373 END **********************/
/* For Getting Support Table Data */
select LTrim(RTrim(PremBasisCd)) As PremBasisCd, PremBasisDes
 from BOSelePremBasis with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) 39373
	and (StateCd = @StateCd)
/* No. of units Support Table */
/*set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSeleNumberofUnits
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSeleNumberofUnits
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSeleNumberofUnits
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end
*/
/* For Getting Support Table Data */
/*
select LTrim(RTrim(NumberofUnitsCd)) As NumberofUnitsCd, NumberofUnitsDes
 from BOSeleNumberofUnits
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' )
*/
/* No. of stories Support Table */
/*set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSeleStoriesNbr
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSeleStoriesNbr
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSeleStoriesNbr
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end
*/
/* For Getting Support Table Data */
/*select LTrim(RTrim(StoriesNbrCd)) As StoriesNbrCd, StoriesNbrDes
 from BOSeleStoriesNbr
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' )
*/
/* Rate Group Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/*********************** 39373 START **********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleRateGroup with (index(IX_SHSeleRateGroup),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=stateCd
FROM SHSeleRateGroup with (index(IX_SHSeleRateGroup),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
LineOfBusinessCd=@LOB and (StateCd = @StateCd) --TL BOP NY 2010
ORDER BY sortorder Desc,locationid,mastercompanyid,policycompanyid	--DON00084
--DON00084 ORDER BY StateCd Desc,locationid,mastercompanyid,policycompanyid
--SELECT @LocationId AS LOC,@MasterCompanyId AS MCO,@PolicyCompanyId AS PCO,@StateCd as StCD
/* End Case #15341 */
/*********************** 39373 END **********************/
/* For Getting Support Table Data */
select LTrim(RTrim(RateGroupCd)) As RateGroupCd, RateGroupDes 
 from SHSeleRateGroup with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) 39373
	 and (StateCd = @StateCd)
ORDER BY SortOrder --DON00013
/* Rate Number Support Table */
 set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/******************* 39373 START ***********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleRateNumber with (index(IX_BOSeleRateNumber),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and (policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSeleRateNumber with (index(IX_BOSeleRateNumber),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd) and    --TL BOP NY 2010
LineOfBusinessCd=@LOB
ORDER BY StateCD Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/********************* 39373 END ***********************/
/* For Getting Support Table Data */
 select LTrim(RTrim(RateNumberCd)) As RateNumberCd, RateNumberDes
 from BOSeleRateNumber with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) 39373
	and (StateCd = @StateCd)
/* Hurricane Deductible Support Table */
/*DON00013 Begin
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
*/
/*********************** 39373 START ******************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM SHSeleHurricaneDed with (index(IX_SHSeleHurricaneDed),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
/*SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM SHSeleHurricaneDed with (index(IX_SHSeleHurricaneDed),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd Or StateCd = '99' ) and
LineOfBusinessCd=@LOB
ORDER BY StateCD Desc,InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/***************** 39373 END ***************/
/* For Getting Support Table Data */
select LTrim(RTrim(HurricaneDedCd)) As HurricaneDedCd, HurricaneDedDes
 from SHSeleHurricaneDed with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) 39373
 and (StateCd = @StateCd ) --39373
*/
--For Building Blanket Type
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId, @TempLocationId) --Fix blanket building empty
			AND MasterCompanyId IN ('99', @MasterCompanyId, @TempMasterCompanyId) --Fix blanket building empty
			AND PolicyCompanyId IN ('99', @PolicyCompanyId, @TempPolicyCompanyId) --Fix blanket building empty
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)   --TL BOP NY 2010
			AND LookupCd = 'BLDGBLNTCD'
		ORDER BY SortOrderNbr
--DON00013 End
/* Water Supply Prp Support Table */
/*set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSeleWaterSupplyPrp with (nolock) 
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSeleWaterSupplyPrp with (nolock) 
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSeleWaterSupplyPrp with (nolock) 
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end*/
/* For Getting Support Table Data */
/*
select LTrim(RTrim(WaterSupplyPrpCd)) As WaterSupplyPrpCd, WaterSupplyPrpDes
 from BOSeleWaterSupplyPrp with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' ) */
/* Utilities Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/********************* 39373 START ***********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleUtilitiesInd with (index(IX_BOSeleUtilitiesInd),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSeleUtilitiesInd with (index(IX_BOSeleUtilitiesInd),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd)    --TL BOP NY 2010
and LineOfBusinessCd=@LOB
ORDER BY StateCd Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/****************************************** 39373 END ***********************/
/* For Getting Support Table Data */
select LTrim(RTrim(UtilitiesIndCd)) As UtilitiesIndCd, UtilitiesIndDes
 from BOSeleUtilitiesInd with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) --39373
 and (StateCd = @StateCd)
/* Class Group Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/******************** 39373 START ********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleClassGroup with (index(IX_BOSeleClassGroup),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSeleClassGroup with (index(IX_BOSeleClassGroup),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd)
 and LineOfBusinessCd=@LOB
ORDER BY StateCd Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/*
if @@rowcount =0
begin
set @locationId='99'
set @Mastercompanyid='99'
set @policycompanyid='99'
end*/
/* End Case #15341 */
/**************************** 39373 END *************/
/* For Getting Support Table Data */
-- and (StateCd = @StateCd Or StateCd = '99' ) --39373   
select LTrim(RTrim(ClassGroupCd)) As ClassGroupCd, ClassGroupDes
 from BOSeleClassGroup with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) --39373
 and (StateCd = @StateCd) --TL BOP NY 2010
/* MaryLand Zone Support Table */
set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
/*********************** 39373 START *********************/
/* Start Case #15341 */
/*SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId
FROM BOSeleMaryLandZone with (index(IX_BOSeleMaryLandZone),nolock)
where HostCd=@Host AND
(locationid=@LocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
(mastercompanyid=@MasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
InsuranceLineCd = @InsuranceLineCd AND
LineOfBusinessCd=@LOB*/
SET @StateCd = @TempStateCd --39373
SET @InsuranceLineCd = @TempInsuranceLineCd --39373
SELECT TOP 1 @LocationId=LocationId, 
@MasterCompanyId=MasterCompanyId,
@PolicyCompanyId=PolicyCompanyId,
@StateCd=StateCd,
@InsuranceLineCd=InsuranceLineCd
FROM BOSeleMaryLandZone with (index(IX_BOSeleMaryLandZone),nolock)
where HostCd=@Host AND
(locationid=@LocationId or locationid='99' ) and 
(mastercompanyid=@MasterCompanyId or mastercompanyid='99' ) and 
(policycompanyid= @PolicyCompanyId or policycompanyid='99') AND
(InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd='999') AND
(StateCd = @StateCd) and LineOfBusinessCd=@LOB  --TL BOP NY 2010
ORDER BY StateCd Desc, InsuranceLineCd Desc,locationid,mastercompanyid,policycompanyid
/* End Case #15341 */
/************************ 39373 END ****************************/
/* For Getting Support Table Data */
select LTrim(RTrim(MaryLandZoneCd)) As MaryLandZoneCd, MaryLandZoneDes
 from BOSeleMaryLandZone with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
-- and (StateCd = @StateCd Or StateCd = '99' ) 39373
 and (StateCd = @StateCd)
/*---------------------------------------------------------------------------- e-Servfice Case no. 13851 ----------------------------------------------------------------------------------------------------*/
-- Location Drop-down Details
Select LocationNbr as LocationCount, 
 convert(varchar(5),LocationNbr) + ' - ' + case(isnull(Ltrim(Rtrim(Address1Txt)),' ')) 
	when ' ' then 'None' else Ltrim(Rtrim(Address1Txt)) end as SeleLocationAddress 
 from SHPropertyLocation with (nolock) where appid=@AppId
-- Building Drop-Down Details
Select StructureNbr as BuildingCount,
 convert(varchar(5),StructureNbr) + ' - ' + case(isnull(Ltrim(Rtrim(BuildingDes)),' ')) 
	when ' ' then 'None' else Ltrim(Rtrim(BuildingDes)) end as BuildingDescription 
 from BOPropertyInfo with (nolock) where appid=@AppId and LocationNbr=@LocationNumber
/*---------------------------------------------------------------------------- e-Servfice Case no. 13851 ---------------------------------------- ------------------------------------------------------------*/
--TL BOP NY 2010 Starts
IF @LOB='BP'
Begin
    --For Personal Property Blanket Type
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)
			AND LookupCd = 'PERSBLNTCD'
		ORDER BY SortOrderNbr
        
    --For Terrorism Property Territory
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)
			AND LookupCd = 'PERSTERRCD'
		ORDER BY SortOrderNbr        
    
    select LTrim(RTrim(LiabDeductAmtCd)) As LiabDeductAmtCd, LiabDeductAmtDes
    from BOSeleLiabDeductAmt with (nolock) 
	where HostCD=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
    and (StateCd = @StateCd)
    ORDER BY SortOrder
	if (@StateCd='NY')
	begin
		select LTrim(RTrim(LiabDeductTypeCd)) As LiabDeductTypeCd, LiabDeductTypeDes
		from BOSeleLiabDeductType with (nolock) 
		where HostCD=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId=@PolicyCompanyId 
		and InsuranceLineCd = @InsuranceLineCd 
		and RTrim(LineOfBusinessCd) = RTrim(@LOB)
		and (StateCd = @StateCd)
		ORDER BY SortOrder    
	end
	else if (@StateCd='CA')
	begin
		select LTrim(RTrim(GlassDeductibleCd)) As LiabDeductTypeCd, LTrim(RTrim(GlassDeductibleDes)) AS LiabDeductTypeDes
		 from BPSeleGlassDeductible with (nolock) 
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId=@MasterCompanyId 
			and PolicyCompanyId=@PolicyCompanyId 	
			and RTrim(LineOfBusinessCd) = RTrim(@LOB)
			and StateCd = @StateCd
			and InsuranceLineCd=@InsuranceLineCd
		ORDER BY SortOrder
	end
End
--TL BOP NY 2010 Ends
--DON00013 Begin
SET @StateCd = @TempStateCd --DON00089
/*DON00084 begin
--For Personal Property Valuation
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
			AND LookupCd = 'PERSVALCD'
		ORDER BY SortOrderNbr
--For Personal Property Blanket Type
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
			AND LookupCd = 'PERSBLNTCD'
		ORDER BY SortOrderNbr
--DON00013 End
DON00084 begin*/
--DON00084 begin
--For Program Code
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)   --TL BOP NY 2010
			AND LookupCd = 'PROGRAMCD'
		ORDER BY SortOrderNbr
--For Sub Type Code
	SELECT LookupValueCd , LookupValueDesc 
		FROM SHSeleLookupValues
		WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
            and RTrim(LineOfBusinessCd) = RTrim(@LOB)   --TL BOP NY 2010
			AND LookupCd = 'SUBTYPECD'
		ORDER BY SortOrderNbr
--DON00084 end
--TP BOP NY 2010 START
--IF @LOB='BP'
--fsist 145545 issue 159 11/1/12 dlh start
declare @tempTable Table (TerritoryCd char(6), TerritoryDes char(40), RateGroupCd char (1))
IF @InsuranceLineCd = 'NBP' 
BEGIN
    --TL BOP NY 2010 Start - Order Territory by zip code
	--SELECT RTrim(TerritoryCd), TerritoryDes, RateGroupCd --TL BOP NY 2010, Disable Rate Group
	--		FROM SHSeleterritoryCodes
	--		WHERE HostCd = @Host				
	--			AND StateCd IN ('99' , @StateCd)
	--			and RTrim(LineOfBusinessCd) = RTrim(@LOB)
    --declare @tempTable Table (TerritoryCd char(6), TerritoryDes char(40), RateGroupCd char (1))
    Insert into @tempTable 
    SELECT     RTrim(TerritoryCd), TerritoryDes, RateGroupCd
    FROM         SHSeleTerritoryCodes
    --WHERE     (StateCd = 'NY') AND (SUBSTRING(TerritoryDes, 1, 1) <> '1') --fsit 124098
    WHERE     (StateCd = @StateCd) AND (SUBSTRING(TerritoryDes, 1, 1) <> '1')
              and LineOfBusinessCd=@LOB
    ORDER BY TerritoryDes
    Insert into @tempTable
    SELECT     RTrim(TerritoryCd), TerritoryDes, RateGroupCd
    FROM         SHSeleTerritoryCodes
    --WHERE     (StateCd = 'NY') AND (SUBSTRING(TerritoryDes, 1, 1) = '1')  --fsit 124098
    WHERE     (StateCd = @StateCd) AND (SUBSTRING(TerritoryDes, 1, 1) = '1')
              and LineOfBusinessCd=@LOB
    ORDER BY SUBSTRING(TerritoryDes, 1, 5)
    select RTrim(TerritoryCd), TerritoryDes, RateGroupCd from @tempTable                
    --TL BOP NY 2010 End - Order Territory by zip code
END
IF @InsuranceLineCd = 'CBP'
BEGIN    
	Declare @RiskStateZipCode as varchar(5)
	--print 'Location Number for State ' + convert(varchar(5), @LocationNumber)
	set @RiskStateZipCode = (Select substring(zipcd,1,5) from SHPropertyLocation where appid = @Appid and LocationNbr = @LocationNumber)    
	--print @RiskStateZipCode
	if (Select count(territory) from BoSeleTerritory where zipcode = @RiskStateZipCode and statecd = @StateCd and InsuranceLineCd = @InsuranceLineCd) > 0
	   Begin
         Insert into @tempTable 
		 SELECT     RTrim(TerritoryCd), TerritoryDes, RateGroupCd
		 FROM         SHSeleTerritoryCodes    
		 Where (StateCd = @StateCd)
			and territorycd in (select Territory from BoSeleTerritory where zipcode = @RiskStateZipCode and statecd = @StateCd and InsuranceLineCd = @InsuranceLineCd )
			and LineOfBusinessCd=@LOB
		 ORDER BY TerritoryDes
	   End	 
    Else
       Begin 
         Insert into @tempTable 
		 SELECT     RTrim(TerritoryCd), TerritoryDes, RateGroupCd
		 FROM         SHSeleTerritoryCodes    
		 Where (StateCd = @StateCd)			
			and LineOfBusinessCd=@LOB
		 ORDER BY TerritoryDes
	   End
       
    select RTrim(TerritoryCd), TerritoryDes, RateGroupCd from @tempTable                
    
END
--fsist 145545 issue 159 11/1/12 dlh end
--TP BOP NY 2010 START
--DON00089 Begin
IF NOT EXISTS(SELECT 1 FROM SHCoverageDetails with (nolock)
				WHERE AppId = @AppId
					AND LocationNbr=@LocationNumber 
					AND BuildingNbr=@BuildingNumber 
					AND InsuranceLineCd = @InsuranceLineCd 
					AND CoverageCd IN (SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @Host
																					AND LocationId IN ('99', @LocationId)
																					AND MasterCompanyId IN ('99', @MasterCompanyId)
																					AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
																					AND LineOfBusinessCd = @LOB
																					AND InsuranceLineCd = @InsuranceLineCd
																					AND StateCd IN ('99' , @StateCd)
																					AND InsuranceLineCovInd = 2))
	 
BEGIN		
		DECLARE BuildingCovCursor CURSOR FOR 
		SELECT CoverageCd FROM SHSeleCoverageAttributes 
			WHERE HostCd = @Host
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
			AND LineOfBusinessCd = @LOB
			AND InsuranceLineCd = @InsuranceLineCd
			AND StateCd IN ('99' , @StateCd)
			AND InsuranceLineCovInd = 2 
		ORDER BY SortOrderNbr
		OPEN BuildingCovCursor
		FETCH NEXT FROM BuildingCovCursor INTO @BldgCoverageCd
		WHILE (@@FETCH_STATUS = 0)
		BEGIN
			EXEC SHInsertCoverage @AppId = @AppId
				, @HostCd = 'PT'
				, @LocationId = @LocationId
				, @MasterCompanyId = @MasterCompanyId
				, @PolicyCompanyId = @PolicyCompanyId
				, @LocationNbr = @LocationNumber		
				, @BuildingNbr = @BuildingNumber
				, @LineOfBusinessCd = @LOB
				, @InsuranceLineCd = @InsuranceLineCd
				, @StateCd = @StateCd
				, @CoverageCd = @BldgCoverageCd
		FETCH NEXT FROM BuildingCovCursor INTO @BldgCoverageCd
		END
		CLOSE BuildingCovCursor
		DEALLOCATE BuildingCovCursor
END
select LTrim(RTrim(GroupCd)) As GroupCd, LTrim(RTrim(GroupDes)) AS GroupDes
 from SHSeleGroupCode with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 	
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
	and StateCd = @StateCd
	and GroupCD  = (Select RiskTypeCD from BOPropertyInfo with(nolock) 
					 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId )
--TL FSIT 151183 Starts
select LTrim(RTrim(CoinsuranceCd)) As CoinsurancePctCd, CoinsuranceDes
 from BPSeleCoinsurance with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
	and (StateCd = @StateCd)
--TL FSIT 151183 Ends
--DON00089 End
--TL FSIT 144444 issue 170-174 10/30/2012 Starts
/*
Declare @RiskType varchar(10)
Set @RiskType = (Select LookupValueCd 
From SHSeleLookupValues with(nolock) 
Where LookupCd = 'BUSINCRISK' 
	and rtrim(LookupValueDesc)=(Select rtrim(RiskTypeCD) from BOPropertyInfo with(nolock) 
					 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId ))
UPDATE SHCoverageDetailItems 
SET FieldValueTxt = isnull(@RiskType,'OTHER')
WHERE AppId = @AppId
AND LocationNbr = @LocationNumber
AND BuildingNbr = @BuildingNumber
AND LineOfBusinessCd = @LOB	--TL BOP NY 2010
AND InsuranceLineCd = @InsuranceLineCd
AND CoverageCd = 'BIEE'	
AND FieldNameTxt = 'BIEE_TypeOfRisk'
*/
--TL FSIT 144444 issue 170-174 10/30/2012 Ends
/* CommsupplyInd Support Table */
/* set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSeleCommsupplyInd with (nolock) 
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSeleCommsupplyInd with (nolock) 
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSeleCommsupplyInd with (nolock) 
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end */
/* For Getting Support Table Data */
/*select LTrim(RTrim(CommsupplyIndCd)) As CommsupplyIndCd, CommsupplyIndDes
 from BOSeleCommsupplyInd with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' ) */
/* OverHdPwdInd Support Table */
/* set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSeleOverHdPwdInd with (nolock) 
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSeleOverHdPwdInd with (nolock) 
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSeleOverHdPwdInd with (nolock) 
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end */
/* For Getting Support Table Data */
/* select LTrim(RTrim(OverHdPwdIndCd)) As OverHdPwdIndCd, OverHdPwdIndDes
 from BOSeleOverHdPwdInd with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' ) */
/* PowerSupplyInd Support Table */
/* set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSelePowerSupplyInd with (nolock) 
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSelePowerSupplyInd with (nolock) 
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSelePowerSupplyInd with (nolock) 
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end */
/* For Getting Support Table Data */
/* select LTrim(RTrim(PowerSupplyIndCd)) As PowerSupplyIndCd, PowerSupplyIndDes
 from BOSelePowerSupplyInd with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' ) */
/* PowerSupplyInd Support Table */
/* set @LocationId = @TempLocationId
set @MasterCompanyId = @TempMasterCompanyId
set @PolicyCompanyId = @TempPolicyCompanyId
set @Count = (Select Count(*) from BOSeleOverHdCommnInd with (nolock) 
	where HostCd=@Host and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and LineOfBusinessCd=@LOB )
if @Count = 0
begin
	set @Count = (Select Count(*) from BOSeleOverHdCommnInd with (nolock) 
		where HostCd=@Host 
		and LocationId=@LocationId 
		and MasterCompanyId=@MasterCompanyId 
		and PolicyCompanyId='99' 
		and InsuranceLineCd = @InsuranceLineCd 
		and LineOfBusinessCd=@LOB )
	If @Count > 0 
		Begin
			set @PolicyCompanyId = '99'
		End
	Else
		begin
		set @Count = (Select Count(*) from BOSeleOverHdCommnInd with (nolock) 
			where HostCd=@Host 
			and LocationId=@LocationId 
			and MasterCompanyId='99' 
			and PolicyCompanyId='99' 
			and InsuranceLineCd = @InsuranceLineCd 
			and LineOfBusinessCd=@LOB )
		 if @count > 0 
		 begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
 		 end
		 else
		 Begin
 			set @PolicyCompanyId = '99'
			set @MasterCompanyId = '99'	
			set @LocationId = '99'			
		 End
	 End
end */
/* For Getting Support Table Data */
/* select LTrim(RTrim(OverHdCommnIndCd)) As OverHdCommnIndCd, OverHdCommnIndDes
 from BOSeleOverHdCommnInd with (nolock) 
	where HostCd=@Host 
	and LocationId=@LocationId 
	and MasterCompanyId=@MasterCompanyId 
	and PolicyCompanyId=@PolicyCompanyId 
	and InsuranceLineCd = @InsuranceLineCd 
	and RTrim(LineOfBusinessCd) = RTrim(@LOB)
 and (StateCd = @StateCd Or StateCd = '99' ) */

GRANT EXECUTE ON [dbo].[BPRetrieveBuildingInfo] TO [isol_app] AS [dbo]

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[BPRetrieveQuote]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[BPRetrieveQuote]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

CREATE Procedure [dbo].[BPRetrieveQuote]
@Appid varchar(20)= Null,
@Host varchar(20) = Null,
@LOC varchar(2) = Null,
@MCO varchar(2) = Null,
@PCO varchar(2) = Null,
@StateCd varchar (2) = Null,
-- Case 21864 Begins
@SequenceNbr smallint = 1,
--@Host char(2) = NULL,
@LOB Char(3) = NULL,
@LocationId char(3) = NULL,
@MasterCompanyId char(3) = NULL,
@PolicyCompanyId char(3) = NULL,
@InsuranceLineCd char(3) = NULL,
@LocationNumber smallint = 1,
@BuildingNbr smallint = 1
-- Case 21864 Ends
As 
begin
 set nocount on
 declare @intRet integer 
 declare @nInd int
 declare @TempCovCd varchar(6)
 declare @State char(2)
--fsit 240038 dlh start
 declare @BoundInd integer 
 set @BoundInd = (select count(*)  from shplaninfo a, BoCoverage b  
                  where a.appid = @appid and b.appid = @appid and a.issued = 1
                  and b.CoverageCD = 'MECHBD')
               
 --fsit 240038 dlh 3/1/16 end 
Set @InsuranceLineCd = (select top 1 WCLineOfBusiness from SHPlanInfo (nolock) where appid=@AppId)    --TL BOP NY 2010 
--FSIT 145313 start PP
set @LocationId = @LOC 
set @MasterCompanyId = @MCO
set @PolicyCompanyId = @PCO
--FSIT 145313 end PP
/*117502 STARTS*/
declare @ClientName1 varchar(100)
declare @ApplicantTypeCd char(1)
Set @ApplicantTypeCd=(Select ApplicantTypeCd from SHClient where AppId=@AppId And ClientNumber=0)
if (isnull(@ApplicantTypeCd,'0'))='I'
begin
set @ClientName1 = (select FirstName +' '+ LastName from SHClient where AppId=@AppId And ClientNumber=0)
end
else
set @ClientName1 = (select LongName from SHClient where AppId=@AppId And ClientNumber=0) 
/*117502 ENDS*/
/*-- 34771 start --*/
Declare @PolicyStatusCd char(1)
Declare @AmendXTransDt datetime
 Select @PolicyStatusCd = PolicyStatusCd, @StateCd = RiskState, --Pcr 66 
	@AmendXTransDt = TransactionEffectiveDt
	 FROM SHPlanInfo WHERE AppId = @AppId
/*-- 34771 end --*/
set @intRet = (Select Rated from SHPlanInfo with (nolock) where Appid = @Appid)
/*	Case 14738 Changed Int to Char datatype */
--if @intRet = 0 raiserror ('Policy has not been rated',17,1)
-------------GET BASIC CONTRACT INFO----------------------------
------------------------------------------------------------------------------------------
SELECT
PI_POLICY_NUMBER 	= SHPlaninfo.Symbol + ' ' + SHPlaninfo.PolicyNumber, 
--PI_MASTER_COMPANY = SHPlaninfo.MasterCompanyId,		--DON00197A
PI_MASTER_COMPANY = 'DB',					--DON00197A --DON-1571 TT: change Dongbu Insurance to DB
PI_LOCATION_ID	= SHPlaninfo.LocationId,
PI_RISK_STATE	= SHPlaninfo.RiskState, 
--PI_AGENT_ID		= SHPlaninfo.AgentID, --Issue # 57418 Code commented 
PI_ENTERED_DATE 	= SHPlaninfo.EnteredDate, 
PI_EFF_DATE 		= SHPlaninfo.EffectiveDate, 
PI_EXP_DATE 		= SHPlaninfo.ExpirationDate, 
PI_TERM 		= SHPlanInfo.Term,
PI_CUST_NO 		= SHPlaninfo.CustomerNumber,
--PI_POLICY_CO 	= SHPlaninfo.PolicyCompanyId,			--DON00198A
PI_POLICY_CO 	= 'DB',					--DON00198A --DON-1571 TT: change Dongbu Insurance to DB
PI_LINE_OF_BUSINESS = (CASE SHPlaninfo.LineofBusiness WHEN 'BP' THEN 'Business Owners' ELSE SHPlaninfo.LineofBusiness END),	--DON00061
PI_AUDIT_TYPE 	=(Select Distinct AuditTypeDes from SHSeleAuditType with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 (LineOfBusinessCd = 'BP' or LineOfBusinessCd = '999') and
						 CoverageCd = '999999' and 	 
						 (StateCd = @StateCd or StateCd = '99' ) and 
						 --(InsuranceLineCd = 'BOP' or InsuranceLineCd = 'STC' or InsuranceLineCd = '999') and      --TL BOP NY 2010
                         (InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd = 'STC' or InsuranceLineCd = '999') and  --TL BOP NY 2010
						 AuditTypeCd = SHPlaninfo.AuditType),
PI_AUDIT_FREQ 	= (Select Distinct AuditFrequencyDes from SHSeleAuditFrequency with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 (LineOfBusinessCd = 'BP' or LineOfBusinessCd = '999') and
						 CoverageCd = '999999' and 	 
						 (StateCd = @StateCd or StateCd = '99' ) and 
						 --(InsuranceLineCd = 'BOP' or InsuranceLineCd = 'STC' or InsuranceLineCd = '999') and      --TL BOP NY 2010
                         (InsuranceLineCd = @InsuranceLineCd or InsuranceLineCd = 'STC' or InsuranceLineCd = '999') and  --TL BOP NY 2010
						 AuditFrequencyCd = SHPlanInfo.AuditFrequency),
--DON00059 Begin
--DON00198A Begin
/*PI_PROGRAM_CODE 	=(SELECT DISTINCT ProgCodeDes FROM BOSeleProgCode WITH (NOLOCK) 
						WHERE HostCd = @Host 
							AND (LocationId = @LOC or LocationId = '99')
							AND (MasterCompanyId = @MCO OR MasterCompanyId = '99') 
							AND (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') 
							AND (LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') 
							AND CoverageCd = '999' 
							AND (StateCd = @StateCd or StateCd = '99' ) 
							AND (InsuranceLineCd = 'BOP' or InsuranceLineCd = '999') 
							AND ProgCodeCd = SHPlaninfo.ProgramCode),*/
PI_PROGRAM_CODE 	=(SELECT TOP 1 CASE ISNULL(ProgramCd,'') WHEN 'S' THEN 'Special' WHEN 'R' THEN 'Regular' Else '' END
						FROM BOPropertyInfo
						WHERE AppId = @AppId),
--DON00198A End
--DON00059 End
PI_RISK_STATE 	= SHPlaninfo.RiskState,
--TL FSIT 152623 Changed to business entity - Starts
--PI_LEGAL_ENTITY 	= SHSeleLegalEntityType.Description ,
PI_LEGAL_ENTITY 	= SHSeleBusinessEntityType.Description ,
--TL FSIT 152623 Changed to business entity - Ends
PI_BUSINESS_DESC 	= SHPlanInfo.PreviousCarrier,
--issue 107042 starts
PI_PAYMENT_PLAN= SHPlaninfo.PaymentPlan,
--Issue 107042 ends
/*CLIENT_NAME 		= SHClient.LongName,*/
CLIENT_NAME 		= @ClientName1, /*ISSUE #117502*/ 
CLIENT_DBA_NAME 	= SHClient.DBAName, 
/* .Net change
CLIENT_ADDRESS 	= ISNULL(SHClientAddress.Address1, '') + ' ' + ISNULL(SHClientAddress.Address2, '') + ' ' + 
 		 	 ISNULL(SHClientAddress.Address3, '') + ' ' + ISNULL(SHClientAddress.Address4, ''), 
*/
CLIENT_ADDRESS 	= ISNULL(SHClientAddress.Address1, ''),
CLIENT_ADDRESS2 	= ISNULL(SHClientAddress.Address2, ''), 
CLIENT_CSZ 		= ISNULL(SHClientAddress.City, '') + ' ' + ISNULL(SHClientAddress.State, '') + ' ' + ISNULL(SHClientAddress.Zip, ''), 
CLIENT_PHONE_TYPE = SHClientPhone.PhoneType, 
CLIENT_PHONE 	= SHClientPhone.PhoneNumber,
PI_PAY_PLAN 		= SHSelePaymentPlan.PaymentPlanName, --substring(SHBillingInfo.PaymentMethodCD, 1, 1),		--DON00061
PI_PAY_MODE 		= substring(SHBillingInfo.PaymentMethodCD, 2, 1),
PI_PAY_RENEW = substring(SHBillingInfo.PaymentMethodCD, 1, 1), 
PI_PAY_RENEWMODE = substring(SHBillingInfo.PaymentMethodCD, 2, 1),
PI_LAST_UPDATE_DATE = GetDate(),
BO_RATE_TOTAL =(Select qq.ttt from (Select SUM(PremiumAmt) as ttt from BORating with (nolock) GROUP BY AppId, LocationNbr, BuildingNbr,CoverageCd having AppId = @AppId and 
				LocationNbr = 0 and BuildingNbr = 0 and CoverageCd = '0') as qq), -- case 23402
PI_REM = (Select rtrim(RemarksTxt) from BOAcordFields with (nolock) where AppId =@Appid), -- case 23402
PI_LAST_QUOTED_DATE = SHPlaninfo.PolicyLastQuoteDt, -- case 12850
BO_TAX_TOTAL =(Select isnull(SUM(PremiumAmt),0) as taxamt from BORating with (nolock) 
				Where AppId = @AppId and LocationNbr = 0 and BuildingNbr = 0 and CoverageCd = 'TAX') -- Issue 35271
--,AmendXPolStat = @PolicyStatusCd,	--34771
--AmendXActStat = SHClient.ActivityStatusCd	--34771	
, PI_PREMIUM_RECD = '$' + CONVERT(VARCHAR(20), Convert(DECIMAL(10,2), DepositAmtWithApp)), PI_CHECK = PICheck 		--106292
, PI_USERID = SHPlaninfo.UserId --Issue 104391
--LR BOP NY 2010 - Issue #91 - Start
, PremiumTerrorWith = ISNULL(SHPlanInfo.PremiumTerrorWith,0) 
, PremiumTerrorWithout = ISNULL(SHPlanInfo.PremiumTerrorWithout,0)  
, PremiumTerrorWithTax = ISNULL(SHPlanInfo.PremiumTerrorWithTax,0)   --LR - More Issue #91
, PremiumTerrorWithoutTax = ISNULL(SHPlanInfo.PremiumTerrorWithoutTax,0)   --LR - More Issue #91
--LR BOP NY 2010 - Issue #91 - End
 FROM SHClient with (nolock) 
 Left JOIN SHClientAddress on SHClientAddress.AppId=@AppId and SHClientAddress.ClientNumber=0 
 LEFT JOIN SHClientPhone ON SHClientAddress.AppId = SHClientPhone.AppId
 left JOIN SHPlaninfo on SHPlaninfo.AppId=@AppId
-- Start Issue 35271
-- left Join SHSeleLegalEntityType on SHSeleLegalEntityType.Code = SHPlanInfo.EntityTypeCode and SHSELELegalEntityType.Host = 'PT'
-- left JOIN SHSeleStateCode on SHSeleStateCode.StateCode = SHPlaninfo.RiskState and SHSeleStateCode.Host = 'PT'
--TL FSIT 152623 Changed to business entity - Starts
 --left Join SHSeleLegalEntityType on SHSeleLegalEntityType.Code = SHPlanInfo.EntityTypeCode and SHSELELegalEntityType.Host = @Host
 left Join SHSeleBusinessEntityType on SHSeleBusinessEntityType.Code = SHPlanInfo.EntityTypeCode and SHSeleBusinessEntityType.Host = @Host
 --TL FSIT 152623 Changed to business entity - Ends
 left JOIN SHSeleStateCode on SHSeleStateCode.StateCode = SHPlaninfo.RiskState and SHSeleStateCode.Host = @Host
-- End Issue 35271
 left join SHBillingInfo on SHBillingInfo.AppId = @AppId
 --LEFT JOIN SHSelePaymentPlan ON LOB = 'BO' AND RTRIM(SHSelePaymentPlan.PaymentPlanCode) = RTRIM(SHPlaninfo.PaymentPlan)		--DON00061 --TL BOP NY 2010
 LEFT JOIN SHSelePaymentPlan ON LOB = @LOB AND RTRIM(SHSelePaymentPlan.PaymentPlanCode) = RTRIM(SHPlaninfo.PaymentPlan)		--DON00061  --TL BOP NY 2010
 WHERE SHClient.AppId=@AppId And SHClient.ClientNumber=0;
----------GET INSURANCE LINE INFO------------------------------
----------------------------------------------------------------------------------------
--DON00059 Begin
select 	BO_INS_INSLINE	 = 	InsuranceLineCd,
	BO_INS_OCCUR_LIMIT = 	PerOccurrenceAmt,
	BO_INS_GEN_AGGR 	=	GenAggregateAmt,
	BO_INS_PROD_AGGR 	=	ProdAggregateAmt,
	--LR FSIT 138588 - BOP NY 2010 - START
	BO_INS_FIRE_LIMIT	= 	FireLiabilityAmt,
	BO_INS_MED_EXP_EXCL = IsNull((
				Select	Case MedicalExpExclusionInd
							When 0 Then 'No'
							When 1 Then 'Yes'
							Else 'No'
						End
				From BOInsuranceLine with (nolock) 
				Where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd
			  ), 'No'),
	--LR FSIT 138588 - BOP NY 2010 - END
--DON00111 Begin
	--BO_INS_MED_EXP	=	ISNULL((SELECT LimitValue1 FROM SHSeleCovAmount WHERE Host = @Host AND CoverageCode = 'MED' AND LOB = 'BO' AND State IN ('99', @StateCd) AND Code = MedicalExpenseAmt),'')  --TL BOP NY 2010
	----LR FSIT 138588 - BOP NY 2010 - START
    BO_INS_MED_EXP	=	ISNULL((SELECT LimitValue1 FROM SHSeleCovAmount WHERE Host = @Host AND CoverageCode = 'MED' AND LOB = @LOB AND State IN ('99', @StateCd) AND Code = MedicalExpenseAmt),''), --TL BOP NY 2010
	BO_INS_ASS_BAT_EXCL = IsNull((
				Select	Case AssaultBatExclustionInd
							When 0 Then 'No'
							When 1 Then 'Yes'
							Else 'No'
						End As AssaultBatExclustionInd
				From BOInsuranceLine with (nolock) 
				Where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd
			  ), 'No')
	--LR FSIT 138588 - BOP NY 2010 - END
--	BO_INS_MED_EXP	=	MedicalExpenseAmt
--DON00111 End
	, BO_INS_PERSONALINJURY_LIMIT = PersonalInjuryAmt
	--LR FSIT 138588 - BOP NY 2010 - START
	--LR BOP NY 2010 - Issue #85 - START
	, BO_INS_ADVERTISINGINJURY_LIMIT = 
		 CASE @StateCd
			WHEN 'NY' THEN IsNull(DamagePreRen,0)
			ELSE CAST(AdvertisingInjuryAmt As Varchar)
		 END,
	--, BO_INS_ADVERTISINGINJURY_LIMIT = IsNull(DamagePreRen,0),
	--LR BOP NY 2010 - Issue #85 - END
	--, BO_INS_ADVERTISINGINJURY_LIMIT = AdvertisingInjuryAmt,
	--LR FSIT 138588 - BOP NY 2010 - END
	-- BO_INS_FORM_CODE	= 	FormCodeCd,
/*
	BO_INS_FORM_CODE = (Select Distinct FormCodeDes from SHSeleFormCode with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 (LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') and
						 (StateCd = @StateCd or StateCd = '99' ) and 
						 (InsuranceLineCd = BOInsuranceLine.InsuranceLineCd or InsuranceLineCd = '999') and 
						 FormCodeCd = BOInsuranceLine.FormCodeCd),*/
	--DON00059 End
	BO_INS_AUD_TYPE	= 	(Select Distinct AuditTypeDes from SHSeleAuditType with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 (LineOfBusinessCd = 'BP' or LineOfBusinessCd = '999') and
						 CoverageCd = '999999' and 	 
						 (StateCd = @StateCd or StateCd = '99' ) and 
						 (InsuranceLineCd = BOInsuranceLine.InsuranceLineCd or InsuranceLineCd = '999') and 
						 AuditTypeCd = BOInsuranceLine.AuditTypeCd),
	BO_INS_AUD_FREQ 	=	(Select Distinct AuditFrequencyDes from SHSeleAuditFrequency with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 (LineOfBusinessCd = 'BP' or LineOfBusinessCd = '999') and
						 CoverageCd = '999999' and 	 
						 (StateCd = @StateCd or StateCd = '99' ) and 
						 (InsuranceLineCd = BOInsuranceLine.InsuranceLineCd or InsuranceLineCd = '999') and 
						 AuditFrequencyCd = BOInsuranceLine.AuditFreqCd),
	/* Retreiving the Total Premium for a perticular Insurance Line */
	BO_INS_TOTAL_PREM = (Select PremiumAmt from BORating with (nolock) where AppId = @AppId and 
				 InsuranceLineCd = BOInsuranceLine.InsuranceLineCd and 
				 LocationNbr = 0 and BuildingNbr = 0 and CoverageCd = '0'),
	/* Retriving the Sum Total of all the InsuranceLine Coverages */
	BO_INS_COV_SUM = cast((Select qq.ttt from (Select SUM(PremiumAmt) as ttt from BORating with (nolock) where AppId = @AppId 
				and InsuranceLineCd = BOInsuranceLine.InsuranceLineCd and LocationNbr = 0 
 --FSIT 145313 PP start
				and BuildingNbr = 0 and CoverageCd <> '0')as qq) as money),
	BO_INS_DAM_PRE_REN = isnull(DamagePreRen,0), --revert code for BP CA 2010 
	BO_BLA_RAT_IND = IsNull((
				Select	Case BlanketRatingInd
							When 0 Then 'No'
							When 1 Then 'Yes'
							Else 'No'
						End
				From BOInsuranceLine with (nolock) 
				Where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd
			  ), 'No') --FSIT 145313 PP end
	From BOInsuranceLine 
--	Where BOInsuranceLine.AppId = @AppId and BOInsuranceLine.HostCd = 'PT' ORder by BOInsuranceLine.InsuranceLineCd;
	Where BOInsuranceLine.AppId = @AppId ORder by BOInsuranceLine.InsuranceLineCd;
-----------------------GET LOCATION INFO--------------------------
-------------------------------------------------------------------------------------
select 	BO_LOC_NBR 		= 	LocationNbr,
	BO_LOC_ADDR1	= 	Address1Txt,
	BO_LOC_ADDR2 	= 	Address2Txt,
	BO_LOC_CITY		= 	CityNm,
	BO_LOC_STATE 	= 	StateCd,
	BO_LOC_ZIP 		=	 ZipCd
	--BO_LOC_COUNTY 	=	CountyNm
from SHPropertyLocation with (nolock) 
--Where SHPropertyLocation.AppId = @AppId and SHPropertyLocation.HostCd = 'PT' ORDER BY SHPropertyLocation.LocationNbr; --Issue 35271
--Where SHPropertyLocation.AppId = @AppId and SHPropertyLocation.HostCd = @Host ORDER BY SHPropertyLocation.LocationNbr; --Issue 35271	-- .NET Issue
Where SHPropertyLocation.AppId = @AppId ORDER BY SHPropertyLocation.LocationNbr		-- .NET Issue
--------------------GET PROPERTY INFO-------------------------
----------------------------------------------------------------------------------
select 	BO_BLDG_INSLINE = BOPropertyInfo.InsuranceLineCd,		
	BO_BLDG_LOCNBR =BOPropertyInfo.LocationNbr,
	BO_BLDG_BLDGNBR=	BOPropertyInfo.StructureNbr,
	BO_BLDG_CLASSCD = BOPropertyInfo.ClassCd,
	BO_BLDG_CLASSDESC = BOPropertyInfo.ClassDes,
--DON00248 Begins Here
--	BO_BLDG_TERRITORY = (Select Distinct TerritoryDes from SHSeleTerritoryCodes with (nolock) where HostCd = @Host and 	
--						 (LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') and
--						 (StateCd = (Select StateCd from SHPropertyLocation Where AppId=@AppId and 
--								LocationNbr = BOPropertyInfo.LocationNbr) or StateCd = '99' ) and 
--						 TerritoryCd = BOPropertyInfo.TerritoryCd),
	BO_BLDG_TERRITORY = BOPropertyInfo.TerritoryCd,
--DON00248 Ends Here
	BO_BLDG_CONST = (Select Distinct ConstructionDes from SHSeleconstruction with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 --(LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') and   --TL BOP NY 2010
                         (LineOfBusinessCd = @LOB or LineOfBusinessCd = '999') and   --TL BOP NY 2010
						 (StateCd = (Select StateCd from SHPropertyLocation Where AppId=@AppId and 
								LocationNbr = BOPropertyInfo.LocationNbr) or StateCd = '99' ) and 
						 (InsuranceLineCd = BOPropertyInfo.InsuranceLineCd or InsuranceLineCd = '999') and 
						 ConstructionCd = BOPropertyInfo.ConstructionCd),
	BO_BLDG_PROT_CLS = (Select Distinct ProtectionClassDes from BOSeleProtectionClass with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 --(LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') and   --TL BOP NY 2010
                         (LineOfBusinessCd = @LOB or LineOfBusinessCd = '999') and   --TL BOP NY 2010
						 CoverageCd = '999999' and	
						 (StateCd = (Select StateCd from SHPropertyLocation Where AppId=@AppId and 
								LocationNbr = BOPropertyInfo.LocationNbr) or StateCd = '99' ) and 
						 (InsuranceLineCd = BOPropertyInfo.InsuranceLineCd or InsuranceLineCd = '999') and 
						 ProtectionClassCd = BOPropertyInfo.ProtectionClassCd),
	BO_BLDG_UNITDED = BOPropertyInfo.UnitDeductCd ,	
	BO_BLDG_OCCU = (Select Distinct OccupancyDes from SHSeleOccupancy with (nolock) where HostCd = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 --(LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') and   --TL BOP NY 2010
                         (LineOfBusinessCd = @LOB or LineOfBusinessCd = '999') and   --TL BOP NY 2010
						 (StateCd = (Select StateCd from SHPropertyLocation Where AppId=@AppId and 
								LocationNbr = BOPropertyInfo.LocationNbr) or StateCd = '99' ) and 
						 (InsuranceLineCd = BOPropertyInfo.InsuranceLineCd or InsuranceLineCd = '999') and 
						 OccupancyCd = BOPropertyInfo.OccupancyCd),
	BO_BLDG_LIMIT = BOPropertyInfo.BuildingLimitAmt,
--DON00247A Begins Here
	BO_FIX_EQUIP_LIMIT = BOPropertyInfo.FixturesEquipLimitAmt,
--DON00247A Ends Here
	BO_BLDG_PERSPROP= BOPropertyInfo.BusinessPPAmt,
	BO_BLDG_DESC = BOPropertyInfo.BuildingDes,
	/* Retreiving the Premium for a perticular Building this is equal to sum of all the coverages for that building*/
	BO_BLDG_PREM = (Select PremiumAmt from BORating with (nolock) where AppId = @AppId and InsuranceLineCd = BOPropertyInfo.InsuranceLineCd and
			LocationNbr = BOPropertyInfo.LocationNbr and BuildingNbr = BOPropertyInfo.StructureNbr and CoverageCd = '0')	 
--DON00059 Begin
	, BldgYearBuilt = ISNULL(YearBuilt,'')
    , BldgNbrofStories = StoriesCountNbr
	, BldgTotalSquareFt = SquareFtAreaAmt
	, BldgSprinklerSystem = (CASE SprinklerInd WHEN 'Y' THEN 'Yes' ELSE 'No' END)
	, BldgAnnualSales = GrossSalesAmt
--fsit 146628 set the proper amount for each State dlh 11/27/12	start
	, BldgLiquorSales = (Case when @LOB = 'BP' and @StateCd = 'CA' THEN
	                      PayRollAmt
	                     Else
	                      LiquorSalesAmt
	                     End) 	                      
--	, BldgLiquorSales = LiquorSalesAmt BPCA 1010 issue 276 11/13/12 dlh
--  , BldgLiquorSales = PayRollAmt
--fsit 146628 set the proper amount for each State dlh 11/27/12	end
	, BldgNbrofEmployees = EmployeeCountNbr	
-- TP 135862 START
	, BldgAutomaticInc = BOPAutoIncPctCd
-- TP 135862 END
--Property Factor
	, InsuredSoleOccupantInd = (CASE InsSoleOccFreeStandBldgInd WHEN 1 THEN 'Yes' ELSE 'No' END)
	, MemberofShoppingMallInd = (CASE MemberShoppingMallOver10StoresInd WHEN 1 THEN 'Yes' ELSE 'No' END)
--BP CA 2010 start PP issue 205
--	, SprinkleredAutomaticInd = (CASE Sprinklered100PercentInd WHEN 1 THEN 'Yes' ELSE 'No' END)
	, SprinkleredAutomaticInd = (CAse when @LOB = 'BP' and @StateCd = 'CA' THEN 
									(SELECT (CASE ltrim(rtrim(FieldValueTxt)) WHEN 'Y' THEN 'Yes' ELSE 'No' END)
										from SHCoverageDetailItems where AppId = @AppId 
											and FieldNameTxt = 'PROSAF_P1'
											and LocationNbr = BOPropertyInfo.LocationNbr
											and BuildingNbr = BOPropertyInfo.StructureNbr
									)
								Else
									(CASE Sprinklered100PercentInd WHEN 1 THEN 'Yes' ELSE 'No' END)
								END)
--BP CA 2010 end PP issue 205
	, BuildingLessthan10Ind = (CASE BldgLessThan10YrOrRenovatedInd WHEN 1 THEN 'Yes' ELSE 'No' END)
	, CentralStationAlarmInd = (CASE CentralStationBurglarAlarmInd WHEN 1 THEN 'Yes' ELSE 'No' END)
	, TheftExclusionInd = (CASE TheftExclusionInd WHEN 1 THEN 'Yes' ELSE 'No' END)
--Policy Adjustment Factor
	, FranchiseAdjustmentInd = (CASE FranchiseAdjFctrInd WHEN 1 THEN 'Yes' ELSE 'No' END)
	, MultipleLocationAdjustmentInd = (CASE MultiLocAdjFctrInd WHEN 1 THEN 'Yes' ELSE 'No' END)
	, PlaygroundDevicesInd = (CASE PlaygroundOrMechDeviceAdjFctrInd WHEN 1 THEN 'Yes' ELSE 'No' END)
	, Morethen2AmusementInd = (CASE MultiNonMechAmuseDevAdjFctrInd WHEN 1 THEN 'Yes' ELSE 'No' END)
--DON00059 End
--LR FSIT 138588 - BOP NY 2010 - START
	, LiabDeductAmt = (CASE @InsuranceLineCd 
							WHEN 'NBP' THEN
								CASE LiabDeductAmt WHEN 'O' THEN '0'
	                                      WHEN 'A' THEN '250'
	                                      WHEN 'B' THEN '1000'
	                                      WHEN 'C' THEN '2500'
										  ELSE LiabDeductAmt
								END
							WHEN 'CBP' THEN 
								CASE LiabDeductAmt WHEN 'O' THEN '0'
	                                      WHEN 'A' THEN '250'
	                                      WHEN 'B' THEN '500'
	                                      WHEN 'C' THEN '1000'
										  WHEN 'D' THEN '2500'
										  ELSE LiabDeductAmt
								END
	                    END)                      
--BP CA 2010 start PP issue 199 start
	, LiabDeductType = (CAse when @LOB = 'BP' and @StateCd = 'CA' THEN 
							(Select LiabDeductTypeDes From BOSeleLiabDeductType Where HostCd = @Host and 	
							 (LocationId = @LOC or LocationId = '99') and 
							 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
							 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
							 --(LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') and   --TL BOP NY 2010
							 (LineOfBusinessCd = @LOB or LineOfBusinessCd = '999') and   --TL BOP NY 2010
							 (StateCd = (Select StateCd from SHPropertyLocation Where AppId=@AppId and 
									LocationNbr = BOPropertyInfo.LocationNbr) or StateCd = '99' ) and 
							 (InsuranceLineCd = BOPropertyInfo.InsuranceLineCd or InsuranceLineCd = '999') and 
							LiabDeductTypeCd = 'O')
						Else
							(Select LiabDeductTypeDes From BOSeleLiabDeductType Where HostCd = @Host and 	
							 (LocationId = @LOC or LocationId = '99') and 
							 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
							 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
							 --(LineOfBusinessCd = 'BO' or LineOfBusinessCd = '999') and   --TL BOP NY 2010
							 (LineOfBusinessCd = @LOB or LineOfBusinessCd = '999') and   --TL BOP NY 2010
							 (StateCd = (Select StateCd from SHPropertyLocation Where AppId=@AppId and 
									LocationNbr = BOPropertyInfo.LocationNbr) or StateCd = '99' ) and 
							 (InsuranceLineCd = BOPropertyInfo.InsuranceLineCd or InsuranceLineCd = '999') and 
							LiabDeductTypeCd = LiabDeductType)
						END)
--BP CA 2010 start PP issue 199 end
	, PayrollAmt
--LR FSIT 138588 - BOP NY 2010 - END
--TL BOP NY 2010 Starts
    , BldgTenantsImprove = Case when TenantsImprovementsCov='' then 0 else convert(decimal, TenantsImprovementsCov) end
    , BldgRenovationYear = ISNULL(RenovationYear,'')
--TL BOP NY 2010 Ends
	--TL FSIT 151183 Starts
	,BO_BLDG_COINSURANCEPCT = (select CoinsuranceDes From BPSeleCoinsurance 
										Where CoinsuranceCd = CoinsurancePctCd
											and LocationId=@LocationId
											and MasterCompanyId=@MasterCompanyId
											and PolicyCompanyId=@PolicyCompanyId
											and StateCd=@StateCd
											and InsuranceLineCd=@InsuranceLineCd)    
	--TL FSIT 151183 Ends
	From BOPropertyInfo with (nolock) where BOPropertyInfo.AppId = @AppId 
	 ORDER By LocationNBr, StructureNbr;
----------GET ALL THE INSURANCE LINE COVERAGES---------------------
--------------------------------------------------------------------------------------------
	--DON00059 5 Begin 
	DECLARE @UnitDeductible DECIMAL(18,0)
	SET @UnitDeductible = 0
	IF EXISTS(SELECT 1 FROM BOPropertyInfo WHERE AppId = @AppId and LocationNbr = 1 AND StructureNbr = 1) 
		SELECT @UnitDeductible = (CASE UnitDeductCd WHEN 'N' THEN 0 
        ELSE CAST(UnitDeductCd AS DECIMAL(18,0)) END) FROM BOPropertyInfo 
        WHERE AppId = @AppId and LocationNbr = 1 AND StructureNbr = 1
--LR FSIT 138588 - BOP NY 2010 - START
Declare @MechBkdwnDed numeric(10,0)
Declare @ForgeryLimit numeric(10,0)
Declare @EmpDishonLimit numeric(10,0)
Declare @BarBeauLimit numeric(10,0)
Declare @OptHearLimit numeric(10,0)
Declare @OptHigherLimit numeric(10,0)	--TL FSIT 145313 issue 217 11042012
Declare @PrinterLimit numeric(10,0)
Declare @PharmLimit varchar(75)
Declare @IncomeExtDays smallint
Declare @IncomePayDays smallint
Declare @AutoIncrease smallint
Declare @LiquorLiaLimit varchar(75)
Declare @LiquorSchLimit varchar(75)
Declare @RestLoss varchar(75) --LR BOP NY 2010 - Issue 82
-- issue 114 10/23/12 dlh start 
-- fsit 153231 dlh 4/17/14 start
DECLARE @LineOfBusinessCd1 VARCHAR(2)
DECLARE @CoverageCd1  varchar(6)
DECLARE @CovItem1 varchar(6)
DECLARE @CovDesc1 varchar(100)
DECLARE @LocNbr1 INTEGER
Declare @BlgNbr1 INTEGER
Declare @SeqNbr1 INTEGER
Declare @CovCnt INTEGER
Declare @CovSeqNbr1 INTEGER
DECLARE @Line1 varchar(100)
DECLARE	@ADD_NAME1 varchar(100)
DECLARE	@ADD_OPT1 varchar(30)
DECLARE	@ADD_ADDRESS11 varchar(50)
DECLARE	@ADD_CITY1 varchar(50)
DECLARE	@ADD_STATE1 varchar(2)
DECLARE	@ADD_ZIP1 varchar(10)  
DECLARE @SortOrder int
DECLARE @tempTableCov Table(
		    Appid varchar(20),
			BO_COV_INSCOV_INSLINE varchar(30),	--VDT DON-365 7FEB17
			BO_COV_INSCOV_CD varchar(100),		--VDT DON-365 7FEB17
            BO_COV_INSLINE varchar(30), 
			BO_COV_LOCNBR numeric(10,0),			
			BO_COV_BLDGNBR numeric(10,0),
			BO_COV_SeqNum int, 
			BO_COV_CNT int,					
			BO_COV_CD varchar(100),
			BO_COV_LIMIT varchar(30),			
			BO_COVDED_LIMIT varchar(7),
			BO_COV_INSDED_LIMIT varchar(30),		--VDT DON-365 7FEB17		
			BO_COV_PREM numeric(10,0),
			COV_SUM numeric(10,0),
			COVERAGECD varchar(30),
			SortOrder int
			);   
-- fsit 153231 dlh 4/17/14 end	
Declare @FireLimit varchar(75) 
Set @FireLimit = (
        --TL BOP NY 2010, FSIT 139573 Starts
		SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                        Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                        Else 0 
                      End
        --TL BOP NY 2010, FSIT 139573 Ends
		FROM	SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @Appid 
					AND C.LocationNbr = @LocationNumber
			        AND C.BuildingNbr = @BuildingNbr 	  				
					AND RTrim(LTrim(A.LineOfBusinessCd)) = C.LineOfBusinessCd 
					AND RTrim(LTrim(A.InsuranceLineCd)) = C.InsuranceLineCd 
					AND RTrim(LTrim(A.CoverageCd)) = C.CoverageCd 
					AND RTrim(LTrim(A.CoverageParmFieldId)) = C.FieldNameTxt				
		WHERE A.HostCd = @Host 
			AND RTrim(LTrim(A.LocationId)) IN ('99', @LocationId) 
			AND RTrim(LTrim(A.MasterCompanyId)) IN ('99', @MCO) 
			AND RTrim(LTrim(A.PolicyCompanyId)) IN ('99', @PCO) 
			AND RTrim(LTrim(A.StateCd)) IN ('99' , @StateCd) 
			AND RTrim(LTrim(A.LineOfBusinessCd)) = @LOB 
			AND RTrim(LTrim(A.InsuranceLineCd))  = @InsuranceLineCd 		
			AND RTrim(LTrim(A.CoverageCd)) = 'EXFDSC'	
			AND CoverageParmSeqNbr = 16	
		)
-- issue 114 10/23/12 dlh end
Set @MechBkdwnDed = (
        --TL BOP NY 2010, FSIT 139573 Starts
		SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                        Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                        Else 0 
                      End
        --TL BOP NY 2010, FSIT 139573 Ends
		FROM	SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @Appid 
					AND RTrim(LTrim(C.LocationNbr)) = '0' 
					AND RTrim(LTrim(C.BuildingNbr)) = '0'  				
					AND RTrim(LTrim(A.LineOfBusinessCd)) = C.LineOfBusinessCd 
					AND RTrim(LTrim(A.InsuranceLineCd)) = C.InsuranceLineCd 
					AND RTrim(LTrim(A.CoverageCd)) = C.CoverageCd 
					AND RTrim(LTrim(A.CoverageParmFieldId)) = C.FieldNameTxt				
		WHERE A.HostCd = @Host 
			AND RTrim(LTrim(A.LocationId)) IN ('99', @LocationId) 
			AND RTrim(LTrim(A.MasterCompanyId)) IN ('99', @MCO) 
			AND RTrim(LTrim(A.PolicyCompanyId)) IN ('99', @PCO) 
			AND RTrim(LTrim(A.StateCd)) IN ('99' , @StateCd) 
			AND RTrim(LTrim(A.LineOfBusinessCd)) = @LOB 
			AND RTrim(LTrim(A.InsuranceLineCd))  = @InsuranceLineCd 		
			AND RTrim(LTrim(A.CoverageCd)) = 'MECHBD'
			AND CoverageParmSeqNbr = 10
		)
Set @ForgeryLimit = (
        --TL BOP NY 2010, FSIT 139573 Starts
		SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                        Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                        Else 0 
                      End
        --TL BOP NY 2010, FSIT 139573 Ends
		FROM	SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @Appid 
					AND RTrim(LTrim(C.LocationNbr)) = '0' 
					AND RTrim(LTrim(C.BuildingNbr)) = '0'  
					AND RTrim(LTrim(A.LineOfBusinessCd)) = C.LineOfBusinessCd 
					AND RTrim(LTrim(A.InsuranceLineCd)) = C.InsuranceLineCd 
					AND RTrim(LTrim(A.CoverageCd)) = C.CoverageCd 
					AND RTrim(LTrim(A.CoverageParmFieldId)) = C.FieldNameTxt				
		WHERE A.HostCd = @Host
			AND RTrim(LTrim(A.LocationId)) IN ('99', @LocationId) 
			AND RTrim(LTrim(A.MasterCompanyId)) IN ('99', @MCO) 
			AND RTrim(LTrim(A.PolicyCompanyId)) IN ('99', @PCO) 
			AND RTrim(LTrim(A.StateCd)) IN ('99' , @StateCd) 
			AND RTrim(LTrim(A.LineOfBusinessCd)) = @LOB 
			AND RTrim(LTrim(A.InsuranceLineCd))  = @InsuranceLineCd 
			AND RTrim(LTrim(A.CoverageCd)) = 'FORGE'
			AND CoverageParmSeqNbr = 10
		)
Set @EmpDishonLimit = (
        --TL BOP NY 2010, FSIT 139573 Starts
		SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                        Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                        Else 0 
                      End
        --TL BOP NY 2010, FSIT 139573 Ends
		FROM	SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @Appid 
					AND RTrim(LTrim(C.LocationNbr)) = '0'  
					AND RTrim(LTrim(C.BuildingNbr)) = '0' 				
					AND RTrim(LTrim(A.LineOfBusinessCd)) = C.LineOfBusinessCd 
					AND RTrim(LTrim(A.InsuranceLineCd)) = C.InsuranceLineCd 
					AND RTrim(LTrim(A.CoverageCd)) = C.CoverageCd 
					AND RTrim(LTrim(A.CoverageParmFieldId)) = C.FieldNameTxt				
		WHERE A.HostCd = @Host
			AND RTrim(LTrim(A.LocationId)) IN ('99', @LocationId) 
			AND RTrim(LTrim(A.MasterCompanyId)) IN ('99', @MCO) 
			AND RTrim(LTrim(A.PolicyCompanyId)) IN ('99', @PCO)
			AND RTrim(LTrim(A.StateCd)) IN ('99' , @StateCd) 
			AND RTrim(LTrim(A.LineOfBusinessCd)) = @LOB 
			AND RTrim(LTrim(A.InsuranceLineCd))  = @InsuranceLineCd 	
			AND RTrim(LTrim(A.CoverageCd)) = 'EMPDIS'
			AND CoverageParmSeqNbr = 10
		)
Set @BarBeauLimit = (
    --TL BOP NY 2010, FSIT 139573 Starts
    SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                    Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                    Else 0 
                  End
    --TL BOP NY 2010, FSIT 139573 Ends
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId 
			AND C.LocationNbr = @LocationNumber
			AND C.BuildingNbr = @BuildingNbr 	
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1 
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId) 
		AND A.MasterCompanyId IN ('99', @MasterCompanyId) 
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd)	
		AND A.LineOfBusinessCd = @LOB 
		AND A.InsuranceLineCd  = @InsuranceLineCd 	
		AND RTRIM(A.CoverageCd) = 'BBPL' 
		AND CoverageParmSeqNbr = 10
	)
Set @OptHearLimit = (
    --TL BOP NY 2010, FSIT 139573 Starts
    SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                    Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                    Else 0 
                  End
    --TL BOP NY 2010, FSIT 139573 Ends
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber 
			AND C.BuildingNbr = @BuildingNbr 		
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1 
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId) 
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd) 	
		AND A.LineOfBusinessCd = @LOB 
		AND A.InsuranceLineCd  = @InsuranceLineCd 	
		AND RTRIM(A.CoverageCd) = 'OPTHR'
		AND CoverageParmSeqNbr = 10
	)
--TL FSIT 145313 issue 217 11042012 Starts
Set @OptHigherLimit = (
    SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                    Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                    Else 0 
                  End
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId) 
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd) 	
		AND A.LineOfBusinessCd = @LOB 
		AND A.InsuranceLineCd  = @InsuranceLineCd 	
		AND RTRIM(A.CoverageCd) = 'EPLI'
		AND C.FieldNameTxt='TypeOfCondo'
	)
--TL FSIT 145313 issue 217 11042012 Ends
Set @PrinterLimit = (
    --TL BOP NY 2010, FSIT 139573 Starts
    SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                    Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                    Else 0 
                  End
    --TL BOP NY 2010, FSIT 139573 Ends
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber 
			AND C.BuildingNbr = @BuildingNbr		
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1 
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId)
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd	
		AND RTRIM(A.CoverageCd) = 'PRINT'
		AND CoverageParmSeqNbr = 10
	)
Set @PharmLimit = ''
IF NOT (
	SELECT C.FieldValueTxt
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber
			AND C.BuildingNbr = @BuildingNbr
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId)
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd
		AND RTRIM(A.CoverageCd) = 'PHARM'
		AND CoverageParmFieldId = 'PharmOccLmt'
	) IS NULL AND RTRIM(LTRIM((
	SELECT C.FieldValueTxt
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber
			AND C.BuildingNbr = @BuildingNbr
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId)
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd
		AND RTRIM(A.CoverageCd) = 'PHARM'
		AND CoverageParmFieldId = 'PharmOccLmt'
	))) <> ''
	BEGIN
		Set @PharmLimit = dbo.format_currency(Convert(decimal(20,0), (
            --TL BOP NY 2010, FSIT 139573 Starts
            SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                            Then ISNULL(C.FieldValueTxt,0)
                            Else 0 
                          End
            --TL BOP NY 2010, FSIT 139573 Ends
			FROM SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @AppId
					AND C.LocationNbr = @LocationNumber
					AND C.BuildingNbr = @BuildingNbr
					AND A.LineOfBusinessCd = C.LineOfBusinessCd 
					AND A.InsuranceLineCd = C.InsuranceLineCd 
					AND A.CoverageCd = C.CoverageCd 
					AND C.CoverageSequenceNbr = 1
					AND A.CoverageParmFieldId = C.FieldNameTxt				
			WHERE A.HostCd = @Host
				AND A.LocationId IN ('99', @LocationId)
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.StateCd IN ('99' , @StateCd)
				AND A.LineOfBusinessCd = @LOB
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND RTRIM(A.CoverageCd) = 'PHARM'
				AND CoverageParmFieldId = 'PharmOccLmt'
			)))  + ' / ' + dbo.format_currency(Convert(decimal(20,0), (
            --TL BOP NY 2010, FSIT 139573 Starts
            SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                            Then ISNULL(C.FieldValueTxt,0)
                            Else 0 
                          End
            --TL BOP NY 2010, FSIT 139573 Ends
			FROM SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @AppId
					AND C.LocationNbr = @LocationNumber
					AND C.BuildingNbr = @BuildingNbr
					AND A.LineOfBusinessCd = C.LineOfBusinessCd 
					AND A.InsuranceLineCd = C.InsuranceLineCd 
					AND A.CoverageCd = C.CoverageCd 
					AND C.CoverageSequenceNbr = 1
					AND A.CoverageParmFieldId = C.FieldNameTxt				
			WHERE A.HostCd = @Host
				AND A.LocationId IN ('99', @LocationId)
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.StateCd IN ('99' , @StateCd)
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND RTRIM(A.CoverageCd) = 'PHARM'
				AND CoverageParmFieldId = 'PharmAggLmt'
			)))
	END
Set @LiquorLiaLimit = '0'
IF NOT (
	SELECT C.FieldValueTxt
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber
			AND C.BuildingNbr = @BuildingNbr
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd
		AND RTRIM(A.CoverageCd) = 'LIQUOR'
		AND CoverageParmFieldId = 'CommonCauseLimit'
	) IS NULL AND RTRIM(LTRIM((
	SELECT C.FieldValueTxt
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber
			AND C.BuildingNbr = @BuildingNbr
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd
		AND RTRIM(A.CoverageCd) = 'LIQUOR'
		AND CoverageParmFieldId = 'CommonCauseLimit'
	))) <> ''
	BEGIN
		Set @LiquorLiaLimit = dbo.format_currency(Convert(decimal(20,0), (
			SELECT ISNULL(C.FieldValueTxt,0)
			FROM SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @AppId
					AND C.LocationNbr = @LocationNumber
					AND C.BuildingNbr = @BuildingNbr
					AND A.LineOfBusinessCd = C.LineOfBusinessCd 
					AND A.InsuranceLineCd = C.InsuranceLineCd 
					AND A.CoverageCd = C.CoverageCd 
					AND C.CoverageSequenceNbr = 1
					AND A.CoverageParmFieldId = C.FieldNameTxt				
			WHERE A.HostCd = @Host
				AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.StateCd IN ('99' , @StateCd)
				AND A.LineOfBusinessCd = @LOB
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND RTRIM(A.CoverageCd) = 'LIQUOR'
				AND CoverageParmFieldId = 'CommonCauseLimit'
			)))  + ' / ' + dbo.format_currency(Convert(decimal(20,0), (
			SELECT ISNULL(C.FieldValueTxt,0)
			FROM SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @AppId
					AND C.LocationNbr = @LocationNumber
					AND C.BuildingNbr = @BuildingNbr
					AND A.LineOfBusinessCd = C.LineOfBusinessCd 
					AND A.InsuranceLineCd = C.InsuranceLineCd 
					AND A.CoverageCd = C.CoverageCd 
					AND C.CoverageSequenceNbr = 1
					AND A.CoverageParmFieldId = C.FieldNameTxt				
			WHERE A.HostCd = @Host
				AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.StateCd IN ('99' , @StateCd)
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND RTRIM(A.CoverageCd) = 'LIQUOR'
				AND CoverageParmFieldId = 'AggregateLimit'
			)))
	END
	
Set @LiquorSchLimit = '0'
IF NOT (
	SELECT C.FieldValueTxt
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber
			AND C.BuildingNbr = @BuildingNbr
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd
		AND RTRIM(A.CoverageCd) = 'LIQLSE'
		AND CoverageParmFieldId = 'OccurrenceLimit'
	) IS NULL AND RTRIM(LTRIM((
	SELECT C.FieldValueTxt
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber
			AND C.BuildingNbr = @BuildingNbr
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd
		AND RTRIM(A.CoverageCd) = 'LIQLSE'
		AND CoverageParmFieldId = 'OccurrenceLimit'
	))) <> ''
	BEGIN
		Set @LiquorSchLimit = dbo.format_currency(Convert(decimal(20,0), (
			SELECT ISNULL(C.FieldValueTxt,'')
			FROM SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @AppId
					AND C.LocationNbr = @LocationNumber
					AND C.BuildingNbr = @BuildingNbr
					AND A.LineOfBusinessCd = C.LineOfBusinessCd 
					AND A.InsuranceLineCd = C.InsuranceLineCd 
					AND A.CoverageCd = C.CoverageCd 
					AND C.CoverageSequenceNbr = 1
					AND A.CoverageParmFieldId = C.FieldNameTxt				
			WHERE A.HostCd = @Host
				AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.StateCd IN ('99' , @StateCd)
				AND A.LineOfBusinessCd = @LOB
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND RTRIM(A.CoverageCd) = 'LIQLSE'
				AND CoverageParmFieldId = 'OccurrenceLimit'
			)))  + ' / ' + dbo.format_currency(Convert(decimal(20,0), (
			SELECT ISNULL(C.FieldValueTxt,'')
			FROM SHSeleCovParms AS A 
				LEFT JOIN SHCoverageDetailItems AS C ON
					C.AppId = @AppId
					AND C.LocationNbr = @LocationNumber
					AND C.BuildingNbr = @BuildingNbr
					AND A.LineOfBusinessCd = C.LineOfBusinessCd 
					AND A.InsuranceLineCd = C.InsuranceLineCd 
					AND A.CoverageCd = C.CoverageCd 
					AND C.CoverageSequenceNbr = 1
					AND A.CoverageParmFieldId = C.FieldNameTxt				
			WHERE A.HostCd = @Host
				AND A.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.StateCd IN ('99' , @StateCd)
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND RTRIM(A.CoverageCd) = 'LIQLSE'
				AND CoverageParmFieldId = 'AggregateLimit'
			)))
	END
Set @IncomeExtDays = (
	SELECT ISNULL(C.FieldValueTxt,0)
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber 
			AND C.BuildingNbr = @BuildingNbr		
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1 
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId)
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd	
		AND RTRIM(A.CoverageCd) = 'BUSINE'
		AND CoverageParmSeqNbr = 10
	)
Set @IncomePayDays = (
	SELECT ISNULL(C.FieldValueTxt,0)
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber 
			AND C.BuildingNbr = @BuildingNbr		
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1 
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId)
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd	
		AND RTRIM(A.CoverageCd) = 'BUSINP'
		AND CoverageParmSeqNbr = 10
	)
Set @AutoIncrease = (
    --TL BOP NY 2010, FSIT 139573 Starts
    SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                    Then convert(smallint, ISNULL(C.FieldValueTxt,0)) 
                    Else 0 
                  End
    --TL BOP NY 2010, FSIT 139573 Ends
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber 
			AND C.BuildingNbr = @BuildingNbr		
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1 
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId)
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd	
		AND RTRIM(A.CoverageCd) = 'AUTO'
		AND CoverageParmSeqNbr = 10
	)
	
--LR BOP NY 2010 - Issue 82 - START	
Set @RestLoss = (
	SELECT ISNULL(C.FieldValueTxt,'')
	FROM SHSeleCovParms AS A 
		LEFT JOIN SHCoverageDetailItems AS C ON
			C.AppId = @AppId
			AND C.LocationNbr = @LocationNumber 
			AND C.BuildingNbr = @BuildingNbr		
			AND A.LineOfBusinessCd = C.LineOfBusinessCd 
			AND A.InsuranceLineCd = C.InsuranceLineCd 
			AND A.CoverageCd = C.CoverageCd 
			AND C.CoverageSequenceNbr = 1
			AND A.CoverageParmFieldId = C.FieldNameTxt				
	WHERE A.HostCd = @Host
		AND A.LocationId IN ('99', @LocationId)
		AND A.MasterCompanyId IN ('99', @MasterCompanyId)
		AND A.PolicyCompanyId IN ('99', @PolicyCompanyId) 
		AND A.StateCd IN ('99' , @StateCd)
		AND A.LineOfBusinessCd = @LOB
		AND A.InsuranceLineCd  = @InsuranceLineCd	
		AND RTRIM(A.CoverageCd) = 'RESTLL'
		AND CoverageParmSeqNbr = 20
	)	
--LR BOP NY 2010 - Issue 82 - END
Declare @InsLineLimit numeric(10,0)
Set @InsLineLimit = (
		Select PerOccurrenceAmt	
		from BOInsuranceLine with (nolock) 
		where AppId = @AppId and InsuranceLineCd = @InsuranceLineCd
		)
--LR FSIT 138588 - BOP NY 2010 - END
-- issue 119 dlh start 
--Pcr-66 dlh start
--if @InsuranceLineCd = 'BOP'
--   Begin
--	Select 	
--	BO_COV_INSCOV_INSLINE = InsuranceLineCd,
--    --DON00247A Begins Here
--	--BO_COV_INSCOV_CD = ISNULL((select CoverageDes from SHSeleCovDescription where BORating.CoverageCd=SHSeleCovDescription.CoverageCd and SHSeleCovDescription.hostcd=@Host),BORating.CoverageCd), /* CoverageCd, */	--DON00059
--	BO_COV_INSCOV_CD = ISNULL((select CoverageDes 
--                               from SHSeleCovDescription 
--                               where A.CoverageCd=SHSeleCovDescription.CoverageCd 
--                               and SHSeleCovDescription.hostcd=@Host
--							   and shselecovdescription.LineOfBusinessCd = @LOB
--				               and shselecovdescription.InsuranceLineCd = @InsuranceLineCd 
--				               and (shselecovdescription.statecd = '99' or shselecovdescription.statecd = @StateCd))
--                               ,A.CoverageCd), /* CoverageCd, */
--    --DON00247A Ends Here
--	BO_COV_INSCOV_LIMIT = TotalExposureAmt,
--	BO_COV_INSDED_LIMIT = (case when RTRIM(A.CoverageCd)= 'Liquor' then 0
--                             when RTRIM(A.CoverageCd)= 'EBL' then 0
--                           else @UnitDeductible end),--DeductibleAmt, /* Case 14599 */	--DON00059
-- 	BO_COV_INSCOV_PREM = PremiumAmt
--    --DON00247A Begins Here
--    --from BORating with (nolock) where AppId = @AppId and LocationNbr = 0 and BuildingNbr = 0 and CoverageCd <> '0' Order by InsuranceLineCd
--    from BORating A with (nolock) 
--    Inner Join SHSeleCovDescription B On 
--				B.CoverageCd=A.CoverageCd and B.hostcd='PT'
--				and B.LineOfBusinessCd = @LOB
--				and B.InsuranceLineCd = @InsuranceLineCd 
--				and (B.statecd = '99' or B.statecd = @StateCd)
--    where A.AppId = @AppId and A.LocationNbr = 0 and A.BuildingNbr = 0 and A.CoverageCd  <> '0' 
--    Order by A.InsuranceLineCd, B.DisplaySeq 
--    --DON00247A Ends Here
--	--DON00059 End
--   End 
--Else 
--Pcr-66 dlh end
IF @InsuranceLineCd = 'NBP' or @InsuranceLineCd = 'CBP'
	-- FSIT 145313 PP start
   Begin
	If @StateCd = 'CA' or @MCO = '01' or @StateCd = 'NY' or @MCO = '02'
	   Begin
	      -- fsit 153231 dlh 4/17/14 
	      set @SortOrder = 0
	      declare @tmpCovInsLine varchar(6)
	      set @tmpCovInsLine = ''
	      DECLARE @CursorScheduleItemInsCov AS CURSOR		
		  Set @CursorScheduleItemInsCov = CURSOR FORWARD_ONLY STATIC READ_ONLY FOR 
		  Select Distinct CoverageCd, CoverageItemCd, LocationNbr, BuildingNbr, CoverageSequenceNbr, ScheduleItemSeqNbr from SHCoverageScheduleItems	
				Where AppId=@appid And CoverageCd in ('BP0497','VENDOR','ADDCOP','ADDGRT','ADDLES','ADDOWN','ADDREQ','BO057','NPBLDO')	
				order by CoverageCd, LocationNbr, BuildingNbr, CoverageItemCd, CoverageSequenceNbr
				
				OPEN @CursorScheduleItemInsCov
				IF @@CURSOR_ROWS > 0			
					BEGIN					    
						FETCH NEXT FROM @CursorScheduleItemInsCov INTO @CoverageCd1, @CovItem1,@LocNbr1, @BlgNbr1, @CovSeqNbr1, @SeqNbr1
						WHILE @@FETCH_STATUS = 0
						BEGIN							
							if @tmpCovInsLine <> @CoverageCd1
							   set @tmpCovInsLine = @CoverageCd1
							   
							select @CovDesc1 = CoverageDes from ShSeleCoverageAttributes
							where LocationId = @LocationId and MasterCompanyId = @MasterCompanyId and PolicyCompanyId = @PolicyCompanyId
						    and Statecd = @StateCd and CoverageCd = @tmpCovInsLine
						    Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  @CovDesc1,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  0, 
															  @CovDesc1, 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  0,
															  0,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder 
																		  )	
                            set @SortOrder = @SortOrder + 1																			  											              
						    Select distinct  @line1 = FieldValueTxt from SHCoverageScheduleItems
									 Where AppId=@AppId and FieldNameTxt='Description1' 
									  And LocationNbr = @LocNbr1
									  And BuildingNbr = @BlgNbr1
									  And LineOfBusinessCd=@LOB
									  And InsuranceLineCd=@InsuranceLineCd
									  And ScheduleItemSeqNbr=@SeqNbr1
									  And CoverageSequenceNbr=@CovSeqNbr1
									  and CoverageItemCd = @CovItem1																			  
									  And CoverageCd  = @tmpCovInsLine
							if rtrim(@Line1) <> ''	
							   Begin 							  
							   Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  1,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder 
																		  )
                                      set @SortOrder = @SortOrder + 1																			   	
							   End											  
							   Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description2' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1				                                        															  
								 End	
							  Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description3' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1						 
										set @Line1 = ''	
								End
								Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description4' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1						 
										set @Line1 = ''	
								End	
							if @tmpCovInsLine = 'VENDOR'	
								Begin 
								   Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='ProductDesc' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							       if rtrim(@Line1) <> '' 						  
							          Begin 				 															  
                                       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                       set @SortOrder = @SortOrder + 1						 
									   set @Line1 = ''	
							         End
								  Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='ProductDesc2' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							       if rtrim(@Line1) <> '' 						  
							          Begin 				 															  
                                       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                       set @SortOrder = @SortOrder + 1						 
									   set @Line1 = ''	
							         End   
								   Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='ProductDesc3' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							       if rtrim(@Line1) <> '' 						  
							          Begin 				 															  
                                       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                       set @SortOrder = @SortOrder + 1						 
									   set @Line1 = ''	
							         End  
							       Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='ProductDesc4' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							       if rtrim(@Line1) <> '' 						  
							          Begin 				 															  
                                       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                       set @SortOrder = @SortOrder + 1						 
									   set @Line1 = ''	
							         End      
								End
							if 	@tmpCovInsLine = 'ADDLES' 
							    Begin 								       
							       Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='LocOfLeased1' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							       if rtrim(@Line1) <> '' 						  
							          Begin 				 															  
                                       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                       set @SortOrder = @SortOrder + 1						 
									   set @Line1 = ''	
							         End
							        Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='LocOfLeased2' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							       if rtrim(@Line1) <> '' 						  
							          Begin 				 															  
                                       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                       set @SortOrder = @SortOrder + 1						 
									   set @Line1 = ''	
							         End  
							    End
							if 	@tmpCovInsLine = 'ADDCOP' 
							    Begin 
							       Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='CompOpsDesc' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							       if rtrim(@Line1) <> '' 						  
							          Begin 				 															  
                                       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                       set @SortOrder = @SortOrder + 1						 
									   set @Line1 = ''	
										
									   Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='CompOpsDesc2' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							          if rtrim(@Line1) <> '' 						  
							             Begin 				 															  
                                           Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                          set @SortOrder = @SortOrder + 1						 
									 	  set @Line1 = ''		
								        End	
							          Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='CompOpsLoc' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							          if rtrim(@Line1) <> '' 						  
							             Begin 				 															  
                                           Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                          set @SortOrder = @SortOrder + 1						 
									 	  set @Line1 = ''		
								        End	
								        Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='CompOpsLoc2' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							          if rtrim(@Line1) <> '' 						  
							             Begin 				 															  
                                           Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                          set @SortOrder = @SortOrder + 1						 
									 	  set @Line1 = ''		
								        End	
							      End 
							 End   
							Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description5' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1						 
										set @Line1 = ''	
								End	
							Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description6' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1						 
										set @Line1 = ''	
								End	
							Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description7' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1						 
										set @Line1 = ''	
								End		
							Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description8' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1						 
										set @Line1 = ''	
								End		
								Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description9' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd = @tmpCovInsLine
							  if rtrim(@Line1) <> '' 						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), --VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + rtrim(@Line1), 
															  0,
															  Case @StateCd When 'CA' then  --VDT DON-365 7FEB17
															  null else 0 end,	--VDT DON-365 7FEB17
															  0,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  --'', fsit 155580
															  @CoverageCd1,
															  @SortOrder
																		  )	
                                        set @SortOrder = @SortOrder + 1						 
										set @Line1 = ''	
								End						  							  												   					                                                                                          						                             
							FETCH NEXT FROM @CursorScheduleItemInsCov INTO @CoverageCd1, @CovItem1, @LocNbr1, @BlgNbr1, @CovSeqNbr1, @SeqNbr1
						END
					END
			-- fsit 153231 dlh 4/17/14 end			
			SELECT 
			BO_COV_INSCOV_INSLINE = @InsuranceLineCd,
			BO_COV_INSCOV_CD=  CoverageDes,
			BO_COV_CODE =  RTRIM(SHCoverageDetails.CoverageCd),
				   BO_COV_DES = CoverageDes
						--,BO_LOC_NBR = LocationNbr -- BP CA 2010 issue 185 PP
						--,BO_BLG_NBR = BuildingNbr -- BP CA 2010 issue 185 PP
			,BO_COV_INSCOV_LIMIT = (CASE 
									WHEN SHCoverageDetails.CoverageCd = 'EPLI' THEN @OptHigherLimit
									WHEN RTRIM(SHCoverageDetails.CoverageCd) IN ('EMPDIS','FORGE','ENHMT','MECHBD','HIRED','NONOWN') THEN--VDT DON-365 7FEB17!
													(CASE 
								WHEN RTRIM(SHCoverageDetails.CoverageCd) IN ('HIRED', 'NONOWN') THEN @InsLineLimit
								WHEN RTRIM(SHCoverageDetails.CoverageCd) = 'EMPDIS' THEN (SELECT TOP 1  Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                        Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                        Else 0 
						End		from SHCoverageDetailItems as C where appid = @AppId and CoverageCd = 'EMPDIS')
								WHEN RTRIM(SHCoverageDetails.CoverageCd) = 'FORGE' THEN (SELECT TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
                        Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
                        Else 0
						End from
								 SHCoverageDetailItems as C where appid = @AppId and CoverageCd = 'FORGE')
								WHEN RTRIM(SHCoverageDetails.CoverageCd) = 'ENHMT' THEN 0
								WHEN RTRIM(SHCoverageDetails.CoverageCd) = 'MECHBD' THEN (Select TotalExposureAmt From BORating with (nolock) 
														Where AppId=@AppId and Coveragecd=SHCoverageDetails.Coveragecd) --TotalExposureAmt
								ELSE 0
						  END)
												WHEN SHCoverageDetails.CoverageCd = 'PESTLM' THEN --fsit 154318
												     (select FieldValueTxt from shcoverageDetailitems where appid = @AppId and CoverageCd = 'PESTLM')																								
												ELSE (Select TotalExposureAmt From BORating with (nolock) 
														Where AppId=@AppId and Coveragecd=SHCoverageDetails.Coveragecd and LocationNbr = SHCoverageDetails.LocationNbr And Buildingnbr = SHCoverageDetails.Buildingnbr and CoverageSeqNbr = SHCoverageDetails.CoverageSequenceNbr)	--TL FSIT 145313 issue 217 11042012, --TP 0411 #148932 Remove --added back in fsit 151059 dlh 8/19/13 CoverageSeqNbr=SHCoverageDetails.CoverageSequenceNbr
												END)
					,BO_COV_INSDED_LIMIT = (CASE 
								WHEN RTRIM(SHCoverageDetails.CoverageCd)IN ('EMPDIS','FORGE') THEN '500'  
								WHEN RTRIM(SHCoverageDetails.CoverageCd)IN ('ENHMT') THEN @UnitDeductible  
								WHEN RTRIM(SHCoverageDetails.CoverageCd) = 'MECHBD' THEN 0
								ELSE 0  
						   END)
                    ,0 as SortOrder	-- fsit 153231 dlh 4/17/14 start										
					FROM SHCoverageDetails INNER JOIN SHSeleCoverageAttributes ON
						SHCoverageDetails.CoverageCd = SHSeleCoverageAttributes.CoverageCd
						AND SHCoverageDetails.LineOfBusinessCd = SHSeleCoverageAttributes.LineOfBusinessCd
						AND SHCoverageDetails.InsuranceLineCd = SHSeleCoverageAttributes.InsuranceLineCd
						AND SHSeleCoverageAttributes.HostCd = @Host
						AND SHSeleCoverageAttributes.LocationId IN ('99',@LocationId) 
						AND SHSeleCoverageAttributes.MasterCompanyId IN ('99',@MasterCompanyId)
						AND SHSeleCoverageAttributes.PolicyCompanyId IN ('99',@PolicyCompanyId) 
						--and SHSeleCoverageAttributes.Coveragecd  <> 'BP0497'
						and SHSeleCoverageAttributes.Coveragecd  Not in ('BP0497','VENDOR','ADDCOP','ADDGRT','ADDLES','ADDOWN','ADDREQ','BO057','NPBLDO')	
						AND (InsuranceLineCovInd = 1)-- or InsuranceLineCovInd = 0 -- BP CA 2010 issue 185 PP
						AND StateCd IN ('99',@StateCd) 
						and SHCoverageDetails.CoverageCd Not in ('BP0497','VENDOR','ADDCOP','ADDGRT','ADDLES','ADDOWN','ADDREQ','BO057','NPBLDO')							
					WHERE AppId = @AppId --AND LocationNbr = 0 AND BuildingNbr = 0 -- BP CA 2010 issue 185 PP
					AND SHCoverageDetails.LineOfBusinessCd = @LOB
					AND SHCoverageDetails.InsuranceLineCd = @InsuranceLineCd
				UNION ALL 					    
						Select Distinct
						rtrim(A.BO_COV_INSCOV_INSLINE),	--VDT DON-365 7FEB17
						rtrim(A.BO_COV_INSCOV_CD),	--VDT DON-365 7FEB17
						rtrim(A.CoverageCd),
						rtrim(A.BO_COV_CD),
						rtrim(A.BO_COVDED_LIMIT)
						,rtrim(A.BO_COV_INSDED_LIMIT) --VDT DON-365 7FEB17
						,A.SortOrder		
						from 
							@TempTableCov A  								
				
					ORDER BY SortOrder	
		-- fsit 153231 dlh 4/17/14 end					
	End
	Else
	Begin
	-- FSIT 145313 PP end
	-- fsit 240038 start dlh 3/1/16
	--if @BoundInd <> 0 
	   Select 	
		BO_COV_INSCOV_INSLINE = @InsuranceLineCd, --Pcr-66 
		--DON00247A Begins Here
		--BO_COV_INSCOV_CD = ISNULL((select Top 1 CoverageDes from SHSeleCovDescription where A.CoverageCd=SHSeleCovDescription.CoverageCd and SHSeleCovDescription.hostcd=@Host),A.CoverageCd), /* CoverageCd, */	--DON00059
		--TL BOP NY 2010 Starts
		--Pcr-66 start
		BO_COV_INSCOV_CD = --CASE  WHEN (RTRIM(A.CoverageCd) = 'MECHBD' and @LOB='BP') THEN 'Mechanical Breakdown'
                        --ELSE ISNULL((
						(select CoverageDes from SHSeleCovDescription
                                     where A.CoverageCd=SHSeleCovDescription.CoverageCd 
                                     and SHSeleCovDescription.hostcd=@Host
                                     and shselecovdescription.LineOfBusinessCd = @LOB
									 and shselecovdescription.InsuranceLineCd = @InsuranceLineCd 
				                     and (shselecovdescription.statecd = '99' or shselecovdescription.statecd = @StateCd) and
									 A.CoverageCd IN ('EMPDIS','FORGE','ENHMT','MECHBD','HIRED','NONOWN')),
                       --              ),A.CoverageCd) /* CoverageCd, */
                       --END,    
        --Pcr-66 End                        
		--BO_COV_INSCOV_LIMIT = TotalExposureAmt,
		BO_COV_INSCOV_LIMIT = CASE 
								WHEN RTRIM(A.CoverageCd) IN ('HIRED', 'NONOWN') THEN @InsLineLimit
								WHEN RTRIM(A.CoverageCd) = 'EMPDIS' THEN @EmpDishonLimit
								WHEN RTRIM(A.CoverageCd) = 'FORGE' THEN @ForgeryLimit
								WHEN RTRIM(A.CoverageCd) = 'ENHMT' THEN 0
								WHEN RTRIM(A.CoverageCd) = 'MECHBD' THEN TotalExposureAmt --TotalExposureAmt
								ELSE 0
						  END,
		BO_COV_INSDED_LIMIT = (CASE 
								--WHEN RTRIM(A.CoverageCd)IN ('EMPDIS', 'HIRED', 'NONOWN', 'ENHMT', 'FORGE') THEN @UnitDeductible  fsit 139744 start
								WHEN RTRIM(A.CoverageCd)IN ('EMPDIS','FORGE') THEN '500'  
								WHEN RTRIM(A.CoverageCd)IN ('ENHMT') THEN @UnitDeductible  
								--WHEN RTRIM(A.CoverageCd)IN ('ENHMT','MECHBD') THEN 0
								-- fsit 139744
								--WHEN RTRIM(A.CoverageCd) =  THEN @MechBkdwnDed --@MechBkdwnDed
								WHEN RTRIM(A.CoverageCd) = 'MECHBD' THEN 0
								ELSE 0  
						   END),
 		BO_COV_INSCOV_PREM = PremiumAmt
		from BORating A with (nolock) 
		--Pcr-66 Start
		Inner Join SHSeleCovDescription B On 
                    B.CoverageCd=A.CoverageCd and B.hostcd='PT'  
                    and B.LineOfBusinessCd = @LOB
				    and B.InsuranceLineCd = @InsuranceLineCd 
				    and (B.statecd = '99' or B.statecd = @StateCd)
	    --Pcr-66 End			    
		where A.AppId = @AppId and A.CoverageCd NOT IN ('0', 'DAMAGE') --and A.LocationNbr = 0 and A.BuildingNbr = 0
		  and A.CoverageCd IN ('EMPDIS','FORGE','ENHMT','MECHBD','HIRED','NONOWN')
		  		
        UNION
		     Select 	
		        BO_COV_INSCOV_INSLINE = 'NBP',		
		        BO_COV_INSCOV_CD = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Perishable Goods' ,          
		        BO_COV_INSCOV_LIMIT = '25000.00',
		        BO_COV_INSDED_LIMIT = 0,
 		        BO_COV_INSCOV_PREM = 0
		        from BORating A with (nolock) 		
		        where A.AppId = @AppId 
		        and A.CoverageCd IN ('MECHBD')
        UNION
			SELECT 
			    BO_COV_INSCOV_INSLINE =  'NBP' , 
			    BO_COV_INSCOV_CD =  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Expediting Expense' , 
			    BO_COV_INSCOV_LIMIT =  '25000.00' , 
			    BO_COV_INSDED_LIMIT =   0 , 
			    BO_COV_INSCOV_PREM =   0      
		        from BORating A with (nolock) 		
		        where A.AppId = @AppId 
		        and A.CoverageCd IN ('MECHBD')
       Order by BO_COV_INSCOV_LIMIT
    --else		     			    
	--		SELECT BO_COV_INSCOV_INSLINE = ' ', 
	--		BO_COV_INSCOV_CD =  ' ', 
	--		BO_COV_INSCOV_LIMIT = ' ', 
	--		BO_COV_INSDED_LIMIT = ' ', 
	--		BO_COV_INSCOV_PREM = ' '				 
	--	    
	--   
   End
   -- fsit 240038 end  dlh 3/1/16
End -- FSIT 145313 PP
--issue 119 end dlh
--TP BOP NY 2010 END
--DON00247A Ends Here
	--DON00059 End
---------GET ALL THE OTHER COVERAGES --------------------------------------
------------------------------------------------------------------------------------------------------------
--Update BORating Set CoverageCd='MSOFF' where AppId = @AppId and LocationNbr<>0 and BuildingNbr <> 0 and CoverageCd='M&SOFF'
/*Select Distinct 	BO_COV_INSLINE =InsuranceLineCd,
	BO_COV_LOCNBR = LocationNbr,
	BO_COV_BLDGNBR = BuildingNbr,
	BO_COV_CD = (select CoverageDes from SHSeleCovDescription with (nolock) where BORating.CoverageCd=SHSeleCovDescription.CoverageCd and SHSeleCovDescription.hostcd=@Host), */
/* -----	BO_COV_CD = (Select Description From SHSeleCoverages with (nolock) Where code = (Select distinct SHSeleCovCode From BOSelePTCovField with (nolock) 
											 Where BOSelePTCovField.CoverageCd = BORating.CoverageCd)
			and (LOB= 'BO' or LOB='99') and (LocationId=@LOC or LocationId='99') and (MasterCompanyId=@MCO or MasterCompanyId='99')
			and (PolicyCompanyId=@PCO or PolicyCompanyId='99') and Host=@Host and (State=@stateCd or state='99')),--------	*/
/*	BO_COV_LIMIT = TotalExposureAmt,
	BO_COVDED_LIMIT = DeductibleAmt, Case 14599 */
/*	BO_COV_PREM = cast(PremiumAmt as money) ,
 COV_SUM = (Select PremiumAmt from BORating where AppId=@AppId and LocationNbr <> 0 and BuildingNbr <> 0 and CoverageCd = 0),
 	CoverageCd
from BORating with (nolock) where AppId = @AppId and LocationNbr<>0 and BuildingNbr <> 0 and CoverageCd<>0 order by InsuranceLineCd, LocationNbr, BuildingNbr; */
--LR BOP NY 2010 - START - 8/24/2011 issue 109, 110 dlh
--DON365 - SS - Starts
DECLARE @CursorScheduleItemNbrCov AS CURSOR
IF @StateCd = 'NY'
BEGIN
		Set @CursorScheduleItemNbrCov = CURSOR FORWARD_ONLY STATIC READ_ONLY FOR 
		Select Distinct CoverageCd, CoverageItemCd, LocationNbr, BuildingNbr, CoverageSequenceNbr, ScheduleItemSeqNbr from SHCoverageScheduleItems	
				Where AppId=@AppId And CoverageCd in ('ADDINS')	
				order by LocationNbr, BuildingNbr, CoverageSequenceNbr, CoverageCd, CoverageItemCd
				
				OPEN @CursorScheduleItemNbrCov
				IF @@CURSOR_ROWS > 0			
					BEGIN
						FETCH NEXT FROM @CursorScheduleItemNbrCov INTO @CoverageCd1, @CovItem1,@LocNbr1, @BlgNbr1, @CovSeqNbr1, @SeqNbr1
						WHILE @@FETCH_STATUS = 0
						BEGIN	
							select @CovDesc1 = LookupValueDesc from ShSeleLookupValues
							where LocationId = @LocationId and MasterCompanyId = @MasterCompanyId and PolicyCompanyId = @PolicyCompanyId
						    and Statecd = @StateCd and LookupCd ='ADDINSTYPE' and LookupValueCd = @CovItem1	
						    set @CovDesc1 = '* ' + @CovDesc1
						    
						    --Insert the heading and description
						    Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  0, 
															  @CovDesc1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  0,
															  0,															  
															  @CovItem1,
															  @SortOrder 
																		  )	
																		  											              
						    Select distinct  @line1 = FieldValueTxt from SHCoverageScheduleItems
									 Where AppId=@AppId and FieldNameTxt='Description1' 
									  And LocationNbr = @LocNbr1
									  And BuildingNbr = @BlgNbr1
									  And LineOfBusinessCd=@LOB
									  And InsuranceLineCd=@InsuranceLineCd
									  And ScheduleItemSeqNbr=@SeqNbr1
									  And CoverageSequenceNbr=@CovSeqNbr1
									  and CoverageItemCd = @CovItem1																			  
									  And CoverageCd in ('ADDINS')
							if rtrim(@Line1) <> ''	
							   Begin 
							   Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  1,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder 
																		  )	
							   End											  
							   Set @Line1 = ''	--VDT DON-365 7FEB17 365								  
							   Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description2' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd in ('ADDINS')	
							  if rtrim(@Line1) <> ''						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
																		  )	
								 End			 
								  Set @Line1 = ''	--VDT DON-365 7FEB17 365								 
							  Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description3' 
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1	
										 and CoverageItemCd = @CovItem1																	 
										 And CoverageCd in ('ADDINS')
							   if rtrim(@Line1) <> '' 
							      Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  3,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
																		  )		
								  End 										  	 
								   Set @Line1 = ''	--VDT DON-365 7FEB17 365															  	 
							   Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description4'
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1  
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1
										 And CoverageCd in ('ADDINS')
							    if rtrim(@Line1) <> ''
							       Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  4,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
																		  )	
																		  
																		  
																
								  End		
								   Set @Line1 = ''	--VDT DON-365 7FEB17 365							
								  
								  Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description5'
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1  
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1
										 And CoverageCd in ('ADDINS')
							    if rtrim(@Line1) <> ''	
							       Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  4,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
															  )
															  
									end						  
									 Set @Line1 = ''	--VDT DON-365 7FEB17 365										  
								  Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description6'
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1  
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1
										 And CoverageCd in ('ADDINS')
										 
							    if rtrim(@Line1) <> ''
							       Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  4,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
															  )								  				 
							  		end	
									 Set @Line1 = ''	--VDT DON-365 7FEB17 365							
							  		
							  		Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description7'
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1  
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1
										 And CoverageCd in ('ADDINS')
										 
							    if rtrim(@Line1) <> ''
							       Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  4,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
															  )								  				 
							  		end	
							  		 Set @Line1 = ''	--VDT DON-365 7FEB17 365													  		
							  		
							  		Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description8'
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1  
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1
										 And CoverageCd in ('ADDINS')
										 
							    if rtrim(@Line1) <> ''
							       Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  4,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
															  )								  				 
							  		end													  
										set @SortOrder = @SortOrder + 1	
										set @Line1 = ''						  												   					                                                                                          						                             
							FETCH NEXT FROM @CursorScheduleItemNbrCov INTO @CoverageCd1, @CovItem1, @LocNbr1, @BlgNbr1, @CovSeqNbr1, @SeqNbr1
						END
					END			
		--DON365 - SS - Ends
		
		DECLARE @coverages TABLE 
		( 			
			BO_COV_INSLINE varchar(30), 
			BO_COV_LOCNBR numeric(10,0),			
			BO_COV_BLDGNBR numeric(10,0),
			BO_COV_Coverage numeric(10,0),
			BO_COV_CD varchar(100),
			BO_COV_LIMIT varchar(30),			
			BO_COVDED_LIMIT varchar(7),
			BO_COV_PREM numeric(10,0),
			COV_SUM numeric(10,0),
			COVERAGECD varchar(30)
		)
		
		  INSERT INTO @coverages		  		
		  SELECT
			BO_COV_INSLINE =A.InsuranceLineCd,
			BO_COV_LOCNBR = IsNull(A.LocationNbr,0),
			BO_COV_BLDGNBR = IsNull(A.BuildingNbr,0),
			BO_COV_Coverage = IsNull(A.BuildingNbr,0),
			--Pcr-66 Start
			BO_COV_CD = ISNULL((select CoverageDes from SHSeleCovDescription with (nolock) 
									where A.CoverageCd=SHSeleCovDescription.CoverageCd 
										  and SHSeleCovDescription.hostcd='PT'
										  and shselecovdescription.LineOfBusinessCd = @LOB
										  and shselecovdescription.InsuranceLineCd = @InsuranceLineCd 
										  and (shselecovdescription.statecd = '99' or shselecovdescription.statecd = @StateCd)                                
									),A.CoverageCd),	--DON00059
					
			--Pcr-66 End                    
			BO_COV_LIMIT =	CASE
								 WHEN RTRIM(A.CoverageCd)  = 'BAILEE' AND BOPropertyInfo.SubTypeCd = 'DC' THEN 'Actual Loss Sustained'
								 WHEN RTRIM(A.CoverageCd)  = 'BUSINC' THEN 'Actual Loss Sustained' 
								 WHEN RTRIM(A.CoverageCd)  = 'BLKT' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'ORDBLD' THEN 'Included' 
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK1' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK2' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK3' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'SPRFLK' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'EQBDN' THEN 'Included' --fsit 240038 dlh start
								 WHEN RTRIM(A.CoverageCd) = 'BBPL' THEN 
--								 CAST(@BarBeauLimit AS VARCHAR)
                                            CAST ((SELECT TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
														Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
														Else 0 
													  End
														--TL BOP NY 2010, FSIT 139573 Ends
											FROM SHSeleCovParms AS F 
															LEFT JOIN SHCoverageDetailItems AS C ON
																C.AppId = @AppId 
																AND C.LocationNbr = A.LocationNbr
																AND C.BuildingNbr = A.BuildingNbr 	
																AND F.LineOfBusinessCd = C.LineOfBusinessCd 
																AND F.InsuranceLineCd = C.InsuranceLineCd 
																AND F.CoverageCd = C.CoverageCd 
																AND C.CoverageSequenceNbr = 1 
																AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
															AND F.LocationId IN ('99', @LocationId) 
															AND F.MasterCompanyId IN ('99', @MasterCompanyId) 
															AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
															AND F.StateCd IN ('99' , @StateCd)	
															AND F.LineOfBusinessCd = @LOB 
															AND F.InsuranceLineCd  = @InsuranceLineCd 	
															AND RTRIM(F.CoverageCd) = 'BBPL' 
															AND CoverageParmSeqNbr = 10) AS VARCHAR)														
								 WHEN RTRIM(A.CoverageCd) = 'OPTHR' THEN 
--								 CAST(@OptHearLimit AS VARCHAR)
													CAST ((SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
																		Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
																		Else 0 
																	  End
														--TL BOP NY 2010, FSIT 139573 Ends
														FROM SHSeleCovParms AS F 
															LEFT JOIN SHCoverageDetailItems AS C ON
																C.AppId = @AppId
																AND C.LocationNbr = A.LocationNbr
													            AND C.BuildingNbr = A.BuildingNbr		
																AND F.LineOfBusinessCd = C.LineOfBusinessCd 
																AND F.InsuranceLineCd = C.InsuranceLineCd 
																AND F.CoverageCd = C.CoverageCd 
																AND C.CoverageSequenceNbr = 1 
																AND F.CoverageParmFieldId = C.FieldNameTxt				
														WHERE F.HostCd = 'PT'
															AND F.LocationId IN ('99', @LocationId) 
															AND F.MasterCompanyId IN ('99', @MasterCompanyId)
															AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
															AND F.StateCd IN ('99' , @StateCd) 	
															AND F.LineOfBusinessCd = @LOB 
															AND F.InsuranceLineCd  = @InsuranceLineCd 	
															AND RTRIM(F.CoverageCd) = 'OPTHR'
															AND CoverageParmSeqNbr = 10) AS VARCHAR)														
								 WHEN RTRIM(A.CoverageCd) = 'PRINT' THEN 
								 --CAST(@PrinterLimit AS VARCHAR)
										CAST ((SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
														Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
														Else 0 
													  End
										--TL BOP NY 2010, FSIT 139573 Ends
										FROM SHSeleCovParms AS F 
											LEFT JOIN SHCoverageDetailItems AS C ON
												C.AppId = @AppId
												AND C.LocationNbr = A.LocationNbr
												AND C.BuildingNbr = A.BuildingNbr		
												AND F.LineOfBusinessCd = C.LineOfBusinessCd 
												AND F.InsuranceLineCd = C.InsuranceLineCd 
												AND F.CoverageCd = C.CoverageCd 
												AND C.CoverageSequenceNbr = 1 
												AND F.CoverageParmFieldId = C.FieldNameTxt				
										WHERE F.HostCd = 'PT'
											AND F.LocationId IN ('99', @LocationId)
											AND F.MasterCompanyId IN ('99', @MasterCompanyId)
											AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
											AND F.StateCd IN ('99' , @StateCd)
											AND F.LineOfBusinessCd = @LOB
											AND F.InsuranceLineCd  = @InsuranceLineCd	
											AND RTRIM(F.CoverageCd) = 'PRINT'
											AND CoverageParmSeqNbr = 10) AS VARCHAR)											
								 WHEN RTRIM(A.CoverageCd) = 'PHARM' THEN 
								 --CAST(@PharmLimit AS VARCHAR)
										 dbo.format_currency(Convert(decimal(20,0), (
											SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd
												AND RTRIM(F.CoverageCd) = 'PHARM'
												AND CoverageParmFieldId = 'PharmOccLmt'
											)))  + ' / ' + dbo.format_currency(Convert(decimal(20,0), (
											SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
												AND F.StateCd IN ('99' , @StateCd)
												AND F.InsuranceLineCd  = @InsuranceLineCd
												AND RTRIM(F.CoverageCd) = 'PHARM'
												AND CoverageParmFieldId = 'PharmAggLmt'		--TP 0215 147949 changed from PharmOccLmt
											)))
								 WHEN RTRIM(A.CoverageCd) = 'BUSINE' THEN 
								 --CAST(@IncomeExtDays AS VARCHAR) 
											CAST ((SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr		
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1 
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId)
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd	
												AND RTRIM(F.CoverageCd) = 'BUSINE'
												AND CoverageParmSeqNbr = 10) AS VARCHAR)												
								 WHEN RTRIM(A.CoverageCd) = 'BUSINP' THEN 
								 --CAST(@IncomePayDays AS VARCHAR) 
											CAST ((SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr	
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1 
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId)
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd	
												AND RTRIM(F.CoverageCd) = 'BUSINP'
												AND CoverageParmSeqNbr = 10) AS VARCHAR)												
								 WHEN RTRIM(A.CoverageCd) = 'AUTO' THEN 
								 --CAST(@AutoIncrease AS VARCHAR) 
											CAST ((SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
															Then convert(smallint, ISNULL(C.FieldValueTxt,0)) 
															Else 0 
														  End
											--TL BOP NY 2010, FSIT 139573 Ends
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr	
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1 
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId)
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd	
												AND RTRIM(F.CoverageCd) = 'AUTO'
												AND CoverageParmSeqNbr = 10) AS VARCHAR)												
								 WHEN RTRIM(A.CoverageCd) = 'LIQUOR' THEN 
--								      @LiquorLiaLimit --fsit fix for Liquor for multi building, locations start
                                      dbo.format_currency(Convert(decimal(20,0), (
											SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd
												AND RTRIM(F.CoverageCd) = 'LIQUOR'
												AND CoverageParmFieldId = 'CommonCauseLimit'
											)))  + ' / ' + dbo.format_currency(Convert(decimal(20,0), (
											SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
												AND F.StateCd IN ('99' , @StateCd)
												AND F.InsuranceLineCd  = @InsuranceLineCd
												AND RTRIM(F.CoverageCd) = 'LIQUOR'
												AND CoverageParmFieldId = 'AggregateLimit'
											)))
											--fsit fix for Liquor for multi building, locations end
								 WHEN RTRIM(A.CoverageCd) = 'LIQLSE' THEN 
								 --@LiquorSchLimit
											dbo.format_currency(Convert(decimal(20,0), (
													SELECT ISNULL(C.FieldValueTxt,'')
													FROM SHSeleCovParms AS F
														LEFT JOIN SHCoverageDetailItems AS C ON
															C.AppId = @AppId
															AND C.LocationNbr = A.LocationNbr
													        AND C.BuildingNbr = A.BuildingNbr
															AND F.LineOfBusinessCd = C.LineOfBusinessCd 
															AND F.InsuranceLineCd = C.InsuranceLineCd 
															AND F.CoverageCd = C.CoverageCd 
															AND C.CoverageSequenceNbr = 1
															AND F.CoverageParmFieldId = C.FieldNameTxt				
													WHERE F.HostCd = 'PT'
														AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
														AND F.MasterCompanyId IN ('99', @MasterCompanyId)
														AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
														AND F.StateCd IN ('99' , @StateCd)
														AND F.LineOfBusinessCd = @LOB
														AND F.InsuranceLineCd  = @InsuranceLineCd
														AND RTRIM(F.CoverageCd) = 'LIQLSE'
														AND CoverageParmFieldId = 'OccurrenceLimit'
													)))  + ' / ' + dbo.format_currency(Convert(decimal(20,0), (
													SELECT ISNULL(C.FieldValueTxt,'')
													FROM SHSeleCovParms AS F 
														LEFT JOIN SHCoverageDetailItems AS C ON
															C.AppId = @AppId
															AND C.LocationNbr = A.LocationNbr
													        AND C.BuildingNbr = A.BuildingNbr
															AND F.LineOfBusinessCd = C.LineOfBusinessCd 
															AND F.InsuranceLineCd = C.InsuranceLineCd 
															AND F.CoverageCd = C.CoverageCd 
															AND C.CoverageSequenceNbr = 1
															AND F.CoverageParmFieldId = C.FieldNameTxt				
													WHERE F.HostCd = 'PT'
														AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
														AND F.MasterCompanyId IN ('99', @MasterCompanyId)
														AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
														AND F.StateCd IN ('99' , @StateCd)
														AND F.InsuranceLineCd  = @InsuranceLineCd
														AND RTRIM(F.CoverageCd) = 'LIQLSE'
														AND CoverageParmFieldId = 'AggregateLimit'
													)))
								 WHEN RTRIM(A.CoverageCd) IN ('CONTR','FOOD') THEN ''
								 WHEN RTRIM(A.CoverageCd) = 'ADDINS' THEN '' --fist 139938								
							ELSE CAST(A.TotalExposureAmt AS VARCHAR) 
						END,
			BO_COVDED_LIMIT = (
							CASE
								WHEN RTRIM(A.CoverageCd) IN ('BUSINC','NYFEE') THEN '0'
								--fsit 139744
								WHEN RTRIM(A.CoverageCd) IN ('ADDLES', 'ADDMGR', 'SPOIL') THEN '500' --TP 0215 147949 removed 'PHARM'
								WHEN RTRIM(A.CoverageCd) = 'WATER' THEN RTrim(UnitDeductCd)
								--DON-1549 VinhLe 9/21/17 Starts
								WHEN RTRIM(A.CoverageCd) = 'EQBDN' THEN 
									(select Rtrim(FieldValueTxt) from SHCoverageDetailItems where AppId = @Appid  
								                                        and FieldNameTxt = 'DedAmount' 
								                                        and CoverageSequenceNbr = 1 
								                                        AND LocationNbr = A.LocationNbr 
												                        AND BuildingNbr = A.BuildingNbr	
								                                        and CoverageCd = 'EQBDN')
								--DON-1549 VinhLe 9/21/17 Ends
								WHEN RTRIM(A.CoverageCD) = 'EQBLDG' THEN --Fsit 147623, 153132 12/21/12, 3/3/14 dlh start 								    
								    CASE 
								        WHEN (select Rtrim(FieldValueTxt) from SHCoverageDetailItems where AppId = @Appid  
								                                        and FieldNameTxt = 'EarthquakeOptDed' 
								                                        and CoverageSequenceNbr = 1 
								                                        AND LocationNbr = A.LocationNbr 
												                        AND BuildingNbr = A.BuildingNbr	
								                                        and CoverageCd = 'EQBLDG') <> 'NA' THEN 
								                                        
												  CAST ((SELECT ISNULL(C.FieldValueTxt,'') + '%'
												   FROM SHSeleCovParms AS F
													LEFT JOIN SHCoverageDetailItems AS C ON
														C.AppId = @Appid
														AND C.LocationNbr = A.LocationNbr 
														AND C.BuildingNbr = A.BuildingNbr	
														AND F.LineOfBusinessCd = C.LineOfBusinessCd 
														AND F.InsuranceLineCd = C.InsuranceLineCd 
														AND F.CoverageCd = C.CoverageCd 
														AND C.CoverageSequenceNbr = 1
														AND F.CoverageParmFieldId = C.FieldNameTxt				
												   WHERE F.HostCd = 'PT'
													AND F.LocationId IN ('99', '00')
													AND F.MasterCompanyId IN ('99', '02')
													AND F.PolicyCompanyId IN ('99', '00') 
													AND F.StateCd IN ('99' , 'NY')
													AND F.LineOfBusinessCd = 'BP'
													AND F.InsuranceLineCd  = 'NBP'
													AND F.CoverageParmFieldId = 'EarthquakeOptDed'
													AND RTRIM(F.CoverageCd) = 'EQBLDG') AS VARCHAR)
								    Else
											CAST ((SELECT ISNULL(C.FieldValueTxt,'') + '%'
											FROM SHSeleCovParms AS F
													LEFT JOIN SHCoverageDetailItems AS C ON
														C.AppId = @AppId
														AND C.LocationNbr = A.LocationNbr 
														AND C.BuildingNbr = A.BuildingNbr		
														AND F.LineOfBusinessCd = C.LineOfBusinessCd 
														AND F.InsuranceLineCd = C.InsuranceLineCd 
														AND F.CoverageCd = C.CoverageCd 
														AND C.CoverageSequenceNbr = 1
														AND F.CoverageParmFieldId = C.FieldNameTxt				
												WHERE F.HostCd = 'PT'
													AND F.LocationId IN ('99', @LocationId)
													AND F.MasterCompanyId IN ('99', @MasterCompanyId)
													AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
													AND F.StateCd IN ('99' , @StateCd)
													AND F.LineOfBusinessCd = @LOB
													AND F.InsuranceLineCd  = @InsuranceLineCd
													AND F.CoverageParmFieldId = 'EarthquakeDedPerc'	
													AND RTRIM(F.CoverageCd) = 'EQBLDG') AS VARCHAR) --Fsit 147623, 153132 12/21/12, 3/3/14 dlh start
									End                                 												
								WHEN RTRIM(A.CoverageCd) = 'RESTLL' THEN 
								--@RestLoss	
										CAST ((SELECT ISNULL(C.FieldValueTxt,'')
										FROM SHSeleCovParms AS F
											LEFT JOIN SHCoverageDetailItems AS C ON
												C.AppId = @AppId
												AND C.LocationNbr = A.LocationNbr 
												AND C.BuildingNbr = A.BuildingNbr		
												AND F.LineOfBusinessCd = C.LineOfBusinessCd 
												AND F.InsuranceLineCd = C.InsuranceLineCd 
												AND F.CoverageCd = C.CoverageCd 
												AND C.CoverageSequenceNbr = 1
												AND F.CoverageParmFieldId = C.FieldNameTxt				
										WHERE F.HostCd = 'PT'
											AND F.LocationId IN ('99', @LocationId)
											AND F.MasterCompanyId IN ('99', @MasterCompanyId)
											AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
											AND F.StateCd IN ('99' , @StateCd)
											AND F.LineOfBusinessCd = @LOB
											AND F.InsuranceLineCd  = @InsuranceLineCd	
											AND RTRIM(F.CoverageCd) = 'RESTLL'
											AND CoverageParmSeqNbr = 20) AS VARCHAR)															
								WHEN ISNUMERIC(A.DeductibleAmt) <> 1 THEN IsNull(A.DeductibleAmt,'')								
								WHEN RTRIM(A.CoverageCd) IN ('ADDINS','HIRED','NONOWN','PHARM','POOL','EQBDN') THEN ''	
																
								WHEN RTRIM(A.CoverageCd) IN ('EMPDIS','FORGE','MONEY','SIGNS') THEN '500'     
								WHEN RTRIM(A.CoverageCd) IN ('BBPL','BROADN','CONTR','LIQLSE','LIQUOR','MOTELS','OPTHR','PLAYAM','PRINT','YARD') THEN
								     Case
									     WHEN RTRIM(BOPropertyInfo.LiabDeductAmt) = '' THEN ''
									     ELSE
									         RTRIM(BOPropertyInfo.LiabDeductAmt) 
									 End  	 
								--fsit f139744	    
								ELSE IsNull(A.DeductibleAmt,'') 
							END),       
			BO_COV_PREM = cast(IsNull(A.PremiumAmt,0) as money) ,
			COV_SUM = IsNull(B.PremiumAmt,0),
			A.CoverageCd
		FROM 
			BORating A with (nolock) 
		INNER JOIN BORating B on B.Appid=A.Appid and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.BuildingNbr and B.CoverageCd='0'
		INNER JOIN BOPropertyInfo ON 
			BOPropertyInfo.AppId = A.AppId 
			AND BOPropertyInfo.LocationNbr = A.LocationNbr 
			AND BOPropertyInfo.StructureNbr = A.BuildingNbr
		--Pcr-66 Start	
		INNER JOIN SHSeleCovDescription D ON
			       D.CoverageCd=A.CoverageCd 
                   and D.hostcd='PT'
                   and D.LineOfBusinessCd = @LOB
				   and D.InsuranceLineCd = @InsuranceLineCd 
				   and (D.statecd = '99' or D.statecd = @StateCd)
		--Pcr-66 End		   
		WHERE 
			A.AppId = @AppId and 
			A.LocationNbr<>0 and 
			A.BuildingNbr <> 0 and 
			A.CoverageCd NOT IN('0', 'ADDINS')	--DON365 - SS
		--Fsit 139909 start
		Union All
		SELECT Distinct
				  BO_COV_INSLINE = 'NBP'
				, BO_COV_LOCNBR = C.LocationNbr
				, BO_COV_BLDGNBR = C.BuildingNbr
				, BO_COV_Coverage = C.BuildingNbr
				, BO_COV_CD = 
				             CASE
				                 WHEN RTRIM(C.FieldNameTxt) = 'OrdLawCov1' Then
				                      '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coverage 1 Limit' 
				                 WHEN RTRIM(C.FieldNameTxt) = 'OrdLawDem' Then  
				                       '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coverage 2 Limit'    
				                 WHEN RTRIM(C.FieldNameTxt) = 'OrdLawConst' Then    
				                      '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coverage 3 Limit' 
				                 WHEN RTRIM(C.FieldNameTxt) = 'OrdLawComb' Then    
				                      '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Coverage 2 & 3 Limit' 
                                 --fsit 240038 dlh start
                                 WHEN RTRIM(C.FieldNameTxt) = 'SpoilSubLimit' then
								       '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spoilage'
                                 WHEN RTRIM(C.FieldNameTxt) = 'RefrigLimit' then
								       '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Refrigerant Contamination'
                                 WHEN RTRIM(C.FieldNameTxt) = 'PollCleanRemoval' then
								       '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pollutant Cleanup'
                                 --fsit 240038 dlh end
				                 END           
				, BO_COV_LIMIT = 
							CASE 
								WHEN C.FieldValueTxt Is Null THEN '' 
								WHEN RTRIM(C.FieldValueTxt) = '' THEN '' 
								ELSE IsNull(C.FieldValueTxt,'')								
							END
				, BO_COVDED_LIMIT = '0'					
				, BO_COV_PREM = 0
				, COV_SUM = 0
				, A.CoverageCd 								
				FROM SHSeleCovParms AS A 
					LEFT JOIN SHCoverageDetailItems AS C ON
						C.AppId = @AppId						
						AND A.LineOfBusinessCd = C.LineOfBusinessCd 
						AND A.InsuranceLineCd = C.InsuranceLineCd 
						AND A.CoverageCd = C.CoverageCd 						
						AND A.CoverageParmFieldId = C.FieldNameTxt
				WHERE A.HostCd = @Host
					AND A.LocationId IN ('99', @LocationId) 
					AND A.MasterCompanyId IN ('99', @MasterCompanyId)
					AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND A.StateCd IN ('99' , @StateCd) 			
					AND A.LineOfBusinessCd = @LOB 
					AND A.InsuranceLineCd  = @InsuranceLineCd 			
					AND RTRIM(A.CoverageCd) IN ('ORDLAW') 
					AND RTRIM(C.FieldValueTxt) <> '' and RTRIM(C.FieldValueTxt) Not IN ('N','Y')
									
					AND A.StateCd = 'NY'
					AND RTRIM(A.CoverageCd) IN (
								SELECT D.CoverageCd
								FROM 
									BORating X with (nolock) 
								INNER JOIN BORating B on B.Appid=X.Appid and B.LocationNbr=X.LocationNbr and B.BuildingNbr=X.BuildingNbr and B.CoverageCd='0'
								INNER JOIN BOPropertyInfo ON 
									BOPropertyInfo.AppId = X.AppId 
									AND BOPropertyInfo.LocationNbr = X.LocationNbr 
									AND BOPropertyInfo.StructureNbr = X.BuildingNbr								
								INNER JOIN SHSeleCovDescription D ON
									       D.CoverageCd=X.CoverageCd and D.hostcd='PT'
                                           and D.LineOfBusinessCd = @LOB
				                           and D.InsuranceLineCd = @InsuranceLineCd 
				                           and (D.statecd = '99' or D.statecd = @StateCd)				                        
								WHERE 
									X.AppId = @AppId and 
									X.LocationNbr<>0 and 
									X.BuildingNbr <> 0 and 
									X.CoverageCd<>'0'			
							)		
		--Fsit 139909 end								 		
		UNION ALL
		SELECT
				  BO_COV_INSLINE = 'NBP'
				, BO_COV_LOCNBR = C.LocationNbr
				, BO_COV_BLDGNBR = C.BuildingNbr
				, BO_COV_Coverage = C.BuildingNbr
				, BO_COV_CD = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + ISNULL(REPLACE(REPLACE(REPLACE(A.CoverageParmHeadingTxt, '($):', ''), '* ', ''), '*', ''), '')
				, BO_COV_LIMIT = 
							CASE 
								WHEN FieldValueTxt Is Null THEN '' --0
								WHEN RTRIM(FieldValueTxt) = '' THEN '' --0
								ELSE IsNull(FieldValueTxt,'')
								--ELSE Convert(numeric(10,0), FieldValueTxt)
							END
				, BO_COVDED_LIMIT = '0'	--TP BOP NY 2010, Fix tech error when added Water
				, BO_COV_PREM = 0
				, COV_SUM = 0
				, A.CoverageCd 								
				FROM SHSeleCovParms AS A 
					LEFT JOIN SHCoverageDetailItems AS C ON
						C.AppId = @AppId						
						AND A.LineOfBusinessCd = C.LineOfBusinessCd 
						AND A.InsuranceLineCd = C.InsuranceLineCd 
						AND A.CoverageCd = C.CoverageCd 
						--AND C.CoverageSequenceNbr = 1
						AND A.CoverageParmFieldId = C.FieldNameTxt	
				WHERE A.HostCd = @Host
					AND A.LocationId IN ('99', @LocationId) 
					AND A.MasterCompanyId IN ('99', @MasterCompanyId)
					AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND A.StateCd IN ('99' , @StateCd) 			
					AND A.LineOfBusinessCd = @LOB 
					AND A.InsuranceLineCd  = @InsuranceLineCd 			
					AND RTRIM(A.CoverageCd) IN ('CONTR', 'FOOD') 
					AND A.MandatoryFieldsEditMsgTxt LIKE '%Limit'
					AND A.StateCd = 'NY'
					AND RTRIM(A.CoverageCd) IN (
								SELECT D.CoverageCd
								FROM 
									BORating X with (nolock) 
								INNER JOIN BORating B on B.Appid=X.Appid and B.LocationNbr=X.LocationNbr and B.BuildingNbr=X.BuildingNbr and B.CoverageCd='0'
								INNER JOIN BOPropertyInfo ON 
									BOPropertyInfo.AppId = X.AppId 
									AND BOPropertyInfo.LocationNbr = X.LocationNbr 
									AND BOPropertyInfo.StructureNbr = X.BuildingNbr
								--Pcr-66 Start	
								INNER JOIN SHSeleCovDescription D ON
									       D.CoverageCd=X.CoverageCd and D.hostcd='PT'
                                           and D.LineOfBusinessCd = @LOB
				                           and D.InsuranceLineCd = @InsuranceLineCd 
				                           and (D.statecd = '99' or D.statecd = @StateCd)
				                --Pcr-66 End           
								WHERE 
									X.AppId = @AppId and 
									X.LocationNbr<>0 and 
									X.BuildingNbr <> 0 and 
									X.CoverageCd<>'0'			
							)
--fsit 240038 dlh start
        UNION ALL
		SELECT Distinct
				  BO_COV_INSLINE = 'NBP'
				, BO_COV_LOCNBR = C.LocationNbr
				, BO_COV_BLDGNBR = C.BuildingNbr
				, BO_COV_Coverage = C.BuildingNbr
				, BO_COV_CD = 
				             CASE				                 
                                 WHEN RTRIM(C.FieldNameTxt) = 'SpoilSubLimit' then
								       '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Spoilage'
                                 WHEN RTRIM(C.FieldNameTxt) = 'RefrigLimit' then
								       '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Refrigerant Contamination'
                                 WHEN RTRIM(C.FieldNameTxt) = 'PollCleanRemoval' then
								       '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Pollutant Cleanup'
				                 END           
				, BO_COV_LIMIT = 
							CASE 
								WHEN C.FieldValueTxt Is Null THEN '' 
								WHEN RTRIM(C.FieldValueTxt) = '' THEN '' 
								ELSE IsNull(C.FieldValueTxt,'')								
							END
				, BO_COVDED_LIMIT = (select UnitDeductcd from 	BOPropertyInfo where appid = @appid and locationnbr = C.LocationNbr and StructureNbr =  C.BuildingNbr) 	
				, BO_COV_PREM = 0
				, COV_SUM = 0
				, A.CoverageCd 								
				FROM SHSeleCovParms AS A 
					 JOIN SHCoverageDetailItems AS C ON
						C.AppId = @appid						
						AND A.LineOfBusinessCd = C.LineOfBusinessCd 
						AND A.InsuranceLineCd = C.InsuranceLineCd 
						AND A.CoverageCd = C.CoverageCd 						
						AND A.CoverageParmFieldId = C.FieldNameTxt		
						and RTRIM(a.CoverageParmFieldId) in ('PollCleanRemoval','RefrigLimit','SpoilSubLimit')	
                       --fsit 240038 dlh 3/3/16 start
					JOIN BOPropertyInfo ON 
									BOPropertyInfo.AppId = @appid
									AND BOPropertyInfo.LocationNbr = @LocationNumber  
									AND BOPropertyInfo.StructureNbr = @BuildingNbr			
				    WHERE A.HostCd = 'PT'
                    --fsit 240038 dlh 3/3/16 end
					AND A.LocationId IN ('99', @LocationId) 
					AND A.MasterCompanyId IN ('99', @MasterCompanyId)
					AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND A.StateCd IN ('99' , @StateCd) 			
					AND A.LineOfBusinessCd = @LOB 
					AND A.InsuranceLineCd  = @InsuranceLineCd 			
					AND RTRIM(A.CoverageCd) IN ('EQBDN') 														
					AND A.StateCd = @StateCd
					
					AND RTRIM(A.CoverageCd) IN (
								SELECT D.CoverageCd
								FROM 
									BORating X with (nolock) 
								INNER JOIN BORating B on B.Appid=X.Appid and B.LocationNbr=X.LocationNbr and B.BuildingNbr=X.BuildingNbr and B.CoverageCd='0'
								INNER JOIN BOPropertyInfo ON 
									BOPropertyInfo.AppId = X.AppId 
									AND BOPropertyInfo.LocationNbr = X.LocationNbr 
									AND BOPropertyInfo.StructureNbr = X.BuildingNbr								
								INNER JOIN SHSeleCovDescription D ON
									       D.CoverageCd=X.CoverageCd and D.hostcd='PT'
                                           and D.LineOfBusinessCd =@LOB 
				                           and D.InsuranceLineCd = @InsuranceLineCd
				                           and (D.statecd = '99' or D.statecd = @StateCd)				                        
								WHERE 
									X.AppId = @appid and 
									X.LocationNbr<>0 and 
									X.BuildingNbr <> 0 and 
									X.CoverageCd<>'0'			
							)		
--fsit 240038 dlh end
		UNION ALL
        Select Distinct
			BO_COV_INSLINE = 'NBP', 
			BO_COV_LOCNBR = A.LocationNbr,
			BO_COV_BLDGNBR = A.StructureNbr,
			BO_COV_Coverage = IsNull(A.StructureNbr,0),
			BO_COV_CD = 'Named Perils Applies' ,
			BO_COV_LIMIT = '0',			
			BO_COVDED_LIMIT = '0',
			BO_COV_PREM = 0,
			COV_SUM = 0,
			COVERAGECD = 'P'
			FROM 
				 BOPropertyInfo A				 					
				 INNER JOIN BORating B ON B.Appid = A.Appid and B.LocationNbr = A.LocationNbr and B.BuildingNbr = A.StructureNbr
			Where 
				A.Appid = @Appid 
                AND A.BuildingNamedPerilsInd = 1 
			    AND A.LocationNbr<>0 
				AND A.StructureNbr <> 0 
				AND B.CoverageCd<>'0' 
		UNION ALL
        Select Distinct
			BO_COV_INSLINE = 'NBP', 
			BO_COV_LOCNBR = A.LocationNbr,
			BO_COV_BLDGNBR = A.StructureNbr,
			BO_COV_Coverage = IsNull(A.StructureNbr,0),
			BO_COV_CD = 'Burglary and Robbery' ,
			BO_COV_LIMIT = '0',			
			BO_COVDED_LIMIT = '0',
			BO_COV_PREM = 0,
			COV_SUM = 0,
			COVERAGECD = 'R'
			FROM 
				 BOPropertyInfo A				 					
				 INNER JOIN BORating B ON B.Appid = A.Appid and B.LocationNbr = A.LocationNbr and B.BuildingNbr = A.StructureNbr
			Where 
				A.Appid = @Appid 
                AND A.BurglaryRobberyInd = 1 
			    AND A.LocationNbr<>0 
				AND A.StructureNbr <> 0 
				AND B.CoverageCd<>'0' 
		--DON365 - SS - Starts				
		UNION ALL
		SELECT BO_COV_INSLINE, 
			BO_COV_LOCNBR ,
			BO_COV_BLDGNBR,		
			BO_COV_BLDGNBR,					
			BO_COV_CD  ,
			BO_COV_LIMIT = '0',			
			BO_COVDED_LIMIT = '0',
			BO_COV_PREM = 0,
			COV_SUM = 0,
			CoverageCd from @TempTableCov A		
		--DON365 - SS - Ends
				
		Declare @tpBuildingNumber int
		Declare @tpLocationNumber int
        declare @tblTemp table (Bld smallint, Loc smallint)
		
		insert into @tblTemp select StructureNbr, LocationNbr From BOPropertyInfo Where Appid=@Appid			
		declare CurBuildList cursor for select * from @tblTemp order by bld, loc
	   
		open CurBuildList
		fetch next from CurBuildList into @tpBuildingNumber, @tpLocationNumber while @@FETCH_STATUS = 0
		BEGIN
			IF ((SELECT top 1  BO_COV_LIMIT FROM @coverages WHERE COVERAGECD='ACCTS' AND BO_COV_BLDGNBR = @tpBuildingNumber AND BO_COV_LOCNBR =  @tpLocationNumber ) < '10001')
				DELETE FROM @coverages WHERE COVERAGECD='ACCTS'
			IF ((SELECT top 1 BO_COV_LIMIT FROM @coverages WHERE COVERAGECD='VALPAP' AND BO_COV_BLDGNBR = @tpBuildingNumber AND BO_COV_LOCNBR =  @tpLocationNumber ) < '10001')
				DELETE FROM @coverages WHERE COVERAGECD='VALPAP'
			IF ((SELECT count(Coveragecd) FROM @coverages WHERE COVERAGECD='ORDLAW' AND BO_COV_BLDGNBR = @tpBuildingNumber AND BO_COV_LOCNBR =  @tpLocationNumber ) >= 1)
				Update @coverages set BO_COV_LIMIT = '' WHERE COVERAGECD='ORDLAW' and RTRIM(BO_COV_CD) = 'Ordinance or Law'
				                                             AND BO_COV_BLDGNBR = @tpBuildingNumber AND BO_COV_LOCNBR =  @tpLocationNumber	--fsit 139909	
			fetch next from CurBuildList into @tpBuildingNumber, @tpLocationNumber
		END
		close CurBuildList
		deallocate CurBuildList
		
		update @Coverages set coveragecd = 'CONTR1' where 
        bo_cov_cd = 'Contractors Install Tools and Equip'
        update @Coverages set coveragecd = 'CONTR2' where 
        bo_cov_cd = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Installation Limit'
		update @Coverages set coveragecd = 'CONTR3' where 
        bo_cov_cd = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tools and Equipment Limit'
		update @Coverages set coveragecd = 'CONTR4' where 
        bo_cov_cd = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Non-owned Tools and Equipment Limit'
		update @Coverages set coveragecd = 'CONTR5' where 
        bo_cov_cd = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Employees Tools Limit'
        update @Coverages set coveragecd = 'CONTR6' where 
        bo_cov_cd = '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Total Installation Limit'
		--TP BOP NY 2010 Starts Remove END
        --TL BOP NY 2010 Ends
				
		SELECT
            BO_COV_INSLINE , 
			BO_COV_LOCNBR ,
			BO_COV_BLDGNBR,
			BO_COV_Coverage,
			BO_COV_CD  ,
			BO_COV_LIMIT ,			
			BO_COVDED_LIMIT ,
			BO_COV_PREM,
			COV_SUM ,
			COVERAGECD,
			--ROW_NUMBER()  OVER (PARTITION BY  BO_COV_LOCNBR,BO_COV_BLDGNBR, BO_COV_Coverage ORDER BY  BO_COV_LOCNBR, BO_COV_BLDGNBR ) --DON365 PN 08/02/2017
			ROW_NUMBER()  OVER (PARTITION BY  BO_COV_LOCNBR,BO_COV_BLDGNBR ORDER BY  BO_COV_LOCNBR, BO_COV_BLDGNBR ) --DON365 PN 08/02/2017
		FROM @coverages 
        WHERE COVERAGECD NOT IN ('LIAB','TENANT','NYFEE', 'ADDGRT','BP0497','VENDOR','ADDCOP','ADDLES','ADDOWN','ADDREQ','BO057','NPBLDO') --TL BOP NY 2010 Added this condition		--VDT DON-365 7FEB17
		--ORDER BY BO_COV_LOCNBR, BO_COV_BLDGNBR, BO_COV_Coverage, COVERAGECD --DON365 PN 08/02/2017
		--DON-1549 VinhLe Starts
		ORDER BY BO_COV_LOCNBR, BO_COV_BLDGNBR, 
		CASE
			WHEN BO_COV_CD = 'Building' THEN 1 
			WHEN BO_COV_CD = 'Business Personal Property' THEN 2
			WHEN BO_COV_CD like '%Equipment Breakdown Coverage%' THEN 3
			ELSE 4 END, BO_COV_CD  
		--DON-1549 VinhLe Ends
		--issue 109, 110 dlh		
	END
ELSE
	BEGIN
		--TP BPCA 2010 11092012 START
		-- fsit 153231 dlh 4/17/14 start	
		Set @SortOrder = 1      
		DECLARE @BPCACoverages TABLE 
		( 			
			BO_COV_INSLINE varchar(30), 
			BO_COV_LOCNBR numeric(10,0),			
			BO_COV_BLDGNBR numeric(10,0),			
			BO_COV_CD varchar(100),
			BO_COV_LIMIT varchar(30),			
			BO_COVDED_LIMIT varchar(15),
			BO_COV_PREM numeric(10,0),
			COV_SUM numeric(10,0),
			COVERAGECD varchar(30),
			SortOrder int
		);
		
		--DECLARE @CursorScheduleItemNbrCov AS CURSOR	--DON365 - SS
		
		Set @CursorScheduleItemNbrCov = CURSOR FORWARD_ONLY STATIC READ_ONLY FOR 
		Select Distinct CoverageCd, CoverageItemCd, LocationNbr, BuildingNbr, CoverageSequenceNbr, ScheduleItemSeqNbr from SHCoverageScheduleItems	
				Where AppId=@AppId And CoverageCd in ('ADDLUN')	
				order by CoverageCd, LocationNbr, BuildingNbr, CoverageItemCd, CoverageSequenceNbr
				
				OPEN @CursorScheduleItemNbrCov
				IF @@CURSOR_ROWS > 0			
					BEGIN
						FETCH NEXT FROM @CursorScheduleItemNbrCov INTO @CoverageCd1, @CovItem1,@LocNbr1, @BlgNbr1, @CovSeqNbr1, @SeqNbr1
						WHILE @@FETCH_STATUS = 0
						BEGIN	
							select @CovDesc1 = LookupValueDesc from ShSeleLookupValues
							where LocationId = @LocationId and MasterCompanyId = @MasterCompanyId and PolicyCompanyId = @PolicyCompanyId
						    and Statecd = @StateCd and LookupCd ='ADDLUNTYPE' and LookupValueCd = @CovItem1	
						    set @CovDesc1 = '* ' + @CovDesc1
						    Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  0, 
															  @CovDesc1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  0,
															  0,															  
															  @CovItem1,
															  @SortOrder 
																		  )												              
						    Select distinct  @line1 = FieldValueTxt from SHCoverageScheduleItems
									 Where AppId=@AppId and FieldNameTxt='Description1' 
									  And LocationNbr = @LocNbr1
									  And BuildingNbr = @BlgNbr1
									  And LineOfBusinessCd=@LOB
									  And InsuranceLineCd=@InsuranceLineCd
									  And ScheduleItemSeqNbr=@SeqNbr1
									  And CoverageSequenceNbr=@CovSeqNbr1
									  and CoverageItemCd = @CovItem1																			  
									  And CoverageCd in ('ADDLUN')
							if rtrim(@Line1) <> ''	
							   Begin 
							   Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  1,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder 
																		  )	
							   End											  
							   Select distinct @Line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description2' 
						  				  And LocationNbr = @LocNbr1
										  And BuildingNbr = @BlgNbr1
										  And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1																			 
										 And CoverageCd in ('ADDLUN')	
							  if rtrim(@Line1) <> '' and @CovItem1 <> 'BP0407'						  
							     Begin 				 															  
                                 Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1, 
															  @SeqNbr1,
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  2,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
																		  )	
								 End			 
							  Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description3' 
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd=@InsuranceLineCd
										 And ScheduleItemSeqNbr=@SeqNbr1
										 And CoverageSequenceNbr=@CovSeqNbr1	
										 and CoverageItemCd = @CovItem1																	 
										 And CoverageCd in ('ADDLUN')
							   if rtrim(@Line1) <> '' and  @CovItem1 <> 'BP0448' and @CovItem1 <> 'BP0406' 	and @CovItem1 <> 'BP0407' and @CovItem1 <> 'BP0449'							  
							      Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  3,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
																		  )		
								  End 										  	 
							   Select distinct @line1 = isnull(FieldValueTxt,'') from SHCoverageScheduleItems
										 Where AppId=@AppId and FieldNameTxt='Description4'
										 And LocationNbr = @LocNbr1
										 And BuildingNbr = @BlgNbr1
										 And LineOfBusinessCd=@LOB
										 And InsuranceLineCd='CBP'
										 And ScheduleItemSeqNbr=@SeqNbr1  
										 And CoverageSequenceNbr=@CovSeqNbr1
										 and CoverageItemCd = @CovItem1
										 And CoverageCd in ('ADDLUN')
							    if rtrim(@Line1) <> ''	and  @CovItem1 <> 'BP0448' and @CovItem1 <> 'BP0406' 	and @CovItem1 <> 'BP0407' and @CovItem1 <> 'BP0449'						  
							       Begin			 
							       Insert into @tempTableCov  values(
									                          @Appid, 
										                      @InsuranceLineCd,										                     
															  0,					--VDT DON-365 7FEB17
										                      @InsuranceLineCd,										                     
															  @LocNbr1, 
															  @BlgNbr1, 
															  @CovSeqNbr1,
															  @SeqNbr1, 
															  '&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' + @Line1, 
															  0,
															  0,
															  null,		--VDT DON-365 7FEB17
															  4,
															  @SeqNbr1,															  
															  @CovItem1,
															  @SortOrder
																		  )	
								  End										  				 
							  																	  
									Set @CovCnt = (Select count(*)  from SHCoveragedetailitems where appid = @appid  and fieldvalueTxt = '438BFU' and FieldNameTxt = 'CoverageTypeCd' and LocationNbr = @LocNbr1 and BuildingNbr = @BlgNbr1) 
									    If @CovCnt > 0
										Begin
											 select @CovDesc1 = LookupValueDesc from ShSeleLookupValues
											 where LocationId = @LocationId and MasterCompanyId = @MasterCompanyId and PolicyCompanyId = @PolicyCompanyId
											 and Statecd = @StateCd and LookupCd ='ADDLUNTYPE' and LookupValueCd = '438BFU'	
											 set @CovDesc1 = '* ' + @CovDesc1
											 if (select count(*) from @tempTableCov where BO_COV_LOCNBR = @LocNbr1 and BO_COV_BLDGNBR=  @BlgNbr1 and rtrim(BO_COV_CD) = rtrim(@CovDesc1)) = 0  
											    Insert into @tempTableCov  values(
																	  @Appid,
																	  @InsuranceLineCd,									                          		                             
																	  0,					--VDT DON-365 7FEB17
																	  @InsuranceLineCd,									                          		                             
																	  @LocNbr1, 
																	  @BlgNbr1,
																	  @CovSeqNbr1,
																	  @SeqNbr1, 
																	  @CovDesc1, 				
																	  0,
																	  0,
																	  null,		--VDT DON-365 7FEB17
																	  0,
																	  0,															 
																	  '',
																	  50) 
										End	
										set @SortOrder = @SortOrder + 1	
										set @Line1 = ''						  												   					                                                                                          						                             
							FETCH NEXT FROM @CursorScheduleItemNbrCov INTO @CoverageCd1, @CovItem1, @LocNbr1, @BlgNbr1, @CovSeqNbr1, @SeqNbr1
						END
					END
                -- fsit 153231 dlh 4/17/14 end														
		--TP BPCA 2010 11092012 END
		 
        INSERT INTO @BPCACoverages
		Select /*Distinct */ BO_COV_INSLINE =A.InsuranceLineCd,		--DON00061A
			BO_COV_LOCNBR = A.LocationNbr,
			BO_COV_BLDGNBR = A.BuildingNbr,
			--Pcr-66 Start
			BO_COV_CD = ISNULL((select CoverageDes 
                                from SHSeleCovDescription with (nolock) 
                                where A.CoverageCd=SHSeleCovDescription.CoverageCd 
                                      and SHSeleCovDescription.hostcd=@Host 
                                      and shselecovdescription.LineOfBusinessCd = @LOB
									  and shselecovdescription.InsuranceLineCd = @InsuranceLineCd 
									  and (shselecovdescription.statecd = '99' or shselecovdescription.statecd = @StateCd)								
								),A.CoverageCd),
            --Pcr-66 End
									 	--DON00059
            --BO_COV_CD = (
			--	  Case 
			--		   WHEN RTRIM(A.CoverageCd)  = 'WATER' THEN 'Water Backup and Sump Overflow'
			--		   ELSE
			--				ISNULL((select CoverageDes from SHSeleCovDescription with (nolock) 
            --                      where A.CoverageCd=SHSeleCovDescription.CoverageCd 
            --                              and SHSeleCovDescription.hostcd=@Host
            --                              and shselecovdescription.LineOfBusinessCd = @LOB
			--							  and shselecovdescription.InsuranceLineCd = @InsuranceLineCd 
			--	                          and (shselecovdescription.statecd = '99' or shselecovdescription.statecd = @State)
			--						),A.CoverageCd)
			--	  End), 
			--DON00060A Begin
			--DON00198 Begin
--FSIT 145313 start PP
--			BO_COV_LIMIT = (CASE 
--								/*DON00214 Begin WHEN RTRIM(A.CoverageCd)  = 'MONEY' AND A.TotalExposureAmt = 10000 THEN '0'
--								 WHEN RTRIM(A.CoverageCd)  = 'SIGNS' AND A.TotalExposureAmt = 8000 THEN '0' DON00214 End*/
--								 WHEN RTRIM(A.CoverageCd)  = 'BAILEE' AND BOPropertyInfo.SubTypeCd = 'DC' THEN 'Actual Loss Sustained'	--DON00236
--								 WHEN RTRIM(A.CoverageCd)  = 'BUSINC' THEN 'Actual Loss Sustained' 
--								 WHEN RTRIM(A.CoverageCd)  = 'BLKT' THEN 'Included'
--								 --WHEN RTRIM(A.CoverageCd)  = 'GLASS' THEN 'Included'		--DON00221A
--								 WHEN RTRIM(A.CoverageCd)  = 'ORDBLD' THEN 'Included' 
--								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK' THEN 'Included'
--								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK1' THEN 'Included'   --142448
--								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK2' THEN 'Included'   --142448
--								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK3' THEN 'Included'   --142448
--								 WHEN RTRIM(A.CoverageCd)  = 'SPRFLK' THEN 'Included'    --142448
--								 --LR FSIT 138588 - BOP NY 2010 - START
--								 WHEN RTRIM(A.CoverageCd) = 'BBPL' THEN CAST(@BarBeauLimit AS VARCHAR)
--								 WHEN RTRIM(A.CoverageCd) = 'OPTHR' THEN CAST(@OptHearLimit AS VARCHAR)
--								 WHEN RTRIM(A.CoverageCd) = 'PRINT' THEN CAST(@PrinterLimit AS VARCHAR)
--								 WHEN RTRIM(A.CoverageCd) = 'PHARM' THEN CAST(@PharmLimit AS VARCHAR)
--
--								 WHEN RTRIM(A.CoverageCd) = 'BUSINE' THEN CAST(@IncomeExtDays AS VARCHAR) --Extended Period
--								 WHEN RTRIM(A.CoverageCd) = 'BUSINP' THEN CAST(@IncomePayDays AS VARCHAR) --Ordinary Payroll
--								 WHEN RTRIM(A.CoverageCd) = 'AUTO' THEN CAST(@AutoIncrease AS VARCHAR) --Automatic Increase
--								 WHEN RTRIM(A.CoverageCd) IN ('CONTR','FOOD') THEN ''
--								 WHEN RTRIM(A.CoverageCd) = 'ADDINS' THEN '' --fist 139938
--								 --LR FSIT 138588 - BOP NY 2010 - END
--							ELSE CAST(A.TotalExposureAmt AS VARCHAR) END),
--			--DON00060A End
--			--DON00198 End
--			--DON00247A Begins Here
--			--BO_COVDED_LIMIT = A.DeductibleAmt , /* Case 14599 */
--			--LR FSIT 138588 - BOP NY 2010 - START
--			BO_COVDED_LIMIT = (CASE
--								WHEN RTRIM(A.CoverageCd)  = 'BUSINC' THEN ''
--								WHEN RTRIM(A.CoverageCd) IN ('ADDLES', 'ADDMGR', 'PHARM', 'POOL') THEN '500'
--								ELSE A.DeductibleAmt END),       
			--	BO_COVDED_LIMIT = (CASE
			--						WHEN RTRIM(A.CoverageCd)  = 'BUSINC' THEN ''
			--						ELSE A.DeductibleAmt END),
				--LR FSIT 138588 - BOP NY 2010 - END
			--
			--DON00247A Ends Here
			BO_COV_LIMIT = (CASE 
								WHEN RTRIM(A.CoverageCd)  = 'BAILEE' AND BOPropertyInfo.SubTypeCd = 'DC' THEN 'Actual Loss Sustained'	--DON00236
								 WHEN RTRIM(A.CoverageCd)  = 'BUSINC' THEN 'Actual Loss Sustained' 
								 WHEN RTRIM(A.CoverageCd)  = 'BLKT' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'ORDBLD' THEN 'Included' 
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK' THEN 'Included'
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK1' THEN 'Included'   --142448
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK2' THEN 'Included'   --142448
								 WHEN RTRIM(A.CoverageCd)  = 'SYSBRK3' THEN 'Included'   --142448
								 WHEN RTRIM(A.CoverageCd)  = 'SPRFLK' THEN 'Included'    --142448
								 WHEN RTRIM(A.CoverageCd) = 'BBPL' THEN 
								 --CAST(@BarBeauLimit AS VARCHAR)
								 CAST ((SELECT TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
														Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
														Else 0 
													  End
														--TL BOP NY 2010, FSIT 139573 Ends
											FROM SHSeleCovParms AS F 
															LEFT JOIN SHCoverageDetailItems AS C ON
																C.AppId = @AppId 
																AND C.LocationNbr = A.LocationNbr
																AND C.BuildingNbr = A.BuildingNbr 	
																AND F.LineOfBusinessCd = C.LineOfBusinessCd 
																AND F.InsuranceLineCd = C.InsuranceLineCd 
																AND F.CoverageCd = C.CoverageCd 
																AND C.CoverageSequenceNbr = 1 
																AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
															AND F.LocationId IN ('99', @LocationId) 
															AND F.MasterCompanyId IN ('99', @MasterCompanyId) 
															AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
															AND F.StateCd IN ('99' , @StateCd)	
															AND F.LineOfBusinessCd = @LOB 
															AND F.InsuranceLineCd  = @InsuranceLineCd 	
															AND RTRIM(F.CoverageCd) = 'BBPL' 
															AND CoverageParmSeqNbr = 10) AS VARCHAR)	
								 WHEN RTRIM(A.CoverageCd) = 'OPTHR' THEN 
								 --CAST(@OptHearLimit AS VARCHAR)
								 CAST ((SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
																		Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
																		Else 0 
																	  End
														--TL BOP NY 2010, FSIT 139573 Ends
														FROM SHSeleCovParms AS F 
															LEFT JOIN SHCoverageDetailItems AS C ON
																C.AppId = @AppId
																AND C.LocationNbr = A.LocationNbr
													            AND C.BuildingNbr = A.BuildingNbr		
																AND F.LineOfBusinessCd = C.LineOfBusinessCd 
																AND F.InsuranceLineCd = C.InsuranceLineCd 
																AND F.CoverageCd = C.CoverageCd 
																AND C.CoverageSequenceNbr = 1 
																AND F.CoverageParmFieldId = C.FieldNameTxt				
														WHERE F.HostCd = 'PT'
															AND F.LocationId IN ('99', @LocationId) 
															AND F.MasterCompanyId IN ('99', @MasterCompanyId)
															AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
															AND F.StateCd IN ('99' , @StateCd) 	
															AND F.LineOfBusinessCd = @LOB 
															AND F.InsuranceLineCd  = @InsuranceLineCd 	
															AND RTRIM(F.CoverageCd) = 'OPTHR'
															AND CoverageParmSeqNbr = 10) AS VARCHAR)	
								 WHEN RTRIM(A.CoverageCd) = 'PRINT' THEN 
								 --CAST(@PrinterLimit AS VARCHAR)
								 CAST ((SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
														Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
														Else 0 
													  End
										--TL BOP NY 2010, FSIT 139573 Ends
										FROM SHSeleCovParms AS F 
											LEFT JOIN SHCoverageDetailItems AS C ON
												C.AppId = @AppId
												AND C.LocationNbr = A.LocationNbr
												AND C.BuildingNbr = A.BuildingNbr		
												AND F.LineOfBusinessCd = C.LineOfBusinessCd 
												AND F.InsuranceLineCd = C.InsuranceLineCd 
												AND F.CoverageCd = C.CoverageCd 
												AND C.CoverageSequenceNbr = 1 
												AND F.CoverageParmFieldId = C.FieldNameTxt				
										WHERE F.HostCd = 'PT'
											AND F.LocationId IN ('99', @LocationId)
											AND F.MasterCompanyId IN ('99', @MasterCompanyId)
											AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
											AND F.StateCd IN ('99' , @StateCd)
											AND F.LineOfBusinessCd = @LOB
											AND F.InsuranceLineCd  = @InsuranceLineCd	
											AND RTRIM(F.CoverageCd) = 'PRINT'
											AND CoverageParmSeqNbr = 10) AS VARCHAR)
								 WHEN RTRIM(A.CoverageCd) = 'PHARM' THEN 
								 --CAST(@PharmLimit AS VARCHAR)
								 dbo.format_currency(Convert(decimal(20,0), (
											SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd
												AND RTRIM(F.CoverageCd) = 'PHARM'
												AND CoverageParmFieldId = 'PharmOccLmt'
											)))  + ' / ' + dbo.format_currency(Convert(decimal(20,0), (
											SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId) --fsit 146628 removed '' from around @LocationId dlh 11/27/12
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId)
												AND F.StateCd IN ('99' , @StateCd)
												AND F.InsuranceLineCd  = @InsuranceLineCd
												AND RTRIM(F.CoverageCd) = 'PHARM'
												AND CoverageParmFieldId = 'PharmOccLmt'
											)))
                                 WHEN RTRIM(A.CoverageCd) = 'SPKLEQ ' THEN isNull(convert(int, A.TotalExposureAmt),0) * 1000 --issue 236 11/7/12 dlh
								 WHEN RTRIM(A.CoverageCd) = 'BUSINE' THEN 
								 --CAST(isnull(@IncomeExtDays,'') AS VARCHAR) --Extended Period --TL FSIT 144547 115 10/23/2012
								 CAST ((SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr		
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1 
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId)
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd	
												AND RTRIM(F.CoverageCd) = 'BUSINE'
												AND CoverageParmSeqNbr = 10) AS VARCHAR)
								 WHEN RTRIM(A.CoverageCd) = 'BUSINP' THEN 
								 --CAST(isnull(@IncomePayDays,'') AS VARCHAR) --Ordinary Payroll--TL FSIT 144547 115 10/23/2012
								 CAST ((SELECT ISNULL(C.FieldValueTxt,0)
											FROM SHSeleCovParms AS F
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr	
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1 
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId)
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd	
												AND RTRIM(F.CoverageCd) = 'BUSINP'
												AND CoverageParmSeqNbr = 10) AS VARCHAR)	
								 WHEN RTRIM(A.CoverageCd) = 'AUTO' THEN 
								 --CAST(@AutoIncrease AS VARCHAR) --Automatic Increase
								 CAST ((SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
															Then convert(smallint, ISNULL(C.FieldValueTxt,0)) 
															Else 0 
														  End
											--TL BOP NY 2010, FSIT 139573 Ends
											FROM SHSeleCovParms AS F 
												LEFT JOIN SHCoverageDetailItems AS C ON
													C.AppId = @AppId
													AND C.LocationNbr = A.LocationNbr
													AND C.BuildingNbr = A.BuildingNbr	
													AND F.LineOfBusinessCd = C.LineOfBusinessCd 
													AND F.InsuranceLineCd = C.InsuranceLineCd 
													AND F.CoverageCd = C.CoverageCd 
													AND C.CoverageSequenceNbr = 1 
													AND F.CoverageParmFieldId = C.FieldNameTxt				
											WHERE F.HostCd = 'PT'
												AND F.LocationId IN ('99', @LocationId)
												AND F.MasterCompanyId IN ('99', @MasterCompanyId)
												AND F.PolicyCompanyId IN ('99', @PolicyCompanyId) 
												AND F.StateCd IN ('99' , @StateCd)
												AND F.LineOfBusinessCd = @LOB
												AND F.InsuranceLineCd  = @InsuranceLineCd	
												AND RTRIM(F.CoverageCd) = 'AUTO'
												AND CoverageParmSeqNbr = 10) AS VARCHAR)
--								 WHEN RTRIM(A.CoverageCd) IN ('CONTR','FOOD') THEN '' --BP CA 2010 PP 11082012 issue 264
								 WHEN RTRIM(A.CoverageCd) = 'ADDINS' THEN '' --fsit 139938								 
								 WHEN RTRIM(A.CoverageCd)  = 'EXFDSC' THEN 
								 --CAST(isnull(@FireLimit,'') AS VARCHAR) --fsit issue 114 10/23/12 dlh 
								 CAST((SELECT	TOP 1 Case IsNumeric(ISNULL(C.FieldValueTxt,0)) When 1 
													Then convert(numeric(10,0), ISNULL(C.FieldValueTxt,0)) 
													Else 0 
												  End
									--TL BOP NY 2010, FSIT 139573 Ends
									FROM	SHSeleCovParms AS F 
											LEFT JOIN SHCoverageDetailItems AS C ON
												C.AppId = @Appid 
												AND C.LocationNbr = A.LocationNbr
												AND C.BuildingNbr = A.BuildingNbr	  				
												AND RTrim(LTrim(F.LineOfBusinessCd)) = C.LineOfBusinessCd 
												AND RTrim(LTrim(F.InsuranceLineCd)) = C.InsuranceLineCd 
												AND RTrim(LTrim(F.CoverageCd)) = C.CoverageCd 
												AND RTrim(LTrim(F.CoverageParmFieldId)) = C.FieldNameTxt				
									WHERE F.HostCd = 'PT' 
										AND RTrim(LTrim(F.LocationId)) IN ('99', @LocationId) 
										AND RTrim(LTrim(F.MasterCompanyId)) IN ('99', @MCO) 
										AND RTrim(LTrim(F.PolicyCompanyId)) IN ('99', @PCO) 
										AND RTrim(LTrim(F.StateCd)) IN ('99' , @StateCd) 
										AND RTrim(LTrim(F.LineOfBusinessCd)) = @LOB 
										AND RTrim(LTrim(F.InsuranceLineCd))  = @InsuranceLineCd 		
										AND RTrim(LTrim(F.CoverageCd)) = 'EXFDSC'	
										AND CoverageParmSeqNbr = 16) AS VARCHAR)	
								 WHEN RTRIM(A.CoverageCd) = 'MONEY' THEN (
																		SELECT	TOP 1 Case IsNumeric(ISNULL(FieldValueTxt,0)) When 1 
																						Then convert(numeric(10,0), ISNULL(FieldValueTxt,0)) 
																						Else 0 
																					  End
																			From SHCoverageDetailItems 
																		WHERE HostCd = @Host
																			And Appid=@Appid	
																			AND StateCd IN ('99' , @StateCd) 	
																			AND LineOfBusinessCd = @LOB 
																			AND InsuranceLineCd  = @InsuranceLineCd 	
																			AND RTRIM(CoverageCd) = 'MONEY'
																			AND FieldNameTxt='MONEY_LimitAmt'
																			AND LocationNbr=A.LocationNbr
																			AND BuildingNbr=A.BuildingNbr
																		)--@MoneySecuritiesLimit -- BP CA 2010 issue 197 PP
								 --don-2576 begin
								 WHEN RTRIM(A.CoverageCd) = 'WTRDMG' THEN (
																		SELECT	TOP 1 Case IsNumeric(ISNULL(FieldValueTxt,0)) When 1 
																						Then convert(numeric(10,0), ISNULL(FieldValueTxt,0)) 
																						Else 0 
																					  End
																			From SHCoverageDetailItems 
																		WHERE HostCd = @Host
																			And Appid=@Appid	
																			AND StateCd IN ('99' , @StateCd) 	
																			AND LineOfBusinessCd = @LOB 
																			AND InsuranceLineCd  = @InsuranceLineCd 	
																			AND RTRIM(CoverageCd) = 'WTRDMG'
																			AND FieldNameTxt='WATER_LimitAmt'
																			AND LocationNbr=A.LocationNbr
																			AND BuildingNbr=A.BuildingNbr)
								 --don-2576 end
								 WHEN RTRIM(A.CoverageCd) = 'DAMAGE' THEN (
																		SELECT	TOP 1 Case IsNumeric(ISNULL(FieldValueTxt,0)) When 1 
																						Then convert(numeric(10,0), ISNULL(FieldValueTxt,0)) 
																						Else 0 
																					  End
																			From SHCoverageDetailItems 
																		WHERE HostCd = @Host
																			And Appid=@Appid	
																			AND StateCd IN ('99' , @StateCd) 	
																			AND LineOfBusinessCd = @LOB 
																			AND InsuranceLineCd  = @InsuranceLineCd 	
																			AND RTRIM(CoverageCd) = 'DAMAGE'
																			AND FieldNameTxt='DAMAGE_LimitAmt'
																			AND LocationNbr=A.LocationNbr
																			AND BuildingNbr=A.BuildingNbr
																		)-- BP CA 2010 issue 185 PP
							ELSE CAST(A.TotalExposureAmt AS VARCHAR) END),
			BO_COVDED_LIMIT = (CASE
								WHEN RTRIM(A.CoverageCd)  = 'BLDG' THEN ''
								WHEN RTRIM(A.CoverageCd)  = 'BPP' THEN ''
								WHEN RTRIM(A.CoverageCd)  = 'TENANT' THEN ''
								WHEN RTRIM(A.CoverageCd)  = 'BUSINC' THEN ''
								WHEN RTRIM(A.CoverageCd)  = 'BIEE' THEN ''	
								WHEN RTRIM(A.CoverageCd)  = 'EXFDSC' THEN 'N/A'	--fsit 153433 dlh 3/28/14 										
								ELSE A.DeductibleAmt END), 
--FSIT 145313 end PP
			BO_COV_PREM = cast(A.PremiumAmt as money) ,
			COV_SUM = B.PremiumAmt,
			A.CoverageCd
			,SortOrder = 0 -- fsit 153231 dlh 4/17/14
			from BORating A with (nolock) 
			inner join BORating B on B.Appid=A.Appid and B.LocationNbr=A.LocationNbr and B.BuildingNbr=A.BuildingNbr and B.CoverageCd='0'
			--DON00236 End
			INNER JOIN BOPropertyInfo ON BOPropertyInfo.AppId = A.AppId 
										AND BOPropertyInfo.LocationNbr = A.LocationNbr 
										AND BOPropertyInfo.StructureNbr = A.BuildingNbr
			--DON00236 End
			--DON00247A Begins Here
			--where A.AppId =@AppId and A.LocationNbr<>0 and A.BuildingNbr <> 0 and A.CoverageCd<>'0' order by A.InsuranceLineCd, A.LocationNbr, A.BuildingNbr; 
			--Pcr-66 Start
			Inner Join SHSeleCovDescription D On 
                       D.CoverageCd=A.CoverageCd and D.hostcd='PT'
					   and D.LineOfBusinessCd = @LOB
				       and D.InsuranceLineCd = @InsuranceLineCd 
				       and (D.statecd = '99' or D.statecd = @StateCd)
			--Pcr-66 End				
			                 
			where A.AppId =@AppId and A.LocationNbr<>0 and A.BuildingNbr <> 0 and A.CoverageCd <> '0' and A.CoverageCd <> 'LIAB'	--TP BPCA 2010 275 11132012
			--where A.AppId =@AppId and A.LocationNbr<>0 and A.BuildingNbr <> 0 and A.CoverageCd <> '0'								--TP BPCA 2010 275 11132012
            --order by A.InsuranceLineCd, A.LocationNbr, A.BuildingNbr, D.DisplaySeq; 
			--DON00247A Ends Here
			
			--TP BPCA 2010 11092012 START
			-- For Brands and Labels Coverage 
			-- fsit 153231 dlh 4/17/14 start
			UNION ALL 
			Select Distinct
			A.BO_COV_INSLINE , 
			A.BO_COV_LOCNBR ,
			A.BO_COV_BLDGNBR,							
			A.BO_COV_CD  ,
			A.BO_COV_LIMIT ,			
			A.BO_COVDED_LIMIT ,
			A.BO_COV_PREM,
			A.COV_SUM,
			A.CoverageCd,
		    A.SortOrder 
			from 
				@TempTableCov A	
				Join BORating B on B.Appid = A.Appid and B.LocationNbr = A.BO_COV_LOCNBR and B.BuildingNbr = A.BO_COV_BLDGNBR and B.CoverageCd = 'ADDLUN'
			-- fsit 153231 dlh 4/17/14 end					
			--UNION ALL					--dale FSIT 156786
			insert into @BPCACoverages	--dale FSIT 156786
			Select Distinct
			BO_COV_INSLINE = 'CBP', 
			BO_COV_LOCNBR = A.LocationNbr,
			BO_COV_BLDGNBR = A.StructureNbr,			
			BO_COV_CD = 'Brands and Labels' ,
			BO_COV_LIMIT = 'Included',			
			BO_COVDED_LIMIT = '0',
			BO_COV_PREM = 0,
			COV_SUM = 0,
			CoverageCd = 'R'
			,SortOrder = 0 -- fsit 153231 dlh 4/17/14 
			FROM 
				 BOPropertyInfo A				 					
				 INNER JOIN BORating B ON B.Appid = A.Appid and B.LocationNbr = A.LocationNbr and B.BuildingNbr = A.StructureNbr
			Where 
				A.Appid = @Appid 
                AND A.EmploymentLiabilityInd = 1 
			    AND A.LocationNbr<>0 
				AND A.StructureNbr <> 0 
				AND B.CoverageCd<>'0' 
			
			--For Building Glass	
			--UNION ALL					--dale FSIT 156786
			insert into @BPCACoverages  --dale FSIT 156786
			Select Distinct
			BO_COV_INSLINE = 'CBP', 
			BO_COV_LOCNBR = A.LocationNbr,
			BO_COV_BLDGNBR = A.StructureNbr,			
			BO_COV_CD = 'Building Glass' ,
			BO_COV_LIMIT = 'Included',			
			BO_COVDED_LIMIT = A.LiabDeductType,
			BO_COV_PREM = 0,
			COV_SUM = 0,
			CoverageCd = 'R'
			,SortOrder = 0 -- fsit 153231 dlh 4/17/14 
			FROM 
				 BOPropertyInfo A				 					
				 INNER JOIN BORating B ON B.Appid = A.Appid and B.LocationNbr = A.LocationNbr and B.BuildingNbr = A.StructureNbr
			Where 
				A.Appid = @Appid 
                AND A.LiabDeductType <> ''
			    AND A.LocationNbr<>0 
				AND A.StructureNbr <> 0 
				AND B.CoverageCd<>'0' 							
			--TP BPCA 2010 11092012 END
			-- fsit 153231 dlh 4/17/14 start
		Select * From @BPCACoverages 		
		Order by Bo_Cov_Locnbr, Bo_Cov_Bldgnbr, SortOrder, COV_SUM, BO_COV_PREM
		-- fsit 153231 dlh 4/17/14 end
		--Order by Bo_Cov_Locnbr, Bo_Cov_Bldgnbr, 		--TP BPCA 2010 11132012 274
	END
--LR BOP NY 2010 - END - 8/24/2011
--TL FSIT 139938 Starts
--fsit 141347 start
DECLARE @tempTable Table(
    ADDINT_LOCNBR int,
    ADDINT_BLDGNBR int,
    ADDINT_INTNBR int,
    ADDINT_TYPE varchar(30),
	ADDINT_NAME varchar(30),
	ADDINT_DBA_NAME varchar(30),
	ADDINT_ADDRESS1 varchar(50),
	ADDINT_ADDRESS2 varchar(50),
	ADDINT_CSZ varchar(100)
	,ADDINT_LOANNUMBER varchar(25) -- fsit 153231 dlh 4/17/14 
);
declare @LineOfBusinessCd VARCHAR(2)
DECLARE @LocNbr INTEGER
Declare @BlgNbr INTEGER
Declare @SeqNbr INTEGER
Declare @CovSeqNbr INTEGER
declare	@ADD_NAME varchar(30)
declare	@ADD_OPT varchar(30)
declare	@ADD_ADDRESS1 varchar(50)
declare	@ADD_CITY varchar(50)
declare	@ADD_STATE varchar(2)
declare	@ADD_ZIP varchar(10)
--fsit 141347 end
DECLARE @CursorScheduleItemNbr AS CURSOR
set @LineOfBusinessCD = (Select LineOfBusiness from shplaninfo where appid = @AppId)
SET @CursorScheduleItemNbr = CURSOR FORWARD_ONLY STATIC READ_ONLY FOR 
	Select distinct LocationNbr, BuildingNbr, CoverageSequenceNbr, ScheduleItemSeqNbr from SHCoverageScheduleItems
	--Where AppId=@AppId
	Where AppId=@AppId And CoverageCd='ADDINS' and InsuranceLineCd <> 'NBP'	--TP 143354, fix tech error in app print --VDT DON-365 16FEB17
	Group by LocationNbr, BuildingNbr, CoverageSequenceNbr, ScheduleItemSeqNbr
--TP BOP NY 2010, Add Additional Insured Cov END
	--Open Cursor fsit 165022 start
	OPEN @CursorScheduleItemNbr
	IF @@CURSOR_ROWS > 0			
		BEGIN
			FETCH NEXT FROM @CursorScheduleItemNbr INTO @LocNbr, @BlgNbr, @CovSeqNbr, @SeqNbr
			WHILE @@FETCH_STATUS = 0
				BEGIN	
						Select Top 1 @ADD_NAME = FieldValueTxt from SHCoverageScheduleItems
						 Where AppId=@AppId and FieldNameTxt='Description1' 
							  And LocationNbr = @LocNbr
						      And BuildingNbr = @BlgNbr
							  And LineOfBusinessCd=@LineOfBusinessCd 
							  And InsuranceLineCd=@InsuranceLineCd
							  And ScheduleItemSeqNbr=@SeqNbr
							  And CoverageSequenceNbr=@CovSeqNbr
							  And CoverageCd='ADDINS'
						Select Top 1 @ADD_OPT = FieldValueTxt from SHCoverageScheduleItems
						 Where AppId=@AppId and FieldNameTxt='Description2' 
							  And LocationNbr = @LocNbr
						      And BuildingNbr = @BlgNbr
							  And LineOfBusinessCd=@LineOfBusinessCd 
							  And InsuranceLineCd=@InsuranceLineCd
							  And ScheduleItemSeqNbr=@SeqNbr
							  And CoverageSequenceNbr=@CovSeqNbr
							  And CoverageCd='ADDINS'
						Select Top 1 @ADD_ADDRESS1 = FieldValueTxt from SHCoverageScheduleItems
						 Where AppId=@AppId and FieldNameTxt='Description3' 
							 And LocationNbr = @LocNbr
						     And BuildingNbr = @BlgNbr
							 And LineOfBusinessCd=@LineOfBusinessCd 
							 And InsuranceLineCd=@InsuranceLineCd 
							 And ScheduleItemSeqNbr=@SeqNbr
							 And CoverageSequenceNbr=@CovSeqNbr
							 And CoverageCd='ADDINS'
						Select Top 1 @ADD_CITY = FieldValueTxt from SHCoverageScheduleItems
						 Where AppId=@AppId and FieldNameTxt='Description4'
							 And LocationNbr = @LocNbr
						     And BuildingNbr = @BlgNbr
							 And LineOfBusinessCd=@LineOfBusinessCd 
							 And InsuranceLineCd=@InsuranceLineCd
                             And ScheduleItemSeqNbr=@SeqNbr  
						     And CoverageSequenceNbr=@CovSeqNbr
							 And CoverageCd='ADDINS'
						Select Top 1 @ADD_STATE = FieldValueTxt from SHCoverageScheduleItems
						 Where AppId=@AppId and FieldNameTxt='Description5'
							 And LocationNbr = @LocNbr
						     And BuildingNbr = @BlgNbr 
							 And LineOfBusinessCd=@LineOfBusinessCd 
							 And InsuranceLineCd=@InsuranceLineCd
							 And ScheduleItemSeqNbr=@SeqNbr  
							 And CoverageSequenceNbr=@CovSeqNbr
							 And CoverageCd='ADDINS'
						Select Top 1 @ADD_ZIP = FieldValueTxt from SHCoverageScheduleItems
						 Where AppId=@AppId and FieldNameTxt='Description6'
							 And LocationNbr = @LocNbr
						     And BuildingNbr = @BlgNbr 
							 And LineOfBusinessCd=@LineOfBusinessCd 
							 And InsuranceLineCd=@InsuranceLineCd 
							 And ScheduleItemSeqNbr=@SeqNbr 
							 And CoverageSequenceNbr=@CovSeqNbr		
							 And CoverageCd='ADDINS'
					    --fsit 140635
                                            if @ADD_ADDRESS1 is NUll 
					       set @ADD_ADDRESS1 = ' '
					    if @ADD_CITY is null 
					       set @ADD_CITY = ' '
					    if @ADD_STATE is NULL 
					       set @ADD_STATE = ' '
					    if @ADD_ZIP is NULL
					       set @ADD_ZIP = ' '
					    --fsit 140635
					    					                                 
						Insert into @tempTable values(@LocNbr, @BlgNbr, @CovSeqNbr, 'Additional Insured', @ADD_NAME, @ADD_OPT, @ADD_ADDRESS1,'', @ADD_CITY + ', ' + @ADD_STATE + ', ' + @ADD_ZIP,' ') -- fsit 153231 154568 dlh 4/17/14 
					FETCH NEXT FROM @CursorScheduleItemNbr INTO @LocNbr, @BlgNbr, @CovSeqNbr, @SeqNbr
				END
		END
--TL FSIT 139938 Ends
Select 
	ADDINT_LOCNBR = SHClientAddress.LocationNumber,
	ADDINT_BLDGNBR = SHClientAddress.UnitNumber,
	ADDINT_INTNBR = SHClient.ClientNumber,
	ADDINT_TYPE = (Select Distinct Description from SHSeleInterestType with (nolock) where Host = @Host and 	
						 (LocationId = @LOC or LocationId = '99') and 
						 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
						 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and 
						 --(LOB = 'BO' or LOB = '999') and --TL BOP NY 2010
                         (LOB = @LOB or LOB = '999') and --TL BOP NY 2010
						 Code = SHClient.InterestType),
	ADDINT_NAME= SHClient.LongName,
	ADDINT_DBA_NAME = SHClient.DBAName, 
 	ADDINT_ADDRESS1= SHClientAddress.Address1,
	ADDINT_ADDRESS2= SHClientAddress.Address2,
	ADDINT_CSZ = (SHClientAddress.City + ', ' + SHClientAddress.State + ',' + SHClientAddress.Zip)
	,ADDINT_LOANNUMBER = isnull(SHClientAddress.LoanNumber, ' ') -- fsit 153231 154568 dlh 4/17/14 
 From SHClient with (nolock) 
 	Left Join SHClientAddress on SHClientAddress.AppId=@AppId and SHClientAddress.LocationNumber=SHClient.LocationNumber 
 and SHClientAddress.UnitNumber = SHClient.UnitNumber and SHClientAddress.ClientNumber = SHClient.ClientNumber
Where SHClient.AppId=@AppId 
      and SHClient.ClientNumber <> 0 
      and (rtrim(SHClient.InterestType) <> 'XX' or rtrim(SHClient.InterestType) <> 'A0') 
      and rtrim(SHClient.LongName) <> '' --fsit 193938
--TL FSIT 139938 Starts
--Order By SHClient.LocationNumber, SHClient.UnitNumber, SHClient.ClientNumber
Union All
Select * from @tempTable
--TL FSIT 139938 Ends
---------------------------------------------------------------------------------------------------------
----FSIT 124766 starts for statements
--select STMT_RESPONSE = SHRemarks.ResponseInd,
-- STMT_NUMBER = SHRemarks.QuestionCd,
-- STMT_REMARKS = SHRemarks.RemarksTxt,
-- STMT_QUESTION = SHSeleQuestions.Questiontxt
--from SHRemarks with (nolock) 
--left join SHSeleQuestions on SHSeleQuestions.HostCd = @host and 
--		 (SHSeleQuestions.LocationId = @LOC or LocationId = '99') and 
--		(SHSeleQuestions.MasterCompanyId = @MCO OR MasterCompanyId = '99') and
--		(SHSeleQuestions.PolicyCompanyId = @PCO OR PolicyCompanyId = '99')and
--		(SHSeleQuestions.stateCd = @stateCd or StateCd = '99') and
--		SHSeleQuestions.transactionCd = 'NBS' and 
--		(SHSeleQuestions.LineofBusinessCd = 'BO' or LineOfBusinessCd = '999') and 
--		(SHSeleQuestions.PolicySymbolCd = '999' or SHSeleQuestions.PolicySymbolCd = '') and 
--		SHSeleQuestions.InsuranceLineCd = 'BOP' and 
--		SHSeleQuestions.QuestionCd = SHRemarks.QuestionCd 
--where SHRemarks.AppId = @AppId order by SHSeleQuestions.SortOrder; 
--DON00061 Begin
/*select 
STMT_UNITNBR = SHSeleStatementUnit.UnitNbr,
STMT_FIELD = isnull(SHRemarksDetail.QuestionItemFieldTxt,''),
STMT_REMARKS = isnull(SHRemarksDetail.QuestionItemFieldValueTxt,''),
STMT_PRTUNITNBR = SHSeleStatementUnit.ParentUnitNbr,
STMT_RESPONSE = SHRemarks.ResponseInd,
STMT_NUMBER = SHSeleQuestions.QuestionNbr,
STMT_QUESTION = SHSeleQuestions.Questiontxt
from SHRemarks with (nolock) 
 left outer join SHSeleQuestions on SHSeleQuestions.HostCd = @Host and 
		(SHSeleQuestions.LocationId = '99' ) and 
		(SHSeleQuestions.MasterCompanyId = '99' ) and
		(SHSeleQuestions.PolicyCompanyId = '99' )and
		(SHSeleQuestions.stateCd = '99') and
		SHSeleQuestions.transactionCd = 'NBS' and 
		(SHSeleQuestions.LineofBusinessCd = 'BO') and 
		SHSeleQuestions.InsuranceLineCd = 'BOP' and 
        SHSeleQuestions.UnitNbr = 'BOPL'and
		SHSeleQuestions.QuestionCd = SHRemarks.QuestionCd 
        left outer join SHSeleStatementUnit on SHSeleStatementUnit.UnitNbr = SHRemarks.UnitNbr
        and SHSeleStatementUnit.HostCd = @Host
        and  SHSeleStatementUnit.UnitNbr is not null
        left outer join SHRemarksDetail on SHRemarksDetail.UnitNbr = SHRemarks.UnitNbr
        and SHRemarksDetail.QuestionCd = SHRemarks.QuestionCd
        and SHRemarksDetail.Appid =@AppId
        where SHRemarks.AppId = @AppId and SHSeleStatementUnit.UnitNbr <>''
        order by SHSeleQuestions.SortOrder*/
--TL FSIT 146716 Starts Separate logic for 2 states
If ((@LOB='BO' or @LOB='BP') and @StateCd='CA')
Begin
SELECT STMT_UNITNBR = SHSeleStatementUnit.UnitNbr
		, STMT_FIELD = isnull(SHRemarksDetail.QuestionItemFieldTxt,'')
		--fsit 139770 start
		, STMT_REMARKS = (Case 
			WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '' then ''
			WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '1' then 'Yes'
			WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '0' then 'No' 
			Else
				isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'')
		    End)		
		--, STMT_REMARKS = isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'')
		--fsit 139770 end
		, STMT_PRTUNITNBR = SHSeleStatementUnit.ParentUnitNbr
		, STMT_RESPONSE = SHRemarks.ResponseInd
		, STMT_NUMBER = 'Q' + CAST(ROW_NUMBER() OVER(ORDER BY SHSeleStatementUnit.SortOrder, SHSeleQuestions.SortOrder) AS VARCHAR) --AS 'QuestionNbr'--SHSeleQuestions.QuestionNbr
		, STMT_QUESTION = SHSeleQuestions.Questiontxt
		, SHSeleStatementUnit.UnitDesc
		, SHSeleStatementUnit.SortOrder
		, SHSeleQuestions.SortOrder		
FROM SHRemarks WITH (NOLOCK) 
	LEFT OUTER JOIN SHSeleQuestions ON 
		SHSeleQuestions.HostCd = @Host
		AND SHSeleQuestions.LocationId IN ('99', @LOC)
		AND SHSeleQuestions.MasterCompanyId IN ('99', @MCO)
		AND SHSeleQuestions.PolicyCompanyId IN ('99', @PCO)
		AND SHSeleQuestions.stateCd IN ('99', @StateCd)
		AND SHSeleQuestions.transactionCd = 'NBS'
		AND SHSeleQuestions.LineofBusinessCd = @LOB
		--AND SHSeleQuestions.InsuranceLineCd = 'BOP'   --TL BOP NY 2010
        AND SHSeleQuestions.InsuranceLineCd = @InsuranceLineCd   --TL BOP NY 2010
        AND SHSeleQuestions.UnitNbr = SHRemarks.unitnbr
		AND SHSeleQuestions.QuestionCd = SHRemarks.QuestionCd 
	INNER JOIN SHSeleStatementUnit ON 
		SHSeleStatementUnit.UnitNbr = SHRemarks.UnitNbr
        AND SHSeleStatementUnit.HostCd = @Host
        AND SHSeleStatementUnit.LineOfBusinessCd = @LOB --TL BOP NY 2010
        AND SHSeleStatementUnit.UnitNbr IS NOT NULL
	INNER JOIN SHRemarksDetail ON 
		SHRemarksDetail.UnitNbr = SHRemarks.UnitNbr
        AND SHRemarksDetail.QuestionCd = SHRemarks.QuestionCd
        AND SHRemarksDetail.Appid = @AppId
WHERE SHRemarks.AppId = @AppId
	AND SHSeleStatementUnit.UnitNbr <> ''
	AND SHRemarks.UnitNbr LIKE 'BO%'
	AND len(SHSeleQuestions.Questiontxt) > 0 --FSIT 145313 PP
UNION ALL
SELECT STMT_UNITNBR = SHSeleStatementUnit.UnitNbr
		, STMT_FIELD = isnull(SHRemarksDetail.QuestionItemFieldTxt,'')
		--fsit 139770 start
		, STMT_REMARKS = (Case 
			WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '' then ''
			WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '1' then 'Yes'
			WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '0' then 'No' 
			Else
				isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'')
		    End)		
		--, STMT_REMARKS = isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'')
		--fsit 139770 end
		, STMT_PRTUNITNBR = SHSeleStatementUnit.ParentUnitNbr
		, STMT_RESPONSE = (CASE SHSeleQuestions.HideYesNoInd WHEN 1 THEN '' ELSE SHRemarks.ResponseInd END)		--DON0061D - Do not display Yes/No if HideYesNoInd = 1
		, STMT_NUMBER = SHSeleQuestions.QuestionNbr
		, STMT_QUESTION = SHSeleQuestions.Questiontxt
		, SHSeleStatementUnit.UnitDesc
		, SHSeleStatementUnit.SortOrder
		, SHSeleQuestions.SortOrder
FROM SHRemarks WITH (NOLOCK) 
	LEFT OUTER JOIN SHSeleQuestions ON 
		SHSeleQuestions.HostCd = @Host
		AND SHSeleQuestions.LocationId IN ('99', @LOC)
		AND SHSeleQuestions.MasterCompanyId IN ('99', @MCO)
		AND SHSeleQuestions.PolicyCompanyId IN ('99', @PCO)
		AND SHSeleQuestions.stateCd IN ('99', @StateCd)
		AND SHSeleQuestions.transactionCd = 'NBS'
		AND SHSeleQuestions.LineofBusinessCd = @LOB
		--AND SHSeleQuestions.InsuranceLineCd = 'BOP'   --TL BOP NY 2010
        AND SHSeleQuestions.InsuranceLineCd = @InsuranceLineCd   --TL BOP NY 2010
        AND SHSeleQuestions.UnitNbr = SHRemarks.unitnbr
		AND SHSeleQuestions.QuestionCd = SHRemarks.QuestionCd 
	INNER JOIN SHSeleStatementUnit ON 
		SHSeleStatementUnit.UnitNbr = SHRemarks.UnitNbr
        AND SHSeleStatementUnit.HostCd = @Host
        AND SHSeleStatementUnit.LineOfBusinessCd = @LOB --TL BOP NY 2010
        AND SHSeleStatementUnit.UnitNbr IS NOT NULL
	INNER JOIN SHRemarksDetail ON 
		SHRemarksDetail.UnitNbr = SHRemarks.UnitNbr
        AND SHRemarksDetail.QuestionCd = SHRemarks.QuestionCd
        AND SHRemarksDetail.Appid = @AppId
WHERE SHRemarks.AppId = @AppId
	AND SHSeleStatementUnit.UnitNbr <> ''
	AND SHRemarks.UnitNbr NOT LIKE 'BO%'
	AND len(SHSeleQuestions.Questiontxt) > 0 --FSIT 145313 PP
ORDER BY SHSeleStatementUnit.SortOrder, SHSeleQuestions.SortOrder
end
Else If @LOB='BP' and @StateCd='NY'
	Begin
		DECLARE @temptable1 TABLE (LineOfBusinessCd VARCHAR(3)
							, InsuranceLineCd VARCHAR(3)
							, UnitNbr VARCHAR(12)
							, QuestionCd CHAR(4)
							, QuestionNbr CHAR(4)
							, QuestionTxt VARCHAR(500) 
							, SortOrder SMALLINT
							, ResponseInd CHAR(1)
							, ResponseReqInd CHAR(1)
							, RemarksReqInd CHAR(1)
							, HideYesNoInd BIT
							, AmendXActStat CHAR(1)
							, HideNbrInd CHAR(1)     --DON00050 Removed closing bracket
							, RemarksReqCondition CHAR(1))   --DON00050
		INSERT INTO @temptable1 (LineOfBusinessCd
							, InsuranceLineCd
							, UnitNbr
							, QuestionCd
							, QuestionNbr
							, QuestionTxt
							, SortOrder
							, ResponseInd
							, ResponseReqInd
							, RemarksReqInd
							, HideYesNoInd
							, AmendXActStat
							, HideNbrInd      --DON00050 Removed closing bracket
							, RemarksReqCondition)   --DON00050
		SELECT A.LineOfBusinessCd
				, ISNULL(A.InsuranceLineCd,'') AS InsuranceLineCd
				, A.UnitNbr
				, RTRIM(A.QuestionCd) AS QuestionCd
				, RTRIM(B.QuestionNbr) AS QuestionNbr
				, REPLACE(QuestionTxt, '&#39;','''') AS QuestionTxt     --TL BOP NY 2010, TP add AS QuestionTxt
				, SortOrder
				, ISNULL(ResponseInd, '') As ResponseInd
				, ResponseReqInd
				, RemarksReqInd
				, B.HideYesNoInd
				, AmendXActStat = A.ActivityStatusCd
				, ISNULL(B.HideNbrInd, '0') AS HideNbrInd 
				, ISNULL(B.RemarksReqCondition, '') AS RemarksReqCondition   --DON00050
			FROM SHRemarks A WITH (NOLOCK) INNER JOIN  SHSeleQuestions B WITH (NOLOCK)       
				ON  A.LineofBusinessCd = B.LineOfBusinessCD  
				AND isnull(A.InsuranceLineCD,'') = isnull(B.InsuranceLineCD,'')  
				AND A.UnitNbr = B.UnitNbr  
				AND A.QuestionCd = B.QuestionCd   
			WHERE  
				B.HostCD = @Host  
				AND (B.LocationId = @LocationId or B.LocationId = '99')  
				AND (B.MasterCompanyId = @MasterCompanyId or B.MasterCompanyId='99')  
				AND (B.PolicyCompanyId =@PolicyCompanyId or B.PolicyCompanyId = '99')  
				AND (B.StateCd = @StateCd or B.StateCd = '99')  
				AND B.TransactionCd = 'NBS'  	  
				AND A.Appid = @AppId
				AND A.LineOfBusinessCd = @LOB
				AND RTRIM(ISNULL(A.InsuranceLineCd,'')) = RTRIM(@InsuranceLineCd)  
				AND ActivityMaximumRecordNbr =   
				(SELECT MAX(ActivityMaximumRecordNbr) FROM SHRemarks with (nolock)
					 WHERE SHRemarks.AppId = @AppId AND SHRemarks.QuestionCd = B.QuestionCd)                                     
			ORDER BY SortOrder , QuestionCd
					DECLARE @questionsTable TABLE (LineOfBusinessCd VARCHAR(3), InsuranceLineCd VARCHAR(3), UnitNbr VARCHAR(12), QuestionCd CHAR(4), QuestionNbr CHAR(4), QuestionTxt VARCHAR(500) 
							, SortOrder SMALLINT, ResponseInd CHAR(1), ResponseReqInd CHAR(1), RemarksReqInd CHAR(1), HideYesNoInd BIT, AmendXActStat CHAR(1), HideNbrInd CHAR(1), SortOrder2 SMALLINT, RemarksReqCondition CHAR(1))
					INSERT INTO @questionsTable (LineOfBusinessCd, InsuranceLineCd, UnitNbr, QuestionCd, QuestionNbr, QuestionTxt, SortOrder, ResponseInd, ResponseReqInd, RemarksReqInd
							, HideYesNoInd, AmendXActStat, HideNbrInd, SortOrder2, RemarksReqCondition)
					SELECT T.LineOfBusinessCd, T.InsuranceLineCd, T.UnitNbr, QuestionCd
    				, 'Q' + CAST(ROW_NUMBER() OVER(ORDER BY A.SortOrder, T.SortOrder) AS VARCHAR) AS 'QuestionNbr'
    				, REPLACE(QuestionTxt, '&#39;','''')  AS QuestionTxt  --TL BOP NY 2010, TP Add QuestionTxt
					, T.SortOrder, ResponseInd, ResponseReqInd, RemarksReqInd
    				, HideYesNoInd, AmendXActStat, HideNbrInd, A.SortOrder, T.RemarksReqCondition   --DON00050 Added RemarksReqCondition
    				FROM @temptable1 T, SHSeleStatementUnit A
    				WHERE A.HostCD = @Host 
    				AND (A.LocationId = @LocationId or A.LocationId = '99')  
    				AND (A.MasterCompanyId = @MasterCompanyId or A.MasterCompanyId='99')  
    				AND (A.PolicyCompanyId =@PolicyCompanyId or A.PolicyCompanyId = '99')  
    				AND (A.StateCd = @StateCd or A.StateCd = '99')  
    				AND TransactionCd = 'NBS' 
    				AND A.LineofBusinessCd = @LOB
    				AND RTRIM(ISNULL(A.InsuranceLineCd,'')) = RTRIM(@InsuranceLineCd)  
    				AND A.UnitNbr = T.UnitNbr 
    				AND T.UnitNbr LIKE 'BP%'
					AND T.QuestionNbr <> ''	         
    				UNION ALL
					SELECT T.LineOfBusinessCd, T.InsuranceLineCd, T.UnitNbr, QuestionCd
    				, QuestionNbr
    				, REPLACE(QuestionTxt, '&#39;','''') AS QuestionTxt  --TL BOP NY 2010, TP Add QuestionTxt
					, T.SortOrder, ResponseInd, ResponseReqInd, RemarksReqInd
    				, HideYesNoInd, AmendXActStat, HideNbrInd, A.SortOrder, T.RemarksReqCondition   --DON00050 Added RemarksReqCondition
    				FROM @temptable1 T, SHSeleStatementUnit A
    				WHERE A.HostCD = @Host
    				AND (A.LocationId = @LocationId or A.LocationId = '99')  
    				AND (A.MasterCompanyId = @MasterCompanyId or A.MasterCompanyId='99')  
    				AND (A.PolicyCompanyId =@PolicyCompanyId or A.PolicyCompanyId = '99')  
    				AND (A.StateCd = @StateCd or A.StateCd = '99')  
    				AND TransactionCd = 'NBS'
    				AND A.LineofBusinessCd = @LOB
    				AND RTRIM(ISNULL(A.InsuranceLineCd,'')) = RTRIM(@InsuranceLineCd)  
    				AND A.UnitNbr = T.UnitNbr 
    				AND T.UnitNbr LIKE 'BP%'
					AND T.QuestionNbr = ''         
    				UNION ALL
    				SELECT T.LineOfBusinessCd, T.InsuranceLineCd, T.UnitNbr, QuestionCd
    				, QuestionNbr
    				, REPLACE(QuestionTxt, '&#39;','''') As QuestionTxt   --TL BOP NY 2010, TP add QuestionTxt
					, T.SortOrder, ResponseInd, ResponseReqInd, RemarksReqInd
    				, HideYesNoInd, AmendXActStat, HideNbrInd, A.SortOrder, T.RemarksReqCondition   --DON00050 Added RemarksReqCondition 
    				FROM @temptable1 T, SHSeleStatementUnit A
    				WHERE A.HostCD = @Host
    				AND (A.LocationId = @LocationId or A.LocationId = '99')  
    				AND (A.MasterCompanyId = @MasterCompanyId or A.MasterCompanyId='99')  
    				AND (A.PolicyCompanyId =@PolicyCompanyId or A.PolicyCompanyId = '99')  
    				AND (A.StateCd = @StateCd or A.StateCd = '99')  
    				AND TransactionCd = 'NBS'
    				AND A.LineofBusinessCd = @LOB
    				AND RTRIM(ISNULL(A.InsuranceLineCd,'')) = RTRIM(@InsuranceLineCd)  
    				AND A.UnitNbr = T.UnitNbr 
    				AND T.UnitNbr NOT LIKE 'BP%'         
    				ORDER BY A.SortOrder, T.SortOrder, QuestionCd
	select STMT_UNITNBR = q.UnitNbr
	, STMT_FIELD = isnull(SHRemarksDetail.QuestionItemFieldTxt,'')
	, STMT_REMARKS = (Case 
				WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '' then ''
				WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '1' then 'Yes'
				WHEN isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'') = '0' then 'No' 
				Else
					isnull(SHRemarksDetail.QuestionItemFieldValueTxt,'')
				End)	
	, STMT_PRTUNITNBR = ''
	, STMT_RESPONSE = q.ResponseInd
	, STMT_NUMBER = q.QuestionNbr
	, STMT_QUESTION = q.Questiontxt
	, SHSeleStatementUnit.UnitDesc
	, SHSeleStatementUnit.SortOrder
	, q.SortOrder		
	from @questionsTable q
		INNER JOIN SHSeleStatementUnit ON 
			SHSeleStatementUnit.UnitNbr = q.UnitNbr
			AND SHSeleStatementUnit.HostCd = @Host
			AND SHSeleStatementUnit.LineOfBusinessCd = @LOB --TL BOP NY 2010
			AND SHSeleStatementUnit.UnitNbr IS NOT NULL
			AND Statecd=@StateCd
		LEFT JOIN SHRemarksDetail ON						--TL FSIT 149288
			SHRemarksDetail.UnitNbr = q.UnitNbr
			AND SHRemarksDetail.QuestionCd = q.QuestionCd
			AND SHRemarksDetail.Appid = @AppId
	Order by q.SortOrder
End
--TL FSIT 146716 Ends Separate logic for 2 states
--DON00061 End
-- FSIT 124766 ends
--------------------GET MODIFICATION FACTOR INFO-------------------------
--------------------------------------------------------------------------------------------------------
Select 	FACT_STATE = StateCd, 
	BO_IRPM_FACT = Convert(Char(5), IndividualRiskPrmFct), 
 	BO_SCHD_FACT = Convert(Char(5), ScheduleModFct), 
 	BO_EXP_FACT = Convert(Char(5), ExpenseModFct)
From BOModFactors
Where AppId = @AppId 
-- Case 21864 Begins
-- For Selecting Loss History Information
SELECT 
CASE a.LossOccurrenceDt 
WHEN '01/01/01' THEN '' 
WHEN null THEN '' 
else CONVERT(char(10), LossOccurrenceDt ,101) 
end as DateOfLoss, 
a.LossDes as LossTypeDes,
a.LossDes as Description, a.LossPaidAmt as amount 
--TL FSIT 151818 Starts
,CASE a.ClaimReportDt
WHEN '01/01/01' THEN '' 
WHEN null THEN '' 
else CONVERT(char(10), ClaimReportDt,101)
end as ClaimReporteDt
,a.LossReserveAmt as  LossReserveAmt
,a.ClaimStatusTxt as ClaimStatus
--TL FSIT 151818 Ends
FROM SHLossHistory a with (nolock) 
WHERE a.AppId = @Appid
order by DateOfLoss asc
-- For Selecting Protection Information
SELECT
RTrim(b.AlarmTypeDes) as AlarmType,
RTrim(c.AlarmDes) as AlarmDescription,
RTrim(d.GradeTypeDes) as Grade ,
RTrim(e.PremProtectionDes) as PremProtection,
RTrim(f.SafeVaultProtectionDes) as SafeVaultProtection,
RTrim(a.SafeVaultManufacturerCd) as SafeVaultManufacturer,
RTrim(g.SafeVaultClassDes) as SafeVaultClass ,
a.MaximumCashPremAmt as MaximumCashPrem,
a.MaximumCashMessangerAmt as MaximumCashMessanger,
a.CashPremOvernightAmt as CashPremOvernight ,
a.DepositFrequencyAmt as DepositFrequency,
a.ListOfProtectionEquipTxt as ListOfProtectionEquip,
a.locationNbr as LocationNumber,
a.BuildingNbr as BuildingNumber
FROM BOProtectionInfo a,BOSeleAlarmType b, 
BOSeleAlarmDesc c, BOSeleGrade d,
BOSelePremProtection e,
BOSeleSafeVaultProtection f,
BOSeleSafeVaultClass g
with (nolock) WHERE
b.AlarmTypeCd = a.AlarmTypeCd AND
c.AlarmDescCd = a.AlarmDes AND
d.GradeTypeCd = a.GradeCd AND
e.PremProtectionCd = a.PremProtectionCd AND
f.SafeVaultProtectionCd = a.SafeVaultProtectionCd AND
g.SafeVaultClassCd = a.SafeVaultClassCd AND
a.Appid = @AppId 
--Start Issue 35271
and b.hostcd=@Host
and b.hostcd= c.hostcd
and c.hostcd= d.hostcd
and d.hostcd= e.hostcd
and e.hostcd= f.hostcd
and f.hostcd= g.hostcd
--End Issue 35271
--TL BOP NY 2010 Starts
and b.LineOfBusinessCd=@LOB
and b.LineOfBusinessCd= c.LineOfBusinessCd
and c.LineOfBusinessCd= d.LineOfBusinessCd
and d.LineOfBusinessCd= e.LineOfBusinessCd
and e.LineOfBusinessCd= f.LineOfBusinessCd
and f.LineOfBusinessCd= g.LineOfBusinessCd
--TL BOP NY 2010 Ends
order by a.locationNbr,
a.BuildingNbr
-- Case 21864 Ends
-- Get any referral/declination reasons (Case 19461)
EXEC SHRetrieveUnderwritingInfo @AppId
-- Get the underwriting status indicator (Case 19461)
SELECT UnderwritingStatusInd FROM SHPlaninfo WHERE AppId=@AppId
SELECT isnull( Issued,0) as 'PolicyBoundStatusInd' FROM SHPlaninfo WHERE AppId=@AppId --39332
--DON00059 Begin 
Select (CASE ISNULL(Factor01,'N') WHEN 'N' THEN 'Not Applicable' WHEN 'A' THEN 'Average' WHEN 'E' THEN 'Excellent' WHEN 'G' THEN 'Good'
									WHEN 'I' THEN	'Inferior'
									WHEN 'P' THEN	'Poor'
									WHEN 'S' THEN	'Superior'
									WHEN 'V' THEN	'Very Good'
									WHEN 'X' THEN	'Very Poor' END) AS ManagementMod
		, (CASE ISNULL(Factor02,'N') WHEN 'N' THEN 'Not Applicable' WHEN 'A' THEN 'Average' WHEN 'E' THEN 'Excellent' WHEN 'G' THEN 'Good'
									WHEN 'I' THEN	'Inferior'
									WHEN 'P' THEN	'Poor'
									WHEN 'S' THEN	'Superior'
									WHEN 'V' THEN	'Very Good'
									WHEN 'X' THEN	'Very Poor' END) AS LocationMod
		, (CASE ISNULL(Factor03,'N') WHEN 'N' THEN 'Not Applicable' WHEN 'A' THEN 'Average' WHEN 'E' THEN 'Excellent' WHEN 'G' THEN 'Good'
									WHEN 'I' THEN	'Inferior'
									WHEN 'P' THEN	'Poor'
									WHEN 'S' THEN	'Superior'
									WHEN 'V' THEN	'Very Good'
									WHEN 'X' THEN	'Very Poor' END) AS BuildingFeaturesMod
		, (CASE ISNULL(Factor04,'N') WHEN 'N' THEN 'Not Applicable' WHEN 'A' THEN 'Average' WHEN 'E' THEN 'Excellent' WHEN 'G' THEN 'Good'
									WHEN 'I' THEN	'Inferior'
									WHEN 'P' THEN	'Poor'
									WHEN 'S' THEN	'Superior'
									WHEN 'V' THEN	'Very Good'
									WHEN 'X' THEN	'Very Poor' END) AS PremisesEquipMod
		, (CASE ISNULL(Factor05,'N') WHEN 'N' THEN 'Not Applicable' WHEN 'A' THEN 'Average' WHEN 'E' THEN 'Excellent' WHEN 'G' THEN 'Good'
									WHEN 'I' THEN	'Inferior'
									WHEN 'P' THEN	'Poor'
									WHEN 'S' THEN	'Superior'
									WHEN 'V' THEN	'Very Good'
									WHEN 'X' THEN	'Very Poor' END) AS EmployeesMod
		, (CASE ISNULL(Factor06,'N') WHEN 'N' THEN 'Not Applicable' WHEN 'A' THEN 'Average' WHEN 'E' THEN 'Excellent' WHEN 'G' THEN 'Good'
									WHEN 'I' THEN	'Inferior'
									WHEN 'P' THEN	'Poor'
									WHEN 'S' THEN	'Superior'
									WHEN 'V' THEN	'Very Good'
									WHEN 'X' THEN	'Very Poor' END) AS ProtectionMod		
FROM BOInsuranceLine 
WHERE AppId = @AppId
--DON00059 End
--DON00061 Begin- Prior Carrier Information
SELECT PriorCarrierInfoTxt AS Carrier
	, PriorPolicyNbr AS PolicyNbr
	, '' AS FromDate
	, (CASE PriorPolicyExpirationDt WHEN NULL THEN '' ELSE CONVERT(char(10), PriorPolicyExpirationDt, 101)  END) AS ToDate
FROM SHPriorCarrierInformation
WHERE AppId = @AppId 
AND NOT(ISNULL(PriorCarrierInfoTxt, '') = '' AND ISNULL(PriorPolicyNbr, '') = '' AND ISNULL(PriorPolicyExpirationDt, '') = '')
ORDER BY PriorCarrierId
--DON00061 End
/* issue 95 bill payment plan NY start dlh */
IF @StateCd = 'NY' or @StateCd = 'CA'	
	BEGIN			
		/* issue 95 bill payment plan start dlh */
		Declare @InstallmentTbl as table
		(
		RecId integer,
		DueDate varchar(10),
		InstallmentDesc varchar(50),
		Installments integer,
		Amount money
		)
		Declare @DueDate Datetime
		Declare @PayPlanDesc Varchar(50)
		Declare @PayPlanCode Varchar(2)
		Declare @PayMode money	--TP 146629
		Declare @Installement integer
		Declare @DepositAmtWithApp money
		Declare @PayAmount money
		Declare @InstallmentPayAmount money
		Declare @i integer
		Declare @dateInc integer
		Declare @FetchStatus integer
		Declare @TotalPayments money
		Declare @PaymentDiff as money
		Declare @PremiumTotal as Money
		
		Declare @intervalType char(1)	--TP 146629		
		Declare @EffectiveDate Datetime --TP 146629
		--TP 146629
		select  @DueDate = EffectiveDate , @EffectiveDate = EffectiveDate,
				 @PayPlanCode = PaymentPlan,        
				 @DepositAmtWithApp = (Select PremiumAmt from BORating with (nolock) where AppId = @AppId and 
						 InsuranceLineCd = @InsuranceLineCd and 
						 LocationNbr = 0 and BuildingNbr = 0 and CoverageCd = '0')	  
		from Shplaninfo where appid = @appid
		set @PremiumTotal = @DepositAmtWithApp
		
		--TP 146629 12052012 START
		/*
		Select @dateInc = 
			   Case 
			      /*
			      --fsit 144952 start change Calculation from Months to Days
				  when  @PayPlanCode = 'D2' then 6
				  when @PayPlanCode = 'D4' then 2	--TP BOP NY 2010, Issues #112, changed from 4
				  when @PayPlanCode = 'DM' then 1
				  when @PayPlanCode = 'D0' then 1
				  when @PayPlanCode = 'P0' then 1
				  --TL FSIT 141661 - Starts
				  when @PayPlanCode = 'D6' then 2	--TP 141756
				  when @PayPlanCode = 'M1' then 1	--TP 141756
				  when @PayPlanCode = 'D3' then 6
				  when @PayPlanCode = 'D5' then 2
				  when @PayPlanCode = 'DN' then 1
				  when @PayPlanCode = 'DA' then 1
				  --TL FSIT 141661 - Ends
				   --fsit 144952 end
				  */
				  when @PayPlanCode = 'D2' then 180
				  when @PayPlanCode = 'D4' then 60	
				  when @PayPlanCode = 'DM' then 30
				  when @PayPlanCode = 'D0' then 30
				  when @PayPlanCode = 'P0' then 30				 
				  when @PayPlanCode = 'D6' then 45	
				  when @PayPlanCode = 'M1' then 30	
				  when @PayPlanCode = 'D3' then 180
				  when @PayPlanCode = 'D5' then 60
				  when @PayPlanCode = 'DN' then 30
				  when @PayPlanCode = 'DA' then 30
				end,
			   @PayMode =
			   Case 
				  when @PayPlanCode = 'D2' then .6
				  when @PayPlanCode = 'D4' then .3
				  when @PayPlanCode = 'DM' then .2
				  when @PayPlanCode = 'D0' then 1
				  when @PayPlanCode = 'P0' then 1
				  --TL FSIT 141661 - Starts
				  when @PayPlanCode = 'D6' then .25		--TP 141756
				  when @PayPlanCode = 'M1' then 1		--TP 141756
		
				  when @PayPlanCode = 'D3' then .6
				  when @PayPlanCode = 'D5' then .3
				  when @PayPlanCode = 'DN' then .2
				  when @PayPlanCode = 'DA' then 1
				  --TL FSIT 141661 - Ends				  
			   end
		from shselepaymentplan where
			 Host = @host and LOB = @LOB and  (LocationId = @LOC or LocationId = '99') and 
			(MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
			(PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and PaymentPlanCode = @PayPlanCode
		*/
		Select @dateInc = DueDateInterval, @PayMode = round(FirstInsPercent,2,1), @intervalType = IntervalType
		from shselepaymentplan where
			 Host = @host and LOB = @LOB and  (LocationId = @LOC or LocationId = '99') and 
			(MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
			(PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and PaymentPlanCode = @PayPlanCode And State = @StateCd
		--TP 146629 12052012 END
		--print @PayPlanCode
		--Print @PayMode
		--print @DueDate
		--print @PayPlanCode
		--print @DepositAmtWithApp
		set @FetchStatus = 0
		INSERT INTO @InstallmentTbl
		  Select 0, CONVERT(VARCHAR(10), @DueDate, 101),(select PaymentPlanName from shselepaymentplan where
							Host = @host and LOB = @LOB and  (LocationId = @LOC or LocationId = '99') and 
								 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
								 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and PaymentPlanCode = @PayPlanCode),
						   (select Installments from shselepaymentplan where
							Host = @host and LOB = @LOB and  (LocationId = @LOC or LocationId = '99') and 
								 (MasterCompanyId = @MCO OR MasterCompanyId = '99') and 
								 (PolicyCompanyId = @PCO OR PolicyCompanyId = '99') and PaymentPlanCode = @PayPlanCode),                    
							@DepositAmtWithApp
		-- TP 146629 START
		--set @InstallmentPayAmount = (@DepositAmtWithApp -(@DepositAmtWithApp * @PayMode))
		set @InstallmentPayAmount = (@DepositAmtWithApp - round((@DepositAmtWithApp * @PayMode) ,2, 1))
		set @i = 1
		 
		set @TotalPayments = 0.00
		set @PayAmount = @InstallmentPayAmount
		--set @TotalPayments = round((@DepositAmtWithApp * @PayMode) ,2)	-- TP 146629 START
		set @TotalPayments = round((@DepositAmtWithApp * @PayMode) ,2,1)
		--update @InstallmentTbl set Amount = round((@DepositAmtWithApp * @PayMode) ,2), Recid = @i	-- TP 146629 START
		update @InstallmentTbl set Amount = round((@DepositAmtWithApp * @PayMode) ,2, 1), Recid = @i
		DECLARE Installment_cursor CURSOR FOR 
			select DueDate, Installments, Amount from @InstallmentTbl
		OPEN Installment_cursor;
		FETCH NEXT FROM Installment_cursor
		INTO @DueDate, @Installement, @DepositAmtWithApp;
		set @InstallmentPayAmount = (@PayAmount / (@Installement - 1)  )
		WHILE @FetchStatus = 0
		BEGIN
				if @Installement > 0 
				   Begin                				
						set @Installement = @Installement - 1
						set @i = @i + 1
						--set @DueDate = DATEADD(Month,@dateInc, @DueDate) --fsit 144952
						--TP 146629 START
						--set @DueDate = DATEADD(Day,@dateInc, @DueDate)						
						if @intervalType = 'M'
							--set @DueDate = DATEADD(Month,@dateInc, @DueDate)
							exec GetNextDueDate @EffectiveDate, @DueDate, @dateInc, @DueDate output
						else
							set @DueDate = DATEADD(Day,@dateInc, @DueDate)
						--TP 146629 END
						if @Installement > 0 
						   Begin
							  insert @InstallmentTbl (recid, DueDate, InstallmentDesc, Installments, Amount)
								values(@i, CONVERT(VARCHAR(10), @DueDate, 101), 'Installment', @Installement, round(@InstallmentPayAmount,2,1))
							  --values(@i, CONVERT(VARCHAR(10), @DueDate, 101), 'Installment', @Installement, round(@InstallmentPayAmount,2))	-- TP 146629 START
							  --set @TotalPayments = @TotalPayments + round(@InstallmentPayAmount,2)						-- TP 146629 START
							  set @TotalPayments = @TotalPayments + round(@InstallmentPayAmount,2,1)
						   End
						else
							Begin
							 set  @FetchStatus = 1                    
							 if @TotalPayments <> @PremiumTotal
								Begin 					      
								  set @PaymentDiff = abs(@TotalPayments - @PremiumTotal)
								  --print @PaymentDiff
								  if @TotalPayments > @PremiumTotal
						  			 update @InstallmentTbl set Amount = Amount - @PaymentDiff where recid = @i	-1 						 
								  else
									 update @InstallmentTbl set Amount = Amount + @PaymentDiff where recid = @i -1
								 
								End
							End
				   End
				else
				   set  @FetchStatus = 1
		End
		select Recid as "Installment", DueDate, InstallmentDesc, convert(varchar(20),Amount,1) as "Amount" from @InstallmentTbl
		/* issue 95 bill payment plan end dlh */         
	End
--FSIT 145313 start PP
SELECT RTRIM(SHCoverageDetails.CoverageCd) AS CovCd 
	, CoverageDes  AS CoverageDesc
FROM SHCoverageDetails with (nolock) INNER JOIN SHSeleCoverageAttributes ON
	SHCoverageDetails.CoverageCd = SHSeleCoverageAttributes.CoverageCd
	AND SHCoverageDetails.LineOfBusinessCd = SHSeleCoverageAttributes.LineOfBusinessCd
	AND SHCoverageDetails.InsuranceLineCd = SHSeleCoverageAttributes.InsuranceLineCd
	AND SHSeleCoverageAttributes.HostCd = @Host
	AND SHSeleCoverageAttributes.LocationId IN ('99',@LocationId) 
	AND SHSeleCoverageAttributes.MasterCompanyId IN ('99',@MasterCompanyId)
	AND SHSeleCoverageAttributes.PolicyCompanyId IN ('99',@PolicyCompanyId)
	--AND InsuranceLineCovInd = 0	
	AND SHCoverageDetails.Coveragecd in ('MOTELS', 'RESTEN', 'APTENH', 'RETAIL', 'BLDOWN')
	AND StateCd IN ('99',@StateCd)
WHERE AppId = @AppId
AND SHCoverageDetails.LineOfBusinessCd = @LOB
AND SHCoverageDetails.InsuranceLineCd = @InsuranceLineCd 
ORDER BY SHCoverageDetails.CoverageCd, CoverageSequenceNbr 
--FSIT 145313 end PP
--Contact Print Infomation Issue 268 11/12/12 dlh start
declare @ContactInfo as Table
(
  ContactType varchar(30),
  ContactName varchar(100),
  ContactPhone varchar(15),
  ContactEmail varchar(50)
)
insert @ContactInfo 
Select (select ContactTypeDes from SHSeleContactType where
               HostCd = @Host and LocationId = @LocationId
               and MasterCompanyId = @MasterCompanyId 
               and LineOfBusinessCd = @LOB
               and StateCd = @StateCd 
               and ContactTypeCd = SHContactInfo.ContactTypeCd), 
       ContactNm,
       ContactPhoneNbr,
       ContactEmailAddressTxt
from SHContactInfo where appid = @appid 
 
insert @ContactInfo 
Select (select ContactTypeDes from SHSeleContactType where
               HostCd = @Host and LocationId = @LocationId
               and MasterCompanyId = @MasterCompanyId 
               and LineOfBusinessCd = @LOB
               and StateCd = @StateCd 
               and ContactTypeCd = SHContactInfo.ContactTypeCd2),
       ContactNm2,
       ContactPhoneNbr2,
       ContactEmailAddressTxt2
from SHContactInfo where appid = @appid 
Select * from @ContactInfo 
--Contact Print Infomation Issue 268 11/12/12 dlh end   
--BP CA 2010 start PP After Live Date issue 35 Loss History
Declare  @ClaimHistory table
( 
 ID int identity, 
 LossHistoryId bigint, 
 AppId varchar(20), 
 HostCd char(2), 
 LocationId char(2), 
 MasterCompanyId char(2), 
 PolicyCompanyId char(2), 
 LOB char(3), 
 LossOccurrenceDt char(10), 
 LossDes varchar (120), 
 ClaimReportDt char(10), 
 LossPaidAmt money, 
 LossReserveAmt money, 
 ClaimStatusTxt varchar(25), 
 NoLossInd bit, 
 LossAttachedInd bit, 
 NewVentureInd bit, 
 DummyLossId int,
InsuranceLineCd char(3)
) 
 
insert into @ClaimHistory (LossHistoryId,AppId, HostCd,LocationId, MasterCompanyId, PolicyCompanyId, 
LOB,LossOccurrenceDt, LossDes, ClaimReportDt, LossPaidAmt,LossReserveAmt,ClaimStatusTxt, NoLossInd, 
LossAttachedInd, NewVentureInd, DummyLossId, InsuranceLineCd) 
 Select LossHistoryId,AppId, HostCd,LocationId, MasterCompanyId, PolicyCompanyId, LineOfBusinessCd as LOB, 
 (CASE LossOccurrenceDt WHEN NULL THEN '' ELSE CONVERT(char(10), LossOccurrenceDt, 101)  END), LossDes, 
(CASE ClaimReportDt WHEN NULL THEN '' ELSE CONVERT(char(10), ClaimReportDt, 101)  END), 
 LossPaidAmt,LossReserveAmt,ClaimStatusTxt, 
 NoLossInd, LossAttachedInd, NewVentureInd, LossHistoryId as DummyLossId, InsuranceLineCd 
 from SHLossHistory with (nolock) where  AppId = @AppId and LocationId = @LocationId and MasterCompanyId = @MasterCompanyId and PolicyCompanyId = @PolicyCompanyId
Select * from @ClaimHistory 
--BP CA 2010 end PP After Live Date issue 35 Loss History
/*fsit 149990 dlh 6/10/13 start */
  IF  @StateCd = 'CA'	
		Begin
			--TL FSIT 151183 Starts
			Declare @CoinsurancePctCd char(20)
			set @CoinsurancePctCd = (select CoinsuranceDes From BPSeleCoinsurance 
										Where CoinsuranceCd = (select top 1 CoinsurancePctCd from BoPropertyInfo with (nolock) 
																	where appid = @appid and rtrim(BuildingBlanketTypeCd) = '1' and BuildingLimitAmt > 0)
											and LocationId=@LocationId
											and MasterCompanyId=@MasterCompanyId
											and PolicyCompanyId=@PolicyCompanyId
											and StateCd=@StateCd
											and InsuranceLineCd=@InsuranceLineCd)												
			--TL FSIT 151183 Ends
			Declare  @BlanketInsTbl table
			(
			TypeofProperty varchar(20),
			LimitOfIns varchar(20),
			CoInsurance varchar(20)	--TL FSIT 151183
			)
			
								   insert into @BlanketInsTbl (TypeOfProperty, LimitOfIns, CoInsurance) 
								   Select 'Building' , sum(BuildingLimitAmt) as LimitAmt, isnull(@CoinsurancePctCd, '') as COInsur	--TL FSIT 151183 dlh 151893 10/22/13
								   from BoPropertyInfo 
								   where appid = @appid and rtrim(BuildingBlanketTypeCd) = '1' and BuildingLimitAmt > 0	--TL FSIT 151183
								                        
								                     
			
								   insert into @BlanketInsTbl (TypeOfProperty, LimitOfIns, CoInsurance) 
								   Select 'BPP' , sum(BusinessPPAmt) as LimitAmt, 'Not Applicable' as COInsur	--TL FSIT 151183
								   from BoPropertyInfo where appid = @appid and rtrim(PersonalPropertyBlanketTypeCd)  = '2' 
								                                           
								   
			select * from @BlanketInsTbl 
		End	
			/*fsit 149990 dlh 6/10/13 end */
		--TL FSIT 151475 Starts
		SELECT   distinct a.FormCd, CASE(a.GeneratedFormInd) WHEN '0' THEN 
        CASE WHEN ISNULL(SUBSTRING(a.EditionCd,4,2),0) >50 AND a.GeneratedFormInd='0' THEN 
        SUBSTRING(a.EditionCd,1,2)+'/' +'01' + '/' + '19' + SUBSTRING(a.EditionCd,4,2) 
        ELSE  SUBSTRING(a.EditionCd,1,2)+'/' +'01' + '/' + '20' + SUBSTRING(a.EditionCd,4,2) End ELSE 
        Substring (a.EditionCd,6,2 )+ '/' +Substring (a.EditionCd,9,2 )+ '/' +Substring (a.EditionCd,1,4 ) END As FormDate,
		CASE(a.GeneratedFormInd) WHEN '1' THEN a.FormDes 
		ELSE (select top 1 AttributeValueDes From SHSeleManualForms with (nolock) where AttributeValueCd = a.FormCd and InsuranceLineCd=a.InsuranceLineCd)
		END AS FormDes
		From SHManualForms a with (nolock) where AppId=@appid
        ORDER BY a.FormCd 
		--TL FSIT 151475 Ends
        --fsit 236117 dlh 8/14/15 
		Select TerrorismExclusionInd from  BOInsuranceLine  with (nolock) where appid = @appid 
end

GRANT EXECUTE ON [dbo].[BPRetrieveQuote] TO [isol_app] AS [dbo]

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[BPUpdateBuildingInfo]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[BPUpdateBuildingInfo]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

/****** Object: Stored Procedure dbo.BOUpdateBuildingInfo Script Date: 11/14/02 9:33:34 AM ******/
CREATE Procedure [dbo].[BPUpdateBuildingInfo]
/* Key fields */
@AppId varchar(20)=Null,
@LOB varchar(3)='',
@ScreenName varchar(40)=null,
@Host varChar(2)=Null,
@InsuranceLineCd varchar(3)=Null,
@StateCd varchar(2)=null,
@LocationId varchar(2) = Null,
@MasterCompanyId varchar(2) =Null, 
@PolicyCompanyId varchar(2) =Null,
/* Key fields */
@LocationNumber int = 0,
@LocationCount int = 0,
@BuildingNumber int = 0,
@BuildingCount int = 0,
/* Other fields */
@BuildingDes varchar(50) = '',
@ClassCd varchar(18) = '',
@ClassDes varchar(100) = '', 
--DON00109@TerritoryCd varchar(4) = '',
@TerritoryCd varchar(6) = '',	--DON00109
@ProtectionClassCd varchar(3) = '',
--DON00109 @ConstructionCd varchar(2) = '',
@ConstructionCd varchar(3) = '',	--DON00109
@UnitDeductCd varchar(6) = '', 
@WindHailInd varchar(1) = '', 
@OccupancyCd varchar(1) = '', 
@ACVCd varchar(2) = '', 
@BOPAutoIncPctCd varchar(6) = '', 
@SprinklerInd varchar(1) = '', 
@CoinsurancePctCd varchar(4) = '', 
@BuildingLimitAmt varchar(18) = '', 
@PropOwnedAmt varchar(18) = '', 
@RiskTypeCd varchar(3) = '', 
@ShuttersInd varchar(2) = '', 
@CmpnyBusLiabExclInd varchar(2) = 'N', 
@BurglarAlarmInd varchar(1) = '', 
@BCEGCd varchar(2) = '', 
@BCEGTypeCd varchar(2) = '', 
@InflationPct decimal(18,2) = 0, 
@YearBuilt varchar(4) = '', 
@PremiumBasisAmt decimal(18,0) = 0, 
@SquareFtAreaAmt varchar(18) = '', 
@UnitCountNbr SmallInt = 0, 
@StoriesCountNbr SmallInt = 0, 
@AreaSprinkledPct varchar(18) = '',
@BusinessPPAmt varchar(18) = '', 
@RateGroupCd varchar(2) = '', 
@RateNumberCd varchar(2) = '', 
@GrossSalesAmt varchar(18) = '', 
@SwimmingPoolCntNbr varchar(4) = '', 
@HurricaneDeductInd varchar(1) = '', 
@WaterSupplyPrpInd varchar(2) = 'N', 
@UtilitiesInd varchar(2) = 'N',     --TL BOP NY 2010
@CommsupplyInd varchar(1) = 'N', 
@OverHdPwdInd varchar(1) = 'N', 
@PowerSupplyInd varchar(1) = 'N', 
@OverHdCommnInd varchar(2) = 'N', 
@PayRollAmt decimal(18,0) = 0, 
@ClassGroupCd varchar(6) = '', 
@DamageLiabDeductCd varchar(6) = '', 
@MaryLandZoneInd varchar(1) = '',
@LocationAddress varchar(30)='',
@Message varchar(10) ='',
@SeleLocationAddress varchar(30)=Null , --e-Service Case 13851
@BuildingDescription varchar(30)=Null,	--e-Service Case 13851
@NextLocationNbr char(2)=Null,		--e-Service Case 13851
@NextBuildingNbr char(2)=Null, 		--e-Service Case 13851
@SearchError char(1)=null, 		--Case 28037
@BldgPremiumOverrideInd char(1) = 'N', -- Issue 35271
@PropPremiumOverrideInd char(1) = 'N', -- Issue 35271
@BldgPremiumAmt decimal(18,0) = 0, -- Issue 35271
@PropPremiumAmt decimal(18,0) = 0 -- Issue 35271
--DON00013 Begin
, @SICCd						VARCHAR(7) = ''
, @WindHailDeductiblePct		DECIMAL(8, 3) = 0
, @BuildingValuationCd			CHAR(1) = ''
, @BuildingBlanketTypeCd		CHAR(1) = ''
, @PersonalPropertyValuationCd		CHAR(1) = ''
, @PersonalPropertyBlanketTypeCd	CHAR(1) = ''
, @WindHailExclInd				CHAR(1) = 'N'
, @ActualCashValueInd			CHAR(1) = '0'
, @AutomaticSprinklerSytemInd	CHAR(1) = '0'
, @AutomaticFireAlarmInd		CHAR(1) = '0'
, @SecurityServiceInd			CHAR(1) = '0'
, @SecurityContractInd			CHAR(1) = '0'
, @DeviceInPolicyNoteInd			CHAR(1) = '0'
, @ListOfProtectionEquipTxt		VARCHAR(30) = ''
--DON00013 End
--DON00084 begin
, @ProgramCd varchar(2) = ''
, @SubTypeCd varchar(2) = ''
, @LiquorSalesAmt decimal(18, 0) = 0
, @EmployeeCountNbr smallint = 0
, @BlanketBldgAndBPPInd char(1) = 'N'
, @BldgOrdinanceInd char(1) = 'N'
, @BaileeInd char(1) = 'N'
, @ProfessionalLiabilityInd char(1) = 'N'
, @LiquorInd char(1) = 'N'
, @InsSoleOccFreeStandBldgInd char(1) = '0'
, @MemberShoppingMallOver10StoresInd char(1) = '0'
, @Sprinklered100PercentInd char(1) = '0'
, @BldgLessThan10YrOrRenovatedInd char(1) = '0'
, @CentralStationBurglarAlarmInd char(1) = '0'
, @TheftExclusionInd char(1) = '0'
, @FranchiseAdjFctrInd char(1) = '0'
, @MultiLocAdjFctrInd char(1) = '0'
, @PlaygroundOrMechDeviceAdjFctrInd char(1) = '0'
, @MultiNonMechAmuseDevAdjFctrInd char(1) = '0'
, @TargetLink VARCHAR(20) = ''		--DON00057
--DON00084 end
, @FixturesEquipLimitAmt decimal(18, 0) = 0		--DON00247
, @ShowGeneric bit = 0   --DON00251A
--TL BOP NY 2010 Starts
, @BuildingNamedPerilsInd		bit = 0
, @PePropNamedPerilsInd			bit = 0
, @BurglaryRobberyInd			bit = 0
, @RenovationYear               char(4)
, @TerrorismInd                 bit = 0
, @TerrorismPropTerrCd          char(1)
, @WindstormProtectiveInd       bit = 0
, @EmploymentLiabilityInd       bit = 0
, @TenantsImprovementsCov       varchar(20)
, @LiabDeductAmt				char(6)
, @LiabDeductType				char(6)
, @LargeRestaurantInd           bit = 0
, @SwimmingPoolInd              bit = 0
--TL BOP NY 2010 Ends
--TP BOP NY 2010
, @LeadExclusionInd              bit = 0
, @CondoAssociation              char(1)='' --DON-2576
As
set nocount on
Declare @error int
Declare @PrevClassCd varchar(18)
Declare @count int
DECLARE @UnitTable TABLE (UnitNumber VARCHAR(12))	--DON00057
DECLARE @PMACd VARCHAR(10), @ExcludeOptCov2Cd VARCHAR(10) , @GroupClassCd CHAR(6)	--DON00167
--DON00251 Starts
Declare @status int
Declare @ctr int
Declare @ctr2 int
Declare @ctr3 int
Declare @ctr4 int
Declare @QLocationId char(2)
Declare @QMasterCompanyId char(2)
Declare @QPolicyCompanyId char(2)
DECLARE @UnitNumber VARCHAR(12)	
DECLARE @AddBailee smallint
set @AddBailee = 0
Set @QLocationId=@LocationId			
Set @QMasterCompanyId=@MasterCompanyId	 
Set @QPolicyCompanyId=@PolicyCompanyId	 
Set @status = 0
set @ClassDes = rtrim(ltrim(@ClassDes))
--DON00251 Ends
If @InsuranceLineCd = '' 	
Begin
	--Set @InsuranceLineCd = 'BOP'  --TL BOP NY 2010
    Set @InsuranceLineCd = (select top 1 WCLineOfBusiness from SHPlanInfo (nolock) where appid=@AppId)    --TL BOP NY 2010
End
if(@Message='GetRateCd')
begin
set @count = (select count(RateNbr) from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd))
set @RateGroupCd = (select RateGroupCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd))
set @RateNumberCd = (select RateNbr from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd))
set @RiskTypeCd = ( select RiskTypeCd from BOSeleClassCdValues where rtrim(ClassCd) = rtrim(@ClassCd))
end
if @count = 0
begin
set @RateNumberCd =''
set @RateGroupCd = ''
set @RiskTypeCd = ''
set @ClassDes = ''
end
Set @PrevClassCd = (Select rtrim(ClassCd) from BOPropertyInfo with (nolock) Where AppId=@AppId 
						 And LocationNbr = @LocationNumber 
						 And StructureNbr = @BuildingNumber 
						 And InsuranceLineCd = @InsuranceLineCd)
Set @StateCd = (Select RiskState from SHPlanInfo with (nolock) Where AppId= @AppId)	
IF (@CLassCd = '09521' or @CLassCd = '71811' or @CLassCd = '09531' or @CLassCd = '09541') and @StateCd = 'CA' and @InsuranceLineCd = 'CBP'
    BEGIN
       Set @BaileeInd = 'Y'
    END   				 
-- Included for Dot net Code - Starts
if @OverHdCommnInd = '0'
Set @OverHdCommnInd = 'N'
else
Set @OverHdCommnInd = 'Y'
if @OverHdPwdInd = '0'
Set @OverHdPwdInd = 'N'
else
Set @OverHdPwdInd = 'Y'
if @PowerSupplyInd = '0' 
Set @PowerSupplyInd = 'N'
else
Set @PowerSupplyInd = 'Y'
if @CommsupplyInd = '0' 
Set @CommsupplyInd = 'N'
else
Set @CommsupplyInd = 'Y'
if @WaterSupplyPrpInd = '0' 
Set @WaterSupplyPrpInd = 'N'
else
Set @WaterSupplyPrpInd = 'Y'
if @CmpnyBusLiabExclInd = '0'
Set @CmpnyBusLiabExclInd = 'N'
else
Set @CmpnyBusLiabExclInd = 'Y'
-- Included for Dot net Code - Ends
--DON00084 begin
--PMD 132964 Starts
--if @BlanketBldgAndBPPInd = '0'
--Set @BlanketBldgAndBPPInd = 'N'
--else
--Set @BlanketBldgAndBPPInd = 'Y'
Set @BlanketBldgAndBPPInd = NULL
--PMD 132964 Ends
if @BldgOrdinanceInd = '0'
Set @BldgOrdinanceInd = 'N'
else
Set @BldgOrdinanceInd = 'Y'
--DON00084 end
If @UtilitiesInd = '' Set @UtilitiesInd = 'N'   --TL BOP NY 2010
--TL BOP NY 2010 Starts
If @LOB = 'BP'
Begin
    Select @RiskTypeCd = isnull(GroupCd, '') 
    from BPSeleClassCodes 
    where StateCd in ('99', @StateCd) 
        and LocationId in ('99', @LocationId) 
        and MasterCompanyId in ('99', @MasterCompanyId) 
        and PolicyCompanyId in ('99', @PolicyCompanyId) 
        and rtrim(ClassCd) = rtrim(@ClassCd) 
        and rtrim(ClassDescription) = rtrim(@ClassDes) 
        and Statecd = @StateCd
        and HostCd=@Host
     
End
--TL BOP NY 2010 Ends
Update BOPropertyInfo with (rowlock) 
 Set 
	BuildingDes = @BuildingDes, 
	ClassCd = @ClassCd,
	ClassDes = @ClassDes, 
	TerritoryCd = @TerritoryCd, 
	ProtectionClassCd = @ProtectionClassCd,
	ConstructionCd = @ConstructionCd, 
	UnitDeductCd = @UnitDeductCd, 
	WindHailInd = @WindHailInd, 
	OccupancyCd = @OccupancyCd, 
	ACVCd = @ACVCd,
	BOPAutoIncPctCd = @BOPAutoIncPctCd,
	SprinklerInd = @SprinklerInd, 
	CoinsurancePctCd = @CoinsurancePctCd, 
	BuildingLimitAmt = Convert(float,@BuildingLimitAmt), 
	PropOwnedAmt = Convert(float,@PropOwnedAmt),
	RiskTypeCd = @RiskTypeCd, 
	ShuttersInd = @ShuttersInd, 
	CmpnyBusLiabExclInd = @CmpnyBusLiabExclInd, 
	BurglarAlarmInd = @BurglarAlarmInd, 
	BCEGCd = @BCEGCd, 
	BCEGTypeCd = @BCEGTypeCd,
	InflationPct = @BusinessPPAmt,
	YearBuilt = @YearBuilt, 
	PremiumBasisAmt = @PremiumBasisAmt, 
	SquareFtAreaAmt = Convert(float,@SquareFtAreaAmt),
	UnitCountNbr = @UnitCountNbr, 
	StoriesCountNbr =Convert(smallint,@StoriesCountNbr),
	AreaSprinkledPct = Convert(float,@AreaSprinkledPct),
	BusinessPPAmt = Convert(float,@BusinessPPAmt), 
	RateGroupCd = @RateGroupCd, 
	RateNumberCd = @RateNumberCd, 
	GrossSalesAmt = Convert(float,@GrossSalesAmt),
	SwimmingPoolCntNbr = @SwimmingPoolCntNbr, 
	HurricaneDeductInd = @HurricaneDeductInd, 
	WaterSupplyPrpInd = @WaterSupplyPrpInd, 
	UtilitiesInd = @UtilitiesInd, 
	CommsupplyInd = @CommsupplyInd,
	OverHdPwdInd = @OverHdPwdInd, 
	PowerSupplyInd = @PowerSupplyInd, 
	OverHdCommnInd = @OverHdCommnInd, 
--	ClassGroupCd = @ClassGroupCd, 			-- Issue 35271
	DamageLiabDeductCd = @DamageLiabDeductCd,
	MaryLandZoneInd = @MaryLandZoneInd,
	BuildingPremiumOverrideInd =@BldgPremiumOverrideInd, -- Issue 35271
	PropertyPremiumOverrideInd =@PropPremiumOverrideInd, -- Issue 35271
	BuildingPremiumAmt =@BldgPremiumAmt, -- Issue 35271
	PropertyPremiumAmt =@PropPremiumAmt -- Issue 35271
--DON00013 Begin
	, SICCd = @SICCd
	, WindHailDeductiblePct = @WindHailDeductiblePct
	, BuildingValuationCd = @BuildingValuationCd
	, BuildingBlanketTypeCd = @BuildingBlanketTypeCd
	, PersonalPropertyValuationCd = @PersonalPropertyValuationCd
	, PersonalPropertyBlanketTypeCd = @PersonalPropertyBlanketTypeCd
	, WindHailExclInd = (CASE @WindHailExclInd WHEN '1' THEN 'Y' ELSE 'N' END)
	, ActualCashValueInd = (CASE @ActualCashValueInd WHEN '1' THEN 1 ELSE 0 END)
	, AutomaticSprinklerSytemInd = (CASE @AutomaticSprinklerSytemInd WHEN '1' THEN 1 ELSE 0 END)
	, AutomaticFireAlarmInd = (CASE @AutomaticFireAlarmInd WHEN '1' THEN 1 ELSE 0 END)
	, SecurityServiceInd = (CASE @SecurityServiceInd WHEN '1' THEN 1 ELSE 0 END)
	, SecurityContractInd = (CASE @SecurityContractInd WHEN '1' THEN 1 ELSE 0 END)
	, DeviceInPolicyNoteInd = (CASE @DeviceInPolicyNoteInd WHEN '1' THEN 1 ELSE 0 END)
	, ListOfProtectionEquipTxt = @ListOfProtectionEquipTxt
--DON00013 End
--DON00084 begin
	, ProgramCd = @ProgramCd
	, SubTypeCd = @SubTypeCd
	, LiquorSalesAmt = @LiquorSalesAmt
	, EmployeeCountNbr = @EmployeeCountNbr
	, BlanketBldgAndBPPInd = (Case @BlanketBldgAndBPPInd when 'Y' then 'Y' else 'N' End)
	, BldgOrdinanceInd = (Case @BldgOrdinanceInd when 'Y' then 'Y' else 'N' End)
	, BaileeInd = (Case @BaileeInd when 'Y' then 'Y' else 'N' End)
	, ProfessionalLiabilityInd = (Case @ProfessionalLiabilityInd when 'Y' then 'Y' else 'N' End)
	, LiquorInd = (Case @LiquorInd when 'Y' then 'Y' else 'N' End)
	, InsSoleOccFreeStandBldgInd = (Case @InsSoleOccFreeStandBldgInd when 1 then 'True' else 'False' End)
	, MemberShoppingMallOver10StoresInd = (Case @MemberShoppingMallOver10StoresInd when 1 then 'True' else 'False' End)
	, Sprinklered100PercentInd = (Case @Sprinklered100PercentInd when 1 then 'True' else 'False' End)
	, BldgLessThan10YrOrRenovatedInd = (Case @BldgLessThan10YrOrRenovatedInd when 1 then 'True' else 'False' End)
	, CentralStationBurglarAlarmInd = (Case @CentralStationBurglarAlarmInd when 1 then 'True' else 'False' End)
	, TheftExclusionInd = (Case @TheftExclusionInd when 1 then 'True' else 'False' End)
	, FranchiseAdjFctrInd = (Case @FranchiseAdjFctrInd when 1 then 'True' else 'False' End)
	, MultiLocAdjFctrInd = (Case @MultiLocAdjFctrInd when 1 then 'True' else 'False' End)
	, PlaygroundOrMechDeviceAdjFctrInd = (Case @PlaygroundOrMechDeviceAdjFctrInd when 1 then 'True' else 'False' End)
	, MultiNonMechAmuseDevAdjFctrInd = (Case @MultiNonMechAmuseDevAdjFctrInd when 1 then 'True' else 'False' End)
--DON00084 end
	, FixturesEquipLimitAmt = @FixturesEquipLimitAmt	--DON00247
    --TL BOP NY 2010 Starts
    , BuildingNamedPerilsInd = @BuildingNamedPerilsInd
    , PePropNamedPerilsInd = @PePropNamedPerilsInd
    , BurglaryRobberyInd = @BurglaryRobberyInd    
    , RenovationYear = @RenovationYear
    , TerrorismInd = (Case @TerrorismInd when 1 then 'True' else 'False' End)
    , TerrorismPropTerrCd = @TerrorismPropTerrCd
    , WindstormProtectiveInd = (Case @WindstormProtectiveInd when 1 then 'True' else 'False' End)
    , EmploymentLiabilityInd = (Case @EmploymentLiabilityInd when 1 then 'True' else 'False' End)
    , TenantsImprovementsCov = @TenantsImprovementsCov
    , LiabDeductAmt = @LiabDeductAmt
    , LiabDeductType = @LiabDeductType
    , PayRollAmt = Convert(float,@PayRollAmt)
    , LargeRestaurantInd = @LargeRestaurantInd
    , SwimmingPoolInd = @SwimmingPoolInd
    --TL BOP NY 2010 Ends
	--TP BOP NY 2010, Add LeadExclusionInd
	--LR FSIT 139895 - Start
	, LeadExclusionInd = Case 
							When (Convert(smallint, @YearBuilt) < 1980) And (RTrim(@ClassCd) IN ('69145', '65141', '65142', '65132', '65133')) And @LeadExclusionInd = 1 Then 1
							Else
								@LeadExclusionInd
						 End
	--, LeadExclusionInd = (Case @LeadExclusionInd when 1 then 'True' else 'False' End)
	--LR FSIT 139895 - End
Where AppId=@AppId 
 And LocationNbr = @LocationNumber 
 And StructureNbr = @BuildingNumber 
 And InsuranceLineCd = @InsuranceLineCd
 /* fsit 240038 dlh 2/26/16 start */
	
     IF @LOB = 'BP' and @StateCd ='NY'
	    begin	
		  declare @EffectiveDt datetime
	      set @EffectiveDt = (select effectivedate from shplaninfo with (nolock) where appid = @appid)
          if @EffectiveDt > convert(datetime,'7/31/2016')   
		          if (select count(*) from SHCoverageDetailItems where appid = @Appid and  CoverageCd = 'EQBDN' and locationNbr = @LocationNumber and buildingNbr = @BuildingNumber) = 0		          
				     Exec SHInsertCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber,@LOB, @InsuranceLineCd, @StateCd, 'EQBDN'				 		
        end  
    /* fsit 240038 dlh 2/26/16 end */
 --issue 101 start dlh
       Update BOPropertyInfo SET Terrorismind = @TerrorismInd
   	          WHERE AppId = @AppId
       Update BOInsuranceLine SET Terrorismind = @TerrorismInd
   	          WHERE AppId = @AppId
	--issue 101 end dlh
	--TP BPCA 2010 230 11062012 START, Flood for all building
	IF @StateCd = 'CA' and @LOB = 'BP' and @InsuranceLineCd = 'CBP'
	Begin
		Update BOPropertyInfo Set BuildingBlanketTypeCd = @BuildingBlanketTypeCd Where AppId = @AppId
		Update BOPropertyInfo Set PersonalPropertyBlanketTypeCd = @PersonalPropertyBlanketTypeCd Where AppId = @AppId
		Update BOPropertyInfo Set CondoAssociation=@CondoAssociation Where AppId = @AppId --DON-2576
		--TL FSIT 151183 Starts
		If @BuildingBlanketTypeCd = '1' and @BuildingLimitAmt > 0
		Begin
			Update BOPropertyInfo Set CoinsurancePctCd = @CoinsurancePctCd Where AppId = @AppId and BuildingLimitAmt > 0
		End
		Else If @BuildingBlanketTypeCd = '1' and @BuildingLimitAmt = 0
		Begin
			If ((select count(distinct CoinsurancePctCd) from BOPropertyInfo where appid=@AppId and buildinglimitamt > 0) > 1)
				Update BOPropertyInfo Set CoinsurancePctCd = '90' Where AppId = @AppId and BuildingLimitAmt > 0
		End
		--TL FSIT 151183 Ends
		--TL BOP CA 2010 Post live issue 56 Starts
		UPDATE BOPropertyInfo
				SET SICCd = substring(SICCode,1,6)
					, rategroupcd = (select RateGroupCd From SHSeleTerritoryCodes Where LineOfBusinessCd=@LOB and StateCd=@StateCd and TerritoryCd=@TerritoryCd)
					, PropertyRateNumberCd = PropertyRateNumber
					, LiabClassGroupCd = LiabilityClassGroup
			FROM BPSeleClassCodes
				WHERE HostCd = @Host
					AND LocationId IN ('99', @LocationId)
					AND MasterCompanyId IN ('99', @MasterCompanyId)
					AND PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND StateCd IN ('99', @StateCd)
					AND BPSeleClassCodes.ClassCd = @ClassCd
					AND BPSeleClassCodes.ClassDescription = @ClassDes
					AND AppId = @AppId
					And LocationNbr = @LocationNumber 
					And StructureNbr = @BuildingNumber 
					And InsuranceLineCd = @InsuranceLineCd
		--TL BOP CA 2010 Post live issue 56 Ends
	End
Set @error = @@error
If @error <> 0
 Return @error
If @PrevClassCd <> @ClassCd 
Begin
	Update BOCoverage with (rowlock) 
	Set ClassCd = @ClassCd,
	 ClassDes = @ClassDes
	Where AppId=@AppId 
	 And LocationNbr = @LocationNumber 
	 And BuildingNbr = @BuildingNumber 
	 And InsuranceLineCd = @InsuranceLineCd
End
--TP BOP NY 2010 start 240038
--IF @LOB = 'BP' and @StateCd = 'NY'
--BEGIN
--	Update SHCoverageDetailItems
--	Set FieldValueTxt = @UnitDeductCd
--	Where AppId = @AppId And CoverageCd ='MECHBD' And FieldNameTxt ='MechDeductible'
--End
--TP BOP NY 2010 Ends 240038
--TL BOP CA 2010 Post live issue 51 Starts
--IF @BaileeInd <> 'Y' and @StateCd = 'CA' and @AddBailee = 1 and @LOB = 'BP' and @InsuranceLineCd = 'CBP'
--	UPDATE SHCoverageDetailItems 
--		SET FieldValueTxt = '0'
--	WHERE AppId = @AppId
--		AND LocationNbr = @LocationNumber 
--		AND BuildingNbr = @BuildingNumber 
--		AND LineOfBusinessCd = @LOB	--TL BOP NY 2010
--		AND InsuranceLineCd = @InsuranceLineCd
--		AND CoverageCd = 'BAILEE'	
--		AND FieldNameTxt = 'BAILEE_LimitAmt'
--TL BOP CA 2010 Post live issue 51 Ends
--TP BOP NY 2010 Starts
IF @LOB = 'BO'
  BEGIN
	--TP Fsit 169891 START
	IF  (Convert(float,@BusinessPPAmt) > 0)
		BEGIN
			IF NOT EXISTS (SELECT 1 FROM SHCoverageDetails with (nolock) WHERE AppId = @AppId AND LocationNbr = @LocationNumber And BuildingNbr = @BuildingNumber AND LineOfbusinessCd = 'BO' AND CoverageCd = 'SPOIL')
				--Add Spoilage/Refrigerant Leakage coverage
				Exec SHInsertCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber, @LOB, @InsuranceLineCd, @StateCd, 'SPOIL'
		END
	ELSE
		BEGIN
			--Remove Spoilage/Refrigerant Leakage coverage
			Exec SHDeleteCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber, @LOB, @InsuranceLineCd, 'SPOIL'
			
		END
		
	--TP Fsit 169891 END
	--DON00057 Begin
	--IF (@ClassCd <> '' AND @ClassDes <> '' AND @TargetLink = '')  --DON00251A
    IF (@ClassCd <> '' AND @ClassDes <> '' AND @TargetLink <> 'GetClassCd' AND @TargetLink <> 'GetClassDesc')  --DON00251A
	BEGIN
		--TL FSIT 165047 - Starts
		If ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and coverageCd='HIRED') = 1)
			INSERT INTO @UnitTable VALUES ('BOHIRED')
		If ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and coverageCd='EMPDIS') = 1)
			INSERT INTO @UnitTable VALUES ('BOEMPDIS')	
		If ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and coverageCd='EBL') = 1)
			INSERT INTO @UnitTable VALUES ('BOEBL')			
		--TL FSIT 165047 - Ends
		INSERT INTO @UnitTable VALUES ('BOPL')
        --DON00251 Starts 
		IF EXISTS (SELECT 1 FROM BOPropertyInfo with (nolock) WHERE RiskTypeCd = 'OF' AND AppId = @AppId)
        BEGIN
			INSERT INTO @UnitTable VALUES ('BOOF')
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BOOF', @InsuranceLineCd = 'BOP'
        END
        
		IF EXISTS (SELECT 1 FROM BOPropertyInfo with (nolock) WHERE ProgramCd = 'R' AND RiskTypeCd = 'RT' AND AppId = @AppId)
        BEGIN
			INSERT INTO @UnitTable VALUES ('BORRT')
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BORRT', @InsuranceLineCd = 'BOP'
        END
		IF EXISTS (SELECT 1 FROM BOPropertyInfo with (nolock) WHERE ProgramCd = 'S' AND RiskTypeCd = 'RS' AND AppId = @AppId)
        BEGIN
			INSERT INTO @UnitTable VALUES ('BORS')
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BORS', @InsuranceLineCd = 'BOP'
        END
		IF EXISTS(SELECT 1 FROM BOPropertyInfo with (nolock) WHERE AppId = @AppId 
					AND ((RTRIM(ClassCd) = '71811' AND ClassDes = 'Laundry Receiving Stations') OR (RTRIM(ClassCd) = '09521' AND ClassDes = 'Dry Cleaning Store/Laundry Plants')))
        BEGIN
			INSERT INTO @UnitTable VALUES ('BODC')
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BODC', @InsuranceLineCd = 'BOP'
        END
		IF EXISTS(SELECT 1 FROM BOPropertyInfo with (nolock) WHERE AppId = @AppId 
					AND ((RTRIM(ClassCd) = '54516' AND ClassDes = 'Cheese Shops') OR (RTRIM(ClassCd) = '71311' AND ClassDes = 'Bakery (no eating on premises')))
        BEGIN
			INSERT INTO @UnitTable VALUES ('BOFOOD')
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BOFOOD', @InsuranceLineCd = 'BOP'
        END 
		IF EXISTS(SELECT 1 FROM BOPropertyInfo with (nolock) WHERE AppId = @AppId 
					AND RTRIM(ClassCd) = '54116' AND ClassDes = 'Delicatessens - Retail - (no eating on premises)')
		BEGIN
			INSERT INTO @UnitTable VALUES ('BOFOOD')
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BOFOOD', @InsuranceLineCd = 'BOP'
			INSERT INTO @UnitTable VALUES ('BOOVENS')			
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BOOVENS', @InsuranceLineCd = 'BOP'
		END
		IF EXISTS(SELECT 1 FROM BOPropertyInfo with (nolock) WHERE AppId = @AppId 
					AND ((RTRIM(ClassCd) = '59215' AND @ClassDes = 'Liquor Stores') OR (RTRIM(ClassCd) = '54136' AND @ClassDes = 'Convenience Stores - No Gas/LPG Sales') OR (RTRIM(ClassCd) = '54136' AND ClassDes = 'gourmet food shops') OR (RTRIM(ClassCd) = '54516' AND ClassDes = 'Cheese Shops')  OR (RTRIM(ClassCd) = '59116' AND ClassDes = 'drug stores')  OR (RTRIM(ClassCd) = '54116' AND ClassDes = 'Delicatessens - Retail - (no eating on premises)')))
        BEGIN 
			INSERT INTO @UnitTable VALUES ('BOLIQUOR')
            EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BO', @UnitNbr = 'BOLIQUOR', @InsuranceLineCd = 'BOP'
        END
        --DON00251 Ends
		DELETE FROM SHRemarks 
			WHERE AppId = @AppId 
			AND UnitNbr NOT IN (SELECT DISTINCT UnitNumber FROM @UnitTable) 
			AND UnitNbr LIKE 'BO%'
		DELETE FROM SHRemarksDetail 
			WHERE AppId = @AppId 
			AND UnitNbr NOT IN (SELECT DISTINCT UnitNumber FROM @UnitTable) 
			AND UnitNbr LIKE 'BO%'
		--DON00167 Begin
		SELECT @PMACd = PMACd , @ExcludeOptCov2Cd = ExcludeOptCov2Cd 
			FROM BOSeleClassCodes 
			WHERE ClassCd = @ClassCd
				AND HostCd = @Host 
				AND LocationId in ('99',@LocationId)
				AND MasterCompanyId in('99',@MasterCompanyId)
				AND PolicyCompanyId in ('99',@PolicyCompanyId)
				AND StateCd in ('99',@StateCd)
				AND ClassDescription = @ClassDes
		SET @GroupClassCd = ISNULL(@PMACd,'') + ISNULL(@ExcludeOptCov2Cd,'')
		---'999999' is the default class code for default questions on Prequalification screen, It will not deleted in any case.
		--GroupClassCd is the combination of PMA code and Sub Type selected on Building screen. We have questions based on groupclasscd 
		--and should not be deleted the class code belongs to groupclasscd
		IF EXISTS(SELECT 1 FROM SHStopperQuestionsRemarks with (nolock), SHSeleStopperQuestions WHERE AppId = @AppId AND LocationNbr = @LocationNumber 
						AND StructureNbr = @BuildingNumber AND SHStopperQuestionsRemarks.QuestionCd = SHSeleStopperQuestions.QuestionCd
						AND LocationId in ('99',@LocationId)
						AND MasterCompanyId in('99',@MasterCompanyId)
						AND PolicyCompanyId in ('99',@PolicyCompanyId)
						AND StateCd in ('99',@StateCd)
						AND QuestionClassCd <> '999999'
						AND QuestionClassCd <> @GroupClassCd
						AND QuestionClassCd <> @ClassCd
						AND QuestionClassDes <> @ClassDes)
		BEGIN
			--Deleting questions specific to location and building, which may become obsolete because of change of class code and/or description
			DELETE FROM SHStopperQuestionsRemarks WHERE AppId = @AppId 
						AND LocationNbr = @LocationNumber 
						AND StructureNbr = @BuildingNumber
						AND QuestionCd IN (SELECT QuestionCd FROM 
												SHSeleStopperQuestions WHERE 
												LocationId in ('99',@LocationId)
												AND MasterCompanyId in('99',@MasterCompanyId)
												AND PolicyCompanyId in ('99',@PolicyCompanyId)
												AND StateCd in ('99',@StateCd)
												AND QuestionClassCd <> '999999'
												AND QuestionClassCd <> @GroupClassCd
												AND QuestionClassCd <> @ClassCd
												AND QuestionClassDes <> @ClassDes)
		END
		--DON00167 End	
        --DON00251 Starts
        SELECT TOP 1 @QLocationId=LocationId, @QMasterCompanyId=MasterCompanyId , @QPolicyCompanyId=PolicyCompanyId
		FROM SHSeleStopperQuestions with (index(IX_SHSeleStopperQuestions),nolock)								
		where HostCd = @Host and 
		(locationid=@QLocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
		(mastercompanyid=@QMasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
		(policycompanyid= @QPolicyCompanyId or policycompanyid='99') and
		(StateCd=@StateCd or StateCd='99') and LineOfBusinessCd=@LOB
        set @ctr= (select count(*) 
		from SHStopperQuestionsRemarks with (nolock) 
		Where AppId=@AppId 
		and LocationNbr = @LocationNumber 
		and	StructureNbr = @BuildingNumber )
		
	    SET @ctr2 = (select count(*) 
		from shselestopperquestions with (nolock) 
			Where ltrim(rtrim(QuestionClassCd)) = ltrim(rtrim(@ClassCd))
				AND QuestionClassDes = @ClassDes
				AND HostCd = @Host 
				AND LocationId IN ('99',@LocationId)
				AND MasterCompanyId IN('99',@MasterCompanyId)
				AND PolicyCompanyId IN ('99',@PolicyCompanyId)
				AND StateCd IN ('99',@StateCd)
				and LineOfBusinessCd = @LOB)
	
	    SET @ctr4 = (SELECT COUNT(*) 
		from shselestopperquestions with (nolock) 
			Where LTRIM(RTRIM(QuestionClassCd)) = LTRIM(RTRIM(@GroupClassCd))
				AND HostCd = @Host 
				AND LocationId IN ('99',@LocationId)
				AND MasterCompanyId IN('99',@MasterCompanyId)
				AND PolicyCompanyId IN ('99',@PolicyCompanyId)
				AND StateCd IN ('99',@StateCd)
				and LineOfBusinessCd = @LOB)
	
	    SET @ctr3 = (select count(*) 
			from shselestopperquestions with (nolock) 
			Where QuestionClassCd = '999999'
				AND HostCd = @Host 
				AND LocationId IN ('99',@LocationId)
				AND MasterCompanyId IN('99',@MasterCompanyId)
				AND PolicyCompanyId IN ('99',@PolicyCompanyId)
				AND StateCd IN ('99',@StateCd)
				AND LineOfBusinessCd = @LOB)
	    if ((@ctr <> 0 ) and (@ctr < @ctr2 + @ctr3 + @ctr4))
        
	    begin
		   print 'Inserting Specific Class Code Questions'
		   EXEC @status = SHInsertStopperQuestions @AppId=@AppId, @HostCd=@Host, @LocationId=@QLocationId, @PolicyCompanyId=@QPolicyCompanyId, 
				@MasterCompanyId=@QMasterCompanyId, @LineOfBusinessCd=@LOB, @StateCd=@StateCd 
				,@LocationNbr = @LocationNumber 
				,@StructureNbr = @BuildingNumber 
				--,@ShowGeneric = 1   --DON00251A
                ,@ShowGeneric = @ShowGeneric  --DON00251A
				,@ClassCode = @ClassCd
				,@InsertClassCdOnly = 1 
				,@GroupClassCd = @GroupClassCd 
				,@ClassDes = @ClassDes 
	    end
        --DON00251A Starts
        If @ctr = 0 and @AppId<>''
	    begin
		  print 'Inserting Generic Class Code Questions'
		  EXEC @status = SHInsertStopperQuestions @AppId=@AppId, @HostCd=@Host, @LocationId=@QLocationId, @PolicyCompanyId=@QPolicyCompanyId, 
			@MasterCompanyId=@QMasterCompanyId, @LineOfBusinessCd=@LOB, @StateCd=@StateCd
			,@LocationNbr = @LocationNumber
			,@StructureNbr =@BuildingNumber
			,@ShowGeneric = @ShowGeneric
			,@ClassCode = @ClassCd
			,@GroupClassCd = @GroupClassCd
			,@ClassDes = @ClassDes
	    end
        --DON00251A Ends
        If @status=98
        Begin
	      RAISERROR ('Failed to Insert responses into SHStopperQuestionsRemarks for following key: %s. Verify the key is found in SHSeleStopperQuestions.', 16, 1, @Host, @QLocationId, @QPolicyCompanyId, @QMasterCompanyId, @LOB, @StateCd) 
        End
        --DON00251 Ends
	END
	--DON00057 End
  END
ELSE
    BEGIN
	--TP BOP CA 2010, 144444 - Make Bailee as default coverage
	DECLARE @ClsCode varchar(8)
	DECLARE @IsExist Int
	DECLARE @OccupancyCd2 varchar(1)
	--TP BOP CA 2010, 144444 - Make Bailee as default coverage
	  declare @temptable table (Bld smallint, Loc smallint, CCd varchar(18), CDes varchar(100)) --LR FSIT 139658 - Fix length of CCd below
	  --declare @temptable table (Bld smallint, Loc smallint, CCd varchar(6), CDes varchar(200))
	  insert into @temptable select StructureNbr, LocationNbr, ClassCd, ClassDes From BOPropertyInfo Where Appid=@Appid
	  declare CurBuildList cursor for select * from @temptable
      OPEN CurBuildList
      FETCH NEXT FROM CurBuildList into @BuildingNumber, @LocationNumber , @ClassCd, @ClassDes while @@FETCH_STATUS = 0
	    BEGIN
		  SELECT @OccupancyCd=OccupancyCd From BOPropertyinfo Where Appid = @Appid	And LocationNbr = @LocationNumber AND StructureNbr=@BuildingNumber	--TL BOP CA 2010 11/29				
	      If @LOB = 'BP'
			   BEGIN
				Select @RiskTypeCd = isnull(GroupCd, '') 
				from BPSeleClassCodes 
				where StateCd in ('99', @StateCd) 
					and LocationId in ('99', @LocationId) 
					and MasterCompanyId in ('99', @MasterCompanyId) 
					and PolicyCompanyId in ('99', @PolicyCompanyId) 
					and rtrim(ClassCd) = rtrim(@ClassCd) 
					and rtrim(ClassDescription) = rtrim(@ClassDes) 
					and StateCd = @StateCd
					and HostCd=@Host
			   END
		  /* fsit 144130 start */	   
          IF @LOB = 'BP' AND @StateCd = 'CA'
           BEGIN 
				--TP BOP CA 2010, 144444 - Make Bailee as default coverage
				
				SELECT TOP 1 @ClsCode = ClassCd, @OccupancyCd2=OccupancyCd From BOPropertyinfo Where Appid = @Appid	And LocationNbr = @LocationNumber AND StructureNbr=@BuildingNumber				
				SELECT @IsExist = Count(*) from SHCoverageDetails where Appid = @Appid And LocationNbr = @LocationNumber AND BuildingNbr=@BuildingNumber  AND CoverageCD='BAILEE'	
				IF ((@OccupancyCd2 <> 'L') AND (@IsExist = 0) AND (RTRIM(@ClsCode) = '09521' OR RTRIM(@ClsCode) = '09531' OR RTRIM(@ClsCode) = '09541' OR RTRIM(@ClsCode) = '71811'))
				Begin
					Exec SHInsertCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber, @LOB, @InsuranceLineCd, @StateCd, 'BAILEE'			
					--TP BPCA 222 11052012 START, BAILEE is default coverage. Issue is that the coverage is not 
						-- sennt to POIN if user does not touch to cov tab
						UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = 'D'
					    WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND LineOfBusinessCd = @LOB
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'	
						AND FieldNameTxt = 'BAILEE_BusinessType'
						UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = ( SELECT TOP 1 GrossSalesAmt FROM BOPropertyInfo with (nolock)
												WHERE AppId = @AppId
												AND LocationNbr = @LocationNumber 
												AND StructureNbr = @BuildingNumber 
												And InsuranceLineCd = @InsuranceLineCd)
					    WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND LineOfBusinessCd = @LOB
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'	
						AND FieldNameTxt = 'BAILEE_GrossSales'
						--TP BPCA 222 11052012 END
				End
				--TL BOP CA 2010 Post live issue 51 remove deleting automatically 
--				IF ((@IsExist <> 0) AND (RTRIM(@ClsCode) <> '09521' AND RTRIM(@ClsCode) <> '09531' AND RTRIM(@ClsCode) <> '09541' AND RTRIM(@ClsCode) <> '71811'))
--					Exec SHDeleteCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber, @LOB, @InsuranceLineCd, 'BAILEE'			
--
--				IF ((@IsExist <> 0) AND ((@OccupancyCd2 = 'L') AND (RTRIM(@ClsCode) = '09521' OR RTRIM(@ClsCode) = '09531' OR RTRIM(@ClsCode) = '09541' OR RTRIM(@ClsCode) = '71811')))
--					Exec SHDeleteCoverage @Appid, @Host, @LocationId, @MasterCompanyId, @PolicyCompanyId, @LocationNumber, @BuildingNumber, @LOB, @InsuranceLineCd, 'BAILEE'							
				--TL BOP CA 2010 Post live issue 51 remove deleting automatically 
				--TP BOP CA 2010, 144444 - Make Bailee as default coverage
				--TL BOP CA 2010, 144196 - Auto selecting Medical Expense Exclusion - Starts			
				--SELECT @SwimmingPoolInd=LargeRestaurantInd From BOPropertyinfo Where Appid = @Appid	And LocationNbr = @LocationNumber AND StructureNbr=@BuildingNumber	--TL 144196 issue 161, 162 10/30/2012
				--TL 144196 issue 161, 162 10/30/2012 Starts
				IF (RTRIM(@ClassCd) = '59999' AND RTRIM(@ClassDes) = 'Swimming Pools - Retail Only (Medical Expenses-Exlusion Endorsment BP 04 38 must be attached)')
				Begin
					Update BOPropertyinfo Set LargeRestaurantInd = 1 From BOPropertyinfo Where Appid = @Appid	And LocationNbr = @LocationNumber AND StructureNbr=@BuildingNumber	--TL 144196 issue 161, 162 10/30/2012
				End
				Else
				Begin
					Update BOPropertyinfo Set LargeRestaurantInd = 0 From BOPropertyinfo Where Appid = @Appid	And LocationNbr = @LocationNumber AND StructureNbr=@BuildingNumber
				End
				If ((Select count(*) From BOPropertyInfo with (nolock) where AppId=@AppId and RTRIM(ClassCd) = '59999' AND RTRIM(ClassDes) = 'Swimming Pools - Retail Only (Medical Expenses-Exlusion Endorsment BP 04 38 must be attached)') > 0)
				Begin
					Update BOInsuranceLine Set MedicalExpExclusionInd = 1 where Appid=@AppId				
				End
				--TL 144196 issue 161, 162 10/30/2012 Ends
				--TL BOP CA 2010, 144196 - Auto selecting Medical Expense Exclusion - Ends
			 IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and rtrim(coverageCd)='HIRED') = 1)  	
                IF ((select count(*) from SHRemarks with (nolock) where appid=@AppId and rtrim(QuestionCd) = 'Q57' and rtrim(UnitNbr) = 'BOHIRED') = 0)  
	               BEGIN
	                 SET @UnitNumber = 'BOHIRED'
	                 INSERT INTO @UnitTable VALUES (@UnitNumber)
    				 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
		           END  
		        ELSE 
				   BEGIN
					SET @UnitNumber = 'BOHIRED'
					INSERT INTO @UnitTable VALUES (@UnitNumber)
				   END  	
			  --IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and rtrim(coverageCd)='POOL') = 1) --TL FSIT 144196 issue 162 10/31/2012
				print 'pools'
			  IF (@SwimmingPoolCntNbr > 0) --TL FSIT 144196 issue 162 10/31/2012
	            IF ((select count(*) from SHRemarks with (nolock) where appid=@AppId and rtrim(QuestionCd) = 'Q56' and rtrim(UnitNbr) = 'BOPOOL') = 0)  
	               BEGIN
	                  SET @UnitNumber = 'BOPOOL'
						print 'SHInsertStatements'
	                 INSERT INTO @UnitTable VALUES (@UnitNumber)
    				 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	                 
	               END	
	            ELSE 
				   BEGIN
					SET @UnitNumber = 'BOPOOL'
					INSERT INTO @UnitTable VALUES (@UnitNumber)
				   END                	  			
             IF (@ClassCd <> '' AND @ClassDes <> '' AND @TargetLink <> 'GetClassCd' AND @TargetLink <> 'GetClassDesc')  --DON00251A
		       BEGIN		
       				  --TL FSIT 165047 - Starts
				  /* fsit 144130 start 
			       IF (@CLassCd = '09521' or @CLassCd = '71811' or @CLassCd = '09531' or @CLassCd = '09541')
			        BEGIN
			            UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = '0'
					    WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND LineOfBusinessCd = @LOB	--TL BOP NY 2010
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'	
						AND FieldNameTxt = 'BAILEE_LimitAmt'
			        END 
			      */    
			      
				--IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and coverageCd='HIRED') = 1)
				--	 INSERT INTO @UnitTable VALUES ('BOHIRED')
				--IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and coverageCd='POOL') = 1)
				--	 INSERT INTO @UnitTable VALUES ('BOPOOL')	
				IF (select count(*) from SHCoverageDetailItems Where AppId = @AppId And FieldNameTxt='OrdLawCov1' and CoverageCd='ORDLAW' and LocationNbr = @LocationNumber AND BuildingNbr = @BuildingNumber) > 0
		           Begin				
						--TL BOP CA 2010 Post live issue 61 starts	   
					   Update SHCoverageDetailItems
					   Set FieldValueTxt = ( SELECT TOP 1 BuildingLimitAmt FROM BOPropertyInfo with (nolock)
												WHERE AppId = @AppId
												AND LocationNbr = @LocationNumber 
												AND StructureNbr = @BuildingNumber 
												And InsuranceLineCd = @InsuranceLineCd)
					   Where AppId = @AppId And FieldNameTxt='OrdLawCov1' And CoverageCd='ORDLAW'
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						--TL BOP CA 2010 Post live issue 61 ends
		           End  
				print 'SHInsertStatements'			  
				INSERT INTO @UnitTable VALUES ('BOPL')
				EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = 'BP', @UnitNbr = 'BOPL', @InsuranceLineCd = 'CBP'	--TL FSIT 144546
				--TP BPCA 2010 After Live issue 11152012 END
				IF  (@OccupancyCd <> 'X') 
				Begin 		
					INSERT INTO @UnitTable VALUES ('BOPL4')			     	
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOPL4', @InsuranceLineCd = @InsuranceLineCd
				End
				--TP BPCA 2010 After Live issue 11152012 END
				SET @UnitNumber = ''
    				--Set Unit Number based on Risk Type and Program Code
    			IF @RiskTypeCd = 'OF'
    					SET @UnitNumber = 'BOOF'
    			IF @RiskTypeCd = 'CT' 
    					SET @UnitNumber = 'BOCON'
    			IF @RiskTypeCd = 'RT' 
    					SET @UnitNumber = 'BORETAIL'
    			IF @RiskTypeCd = 'RS' 
    					SET @UnitNumber = 'BOREST'                
    			IF @RiskTypeCd = 'MH' 
    					SET @UnitNumber = 'BOMOTEL'                
    			IF @RiskTypeCd = 'GC' 
    					SET @UnitNumber = 'BOGC'   
    			IF @RiskTypeCd = 'RD'
    					SET @UnitNumber = 'BORD'	                 			                   			
    			IF @RiskTypeCd = 'DW'
    					SET @UnitNumber = 'BOWHOLE'	               
    			IF @RiskTypeCd = 'SV' 
    					SET @UnitNumber = 'BOSERV'                
    			IF @RiskTypeCd = 'SS' 
    					SET @UnitNumber = 'BOSELF'                
    			IF @RiskTypeCd = 'LD' 
    					SET @UnitNumber = 'BOLAUND1' 
				--TL BOP CA 2010 Post live issue 51 Starts
	    		/* fsit 144130 start */		
--    			IF (@CLassCd = '09521' or @CLassCd = '71811' or @CLassCd = '09531' or @CLassCd = '09541')
--			        BEGIN
--			        Set @AddBailee = 1
--			        END   
    			/*IF (@ClassCd = '09531'  or @ClassCd = '09541')
			      BEGIN  
			        SET @UnitNumber = 'BOLAUND1'
    		   	    INSERT INTO @UnitTable VALUES (@UnitNumber)
    				EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
    			  END 
    			*/     		    		    							 				  
				--IF (@CLassCd = '09521' or @CLassCd = '71811' or @CLassCd = '09531' or @CLassCd = '09541')
			    --    BEGIN
						UPDATE SHCoverageDetailItems 
						SET FieldValueTxt = ( SELECT TOP 1 GrossSalesAmt FROM BOPropertyInfo with (nolock)
												WHERE AppId = @AppId
												AND LocationNbr = @LocationNumber
												AND StructureNbr = @BuildingNumber
												And InsuranceLineCd = @InsuranceLineCd)
					    WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND LineOfBusinessCd = @LOB
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'	
						AND FieldNameTxt = 'BAILEE_GrossSales'
						declare @businessType char(1)
						Select @businessType=FieldValueTxt
						From SHCoverageDetailItems
						WHERE AppId = @AppId
						AND LocationNbr = @LocationNumber
						AND BuildingNbr = @BuildingNumber
						AND LineOfBusinessCd = @LOB
						AND InsuranceLineCd = @InsuranceLineCd
						AND CoverageCd = 'BAILEE'	
						AND FieldNameTxt = 'BAILEE_BusinessType'
						If (@businessType = 'O')
						Begin
							UPDATE SHCoverageDetailItems 
							SET FieldValueTxt = ( SELECT TOP 1 UnitDeductCd FROM BOPropertyInfo with (nolock)
													WHERE AppId = @AppId
													AND LocationNbr = @LocationNumber
													AND StructureNbr = @BuildingNumber
													And InsuranceLineCd = @InsuranceLineCd)
							WHERE AppId = @AppId
							AND LocationNbr = @LocationNumber
							AND BuildingNbr = @BuildingNumber
							AND LineOfBusinessCd = @LOB
							AND InsuranceLineCd = @InsuranceLineCd
							AND CoverageCd = 'BAILEE'	
							AND FieldNameTxt = 'BAILEE_Deductible'							
						End						
			        --END 
				--TL BOP CA 2010 Post live issue 51 Ends
			    IF @UnitNumber <> ''	
					Begin
						--TP BPCA 2010 After Live issue 11152012 START			
						IF (@UnitNumber = 'BOGC' and @OccupancyCd = 'L')
							SET @UnitNumber = ''	
						ELSE	 		
							INSERT INTO @UnitTable VALUES (@UnitNumber)			     
							EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
						 --Set Unit Number to blank and set again based on class code and description
						--TL BOP CA 2010 Post live issue 73 Starts
						IF  (@UnitNumber = 'BOMOTEL' and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) 
						Begin
						 INSERT INTO @UnitTable VALUES ('BOMOTEL1')			     
						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOMOTEL1', @InsuranceLineCd = @InsuranceLineCd								 						    
						End
						--TL BOP CA 2010 Post live issue 73 Ends
						--TP BPCA 2010 After Live issue 11142012 START
						IF  (@UnitNumber = 'BOREST' and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) 
						   Begin 		
							 INSERT INTO @UnitTable VALUES ('BOREST1')			     	
							 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOREST1', @InsuranceLineCd = @InsuranceLineCd
						   End
						IF  (@UnitNumber = 'BOMOTEL' and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) 
						   Begin 		
							 INSERT INTO @UnitTable VALUES ('BOMOTEL2')			     	
							 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOMOTEL2', @InsuranceLineCd = @InsuranceLineCd
						   End
						--TP BPCA 2010 After Live issue 11142012 END
						--PP BPCA 2010 After Live issue 11162012 START
						--After Live issue 14 11/19/12 dlh start
						IF (@OccupancyCd = 'L' OR @OccupancyCd = 'O' AND @RiskTypeCd <> 'MH')
							Begin
								INSERT INTO @UnitTable VALUES ('BOPL4')
								EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOPL4', @InsuranceLineCd = @InsuranceLineCd												
							End
						IF (@OccupancyCd = 'X'  AND @RiskTypeCd = 'MH')
							Begin
								INSERT INTO @UnitTable VALUES ('BOMOTEL1')
								EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOMOTEL1', @InsuranceLineCd = @InsuranceLineCd												
							End
--TP BPCA After Live issue 14 11202012 START    
				IF  (@UnitNumber = 'BOREST' and (@OccupancyCd = 'O' OR @OccupancyCd = 'L'))
				   Begin	
						INSERT INTO @UnitTable VALUES ('BOREST2')
						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOREST2', @InsuranceLineCd = @InsuranceLineCd
				   End
--TP BPCA After Live issue 14 11202012 END
						    
--PP BPCA After Live issue 16 11212012 END
--				IF  (@UnitNumber = 'BOREST' and (@OccupancyCd = 'O' OR @OccupancyCd = 'L'))	
--				   Begin	
--						--INSERT INTO @UnitTable VALUES ('BOREST2')
--						--EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOREST2', @InsuranceLineCd = @InsuranceLineCd				
--						INSERT INTO @UnitTable VALUES ('BOREST3')
--						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOREST3', @InsuranceLineCd = @InsuranceLineCd				
--				   End
--PP BPCA After Live issue 16 11212012 END
--TP BPCA After Live issue 14 11202012 START    				
				IF  (@UnitNumber = 'BORD' and (@OccupancyCd = 'O' OR @OccupancyCd = 'L'))
				   Begin	
						INSERT INTO @UnitTable VALUES ('BORD4')
						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BORD4', @InsuranceLineCd = @InsuranceLineCd
				   End
--TP BPCA After Live issue 14 11202012 END
--
--						IF  (@UnitNumber = 'BORD' and @OccupancyCd = 'X')	
--							Begin	
--								--INSERT INTO @UnitTable VALUES ('BORD4')
--								--EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BORD4', @InsuranceLineCd = @InsuranceLineCd				
--								INSERT INTO @UnitTable VALUES ('BORD5')
--								EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BORD5', @InsuranceLineCd = @InsuranceLineCd				
--							End
--					   --After Live issue 14 11/19/12 dlh end  
--						--PP BPCA 2010 After Live issue 11162012 END  
						 SET @UnitNumber = ''	
					End  
				IF  ((@RiskTypeCd = 'RD' /* or @RiskTypeCd ='RS'*/))	 --PP CA 2010 - After Live DAte issue 16
						Begin	
					 	  INSERT INTO @UnitTable VALUES ('BORD5')
						  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BORD5', @InsuranceLineCd = @InsuranceLineCd				
						End	
				--PP CA 2010 - After Live DAte issue 16 start 11212012
				IF  ((@RiskTypeCd = 'MH') and (@OccupancyCd = 'X'))	 --PP CA 2010 - After Live DAte issue 16
						Begin	
					 	  INSERT INTO @UnitTable VALUES ('BOMOTEL3')
						  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOMOTEL3', @InsuranceLineCd = @InsuranceLineCd				
						End	
				--PP CA 2010 - After Live DAte issue 16 end   	11212010
----				IF  (@RiskTypeCd = 'RD' or @RiskTypeCd ='RS' and @OccupancyCd = 'X' or @OccupancyCd = 'O' )	
----						Begin	
----					 	  INSERT INTO @UnitTable VALUES ('BORD5')
----						  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BORD5', @InsuranceLineCd = @InsuranceLineCd				
----						End	      				  
	    		IF @OccupancyCd <> ''
	    		   BEGIN    				    
					    IF  (@UnitNumber = 'BOMOTEL' and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) 
					       Begin 		
						     INSERT INTO @UnitTable VALUES (@UnitNumber)			     
						     EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd								 						     
							--TL BOP CA 2010 Post live issue 73 Starts
							 INSERT INTO @UnitTable VALUES ('BOMOTEL1')			     
						     EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOMOTEL1', @InsuranceLineCd = @InsuranceLineCd								 						    
							--TL BOP CA 2010 Post live issue 73 Ends
							--TP BPCA 2010 After Live issue 11142012 START
							 INSERT INTO @UnitTable VALUES ('BOMOTEL2')			     
						     EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOMOTEL2', @InsuranceLineCd = @InsuranceLineCd						     
							--TP BPCA 2010 After Live issue 11142012 END
					       End 
						--TP BPCA 2010 START 1116
					    --IF  (@RiskTypeCd = 'OF' and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) 
						IF  (@RiskTypeCd = 'OF'  and (@OccupancyCd = 'X' or @OccupancyCd = 'O'))  -- BP CA 2010 PP - After Live Date - issue 9
					       Begin 	
						     set @UnitNumber = 'BOOF1'	
						     INSERT INTO @UnitTable VALUES (@UnitNumber)			     
						     EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd							     
					       End    
						
--TP BPCA 2010 START 1121
						IF  (@RiskTypeCd = 'OF' and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) 						
					       Begin 	
						     set @UnitNumber = 'BOOF3'	
						     INSERT INTO @UnitTable VALUES (@UnitNumber)			     
						     EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd							     
					       End    
--TP BPCA 2010 END 1121
						IF  (@UnitNumber = 'BOREST' and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) 
						   Begin 		
							 INSERT INTO @UnitTable VALUES (@UnitNumber)			     
							 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd								 
							
							--TP BPCA 2010 After Live issue 11142012 START
							 INSERT INTO @UnitTable VALUES ('BOREST1')			     	
							 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOREST1', @InsuranceLineCd = @InsuranceLineCd
							--TP BPCA 2010 After Live issue 11142012 START
						   End   
						--PP BPCA 2010 After Live issue 11162012 START
--						IF  (@UnitNumber = 'BOREST' and @OccupancyCd = 'X')	
--						   Begin	
--								INSERT INTO @UnitTable VALUES ('BOREST2')
--								EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOREST2', @InsuranceLineCd = @InsuranceLineCd				
--
--								INSERT INTO @UnitTable VALUES ('BOREST3')
--								EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BOREST3', @InsuranceLineCd = @InsuranceLineCd				
--						   End
--						IF  (@UnitNumber = 'BORD' and @OccupancyCd = 'X')	
--						   Begin	
--								INSERT INTO @UnitTable VALUES ('BORD4')
--								EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BORD4', @InsuranceLineCd = @InsuranceLineCd				
--
--								INSERT INTO @UnitTable VALUES ('BORD5')
--								EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BORD5', @InsuranceLineCd = @InsuranceLineCd				
--						   End
						--PP BPCA 2010 After Live issue 11162012 START       				  	        					  
					    --fsit 144130 60 10/09/12 dlh start	
					    --if @RiskTypeCd = 'GC' 
						--TP BPCA 2010 START 1122	
						--TL BOP CA 2010 Post live issue 69, 70, 71 Starts
						if (@RiskTypeCd = 'GC')
				        BEGIN
				          SET @UnitNumber = 'BOCONV'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					    END           
						if (@RiskTypeCd = 'GC' and @OccupancyCd = 'O')
				        BEGIN
				          SET @UnitNumber = 'BOCONV1'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				          SET @UnitNumber = 'BOCONV2'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					    END           
						if (@RiskTypeCd = 'GC' and @OccupancyCd = 'X')
				        BEGIN
				          SET @UnitNumber = 'BOCONV1'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					    END           
						if (@RiskTypeCd = 'GC' and @OccupancyCd = 'L')
				        BEGIN
				          SET @UnitNumber = 'BOCONV2'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					    END           
						if (@RiskTypeCd = 'LD' and @OccupancyCd = 'O')
				        BEGIN
				          SET @UnitNumber = 'BOLAUND2'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				          SET @UnitNumber = 'BOLAUND3'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					    END           
						if (@RiskTypeCd = 'LD' and @OccupancyCd = 'X')
				        BEGIN
				          SET @UnitNumber = 'BOLAUND2'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					    END           
						if (@RiskTypeCd = 'LD' and @OccupancyCd = 'L')
				        BEGIN
				          SET @UnitNumber = 'BOLAUND3'
	   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
					      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					    END           
						--TL BOP CA 2010 Post live issue 69, 70, 71 Ends    
					    IF (@ClassCd = '60989'  or						    
						    @ClassCd = '60999'  or
						    @ClassCd = '65132'  or
						    @ClassCd = '65133'  or
						    @ClassCd = '65141'  or
						    @ClassCd = '65142'  or
						    @ClassCd = '65144'  or
						    @ClassCd = '65145'  or
						    @ClassCd = '65146'  or
						    @ClassCd = '65147'  or
						    @ClassCd = '69145')	
					       BEGIN
					          --IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and coverageCd='POOL') <> 1) --TL FSIT 144196 issue 162 10/31/2012
							  IF (@SwimmingPoolCntNbr = 0) --TL FSIT 144196 issue 162 10/31/2012
					             BEGIN
					               set @UnitNumber = 'BORD2'	
						           INSERT INTO @UnitTable VALUES (@UnitNumber)			     
						           EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd							     
						         END  
					       END	  				           					  					   
    					IF (@OccupancyCd = 'L' ) 
    					   BEGIN  
    					     if @RiskTypeCd <> 'RD' 
    					        BEGIN 
							      SET @UnitNumber = 'BOPL1'
    		   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
    						      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
    						    END      					   
    					   END    
						--TP BPCA 2010 AfterLive 11162012 
						--dlh issue 21 11/21/2012 Starts
					     if @RiskTypeCd = 'RD'
					        BEGIN 
						      SET @UnitNumber = 'BOPL3'
		   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
						      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
						    END  
						--dlh issue 21 11/21/2012 Ends
    					--IF (@OccupancyCd = 'O' or @OccupancyCd = 'X') 
						IF (@OccupancyCd <> 'X') 
    					   BEGIN  
    					      if @RiskTypeCd = 'RS' or @RiskTypeCd = 'RT' or @RiskTypeCd = 'DW' or @RiskTypeCd = 'OF'
    					        BEGIN 
							      SET @UnitNumber = 'BOPL2'
    		   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
    						      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010    						          						      
    						    END  
    						    
    					   END   
    					IF (@OccupancyCd = 'L' or @OccupancyCd = 'O') 
    					   Begin
    					    SET @UnitNumber = 'BOPL5'
    		   			    INSERT INTO @UnitTable VALUES (@UnitNumber)
    					    EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
    					   End    
    					 --fsit 144130 60 10/09/12 dlh end	  				        				
       				   
						--TP BPCA 2010 After Live issue 11152012 START
    					--IF (@UnitNumber = 'BOGC' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))	
						IF (@UnitNumber = 'BOGC' and @OccupancyCd <> 'L')
    				       Begin 								 
						     INSERT INTO @UnitTable VALUES (@UnitNumber)			     
						     EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
						     --Set Unit Number to blank and set again based on class code and description
						     SET @UnitNumber = ''	
					       End   				 
    				    --IF (@ClassCd = '59215' or @ClassCd = '59215' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
						IF ((@ClassCd = '59215' or @ClassCd = '59215' or @ClassCd = '50671') and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
    					   BEGIN  
							 SET @UnitNumber = 'BOGC1'
    		   				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					   END
						--TL BOP CA 2010 Post live issue 72 Starts
						IF (@ClassCd = '59215')
    					   BEGIN  
							 SET @UnitNumber = 'BORT4'
    		   				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd
    					   END 	
						--TL BOP CA 2010 Post live issue 72 Ends
					    IF (@ClassCd = '60989'  or						    
						    @ClassCd = '60999'  or
						    @ClassCd = '65132'  or
						    @ClassCd = '65133'  or
						    @ClassCd = '65141'  or
						    @ClassCd = '65142'  or
						    @ClassCd = '65144'  or
						    @ClassCd = '65145'  or
						    @ClassCd = '65146'  or
						    @ClassCd = '65147'  or
						    @ClassCd = '69145' and @OccupancyCd = 'L' )		      			   
    					  BEGIN
    						SET @UnitNumber = 'BORD1'
    						INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END
						
						--TP BPCA 2010 After Live item 10 11152012 
						IF ((@ClassCd = '84112' or @ClassCd = '50171' or @ClassCd = '50201' or @ClassCd = '50812' or 
    					  @ClassCd = '59425' or @ClassCd = '50261' or @ClassCd = '59992' or @ClassCd = '71877' or 
    					  @ClassCd = '50291' or @ClassCd = '59116' or @ClassCd = '59994' or @ClassCd = '50641' or 
    					  @ClassCd = '59995' or @ClassCd = '59999' or @ClassCd = '71912' or @ClassCd = '59526' or 
    					  @ClassCd = '71961' or @ClassCd = '50901' or @ClassCd = '59998' or @ClassCd = '57338' or 
    					  @ClassCd = '50812' or @ClassCd = '59425' or @ClassCd = '59992' or @ClassCd = '71877')  and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
    					   BEGIN  
							 SET @UnitNumber = 'BOWHOLE7'
    		   				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd
    					   END						
						--TP BPCA 2010 After Live item 10 11162012
						
						--TP BPCA 2010 After Live item 10 11212012		
						IF (@RiskTypeCd = 'DW' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
						   BEGIN  
							 SET @UnitNumber = 'BOWHOLE8'
    		   				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd
    					   END						
						--TP BPCA 2010 After Live item 10 11212012 
    				    IF (@ClassCd = '09531'  or
						    @ClassCd = '09541')
						  BEGIN  
							SET @UnitNumber = 'BOLAUND1'
    		   				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END	    				    
    				    IF (@RiskTypeCd = 'DW')
						  BEGIN  
							SET @UnitNumber = 'BOWHOLE1'
    		   				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
    					END	      					      									    
    				    IF(@ClassCd = '50061' or 
						  @ClassCd = '50081' or  
						  @ClassCd = '50111' or  
						  @ClassCd = '50291' or  
						  @ClassCd = '50661' or  
						  @ClassCd = '50821' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
						  BEGIN  
							SET @UnitNumber = 'BOWHOLE2'
    		   				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END	                        
    				    IF (@ClassCd = '50381')
    					   BEGIN  
							 SET @UnitNumber = 'BOWHOLE3'
    		   				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					   END 
 					    IF (@ClassCd = '50901' or  
						  @ClassCd = '50171' or  
						  @ClassCd = '50201' or  
						  @ClassCd = '50261' or  
						  @ClassCd = '50291' or  
						  @ClassCd = '50641' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
 	    				  BEGIN  
							SET @UnitNumber = 'BOWHOLE4'
    						INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END 
    					IF ((@ClassCd = '50061' or 
    					  @ClassCd = '50081' or
    					  @ClassCd = '50691' or 
    					  @ClassCd = '50813') and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) --BP CA 2010 PP After Live DAte issue 18 11212012
    					   BEGIN  
							 SET @UnitNumber = 'BOWH2'
    		   				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					   END 
    					  		   
						IF (@ClassCd = '71332'  or
						  @ClassCd = '71952'  or
						  @ClassCd = '59991'  or
						  @ClassCd = '59999' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
						  BEGIN  
							SET @UnitNumber = 'BORETAIL1'
    		   				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END	    					  
    					  
						IF ((@ClassCd = '50333' or 
						  @ClassCd = '56113' or 
						  @ClassCd = '56114' or 
						  @ClassCd = '56311' or 
						  @ClassCd = '56312' or 
						  @ClassCd = '56313' or 
						  @ClassCd = '56319' or 
						  @ClassCd = '56325' or 
						  @ClassCd = '56413' or 
						  @ClassCd = '56814' or 
						  @ClassCd = '56992' or 
						  @ClassCd = '59526' or 
						  @ClassCd = '59715' or 
						  @ClassCd = '59993' or 
						  @ClassCd = '59998' or 
						  @ClassCd = '59999' or 
--TP BPCA 2010 After Live 11162012 START
							@ClassCd = '50231' or 
							@ClassCd = '56214' or 
							@ClassCd = '56613' or 
							@ClassCd = '50321' or 
							@ClassCd = '56311' or 
							@ClassCd = '56992' or 
							@ClassCd = '50901' or 
--TP BPCA 2010 After Live 11162012 END
						  @ClassCd = '71941') and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
						  BEGIN  
							SET @UnitNumber = 'BORETAIL2'
    		   				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END
	    					  
   						IF ((@ClassCd = '53127' or 
						  @ClassCd = '55313' or  
						  @ClassCd = '56814' or  
						  @ClassCd = '56992' or  
						  @ClassCd = '57224' or 
						  @ClassCd = '57326' or 
						  @ClassCd = '57334' or 
						  @ClassCd = '57338' or 
						  @ClassCd = '59116' or 
						  @ClassCd = '59325' or 
						  @ClassCd = '59715' or 
						  @ClassCd = '59906' or 
						  @ClassCd = '59955' or 
						  @ClassCd = '59999' or 
						  @ClassCd = '71212' or 
						  @ClassCd = '71899' or 
						  @ClassCd = '71941' or 
--TP BPCA 2010 After Live 11162012 START
							@ClassCd = '50081' or 							
							@ClassCd = '50061' or 							
							@ClassCd = '50111' or 							
							@ClassCd = '57326' or 							
							@ClassCd = '50291' or 							
							@ClassCd = '57326' or 							
							@ClassCd = '59955' or 							
							@ClassCd = '50821' or 							
--TP BPCA 2010 After Live 11162012 END
						  @ClassCd = '84112') and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
						  BEGIN  
							SET @UnitNumber = 'BORETAIL3'
    						INSERT INTO @UnitTable VALUES (@UnitNumber)
    		    			EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END     					      					   
    				    IF (@ClassCd = '59685')
    					  BEGIN  
							SET @UnitNumber = 'BORETAIL4'
    		  				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    		  				 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END
   					    IF (@ClassCd = '59685')
    		               BEGIN  
			                 SET @UnitNumber = 'BORETAIL4'
    		  	             INSERT INTO @UnitTable VALUES (@UnitNumber)
    		  	             EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    			           END 
    	   			     IF ((@ClassCd = '57121' or @ClassCd = '57128') and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
    					  BEGIN  
							SET @UnitNumber = 'BORETAIL5'
    						INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END    	      
    				    IF (@ClassCd = '59993' and (@OccupancyCd = 'O' or @OccupancyCd = 'X') and RTRIM(@ClassDes) = 'Wigs - Retail only')
    					  BEGIN  
							SET @UnitNumber = 'BORETAIL6'
    		 				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END        				       			
    				    If (@ClassCd = '50812' or   
						  @ClassCd = '57338' or   
						  @ClassCd = '59116' or   
						  @ClassCd = '59425' or   
						  @ClassCd = '59526' or   
						  @ClassCd = '59992' or   
						  @ClassCd = '59994' or   
						  @ClassCd = '59995' or   
						  @ClassCd = '59998' or   
						  @ClassCd = '59999' or   
						  @ClassCd = '71877' or   
						  @ClassCd = '71912' or   
						  @ClassCd = '71961' or   
						  @ClassCd = '84112' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
						  BEGIN  
							SET @UnitNumber = 'BORETAIL7'
    						INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END 
    					IF (@ClassCd = '59526' and (@OccupancyCd = 'O' or @OccupancyCd = 'X') and RTRIM(@ClassDes) = 'Sporting Goods/Athletic Equipment Stores (Including Apparel)')
    					   BEGIN 
    					    SET @UnitNumber = 'BORETAIL8'
    						INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	    					  
    					   END 
    					IF (@ClassCd = '71912' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
    					  BEGIN  
							SET @UnitNumber = 'BORETAIL9'
    		 				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END
						
--TP BPCA 2010 After Live 11212012 START					
						IF (@RiskTypeCd = 'RT' and (@OccupancyCd = 'O' or @OccupancyCd = 'X'))
    					  BEGIN  
							SET @UnitNumber = 'BORETAIL10'
    		 				INSERT INTO @UnitTable VALUES (@UnitNumber)
    						EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					  END
--TP BPCA 2010 After Live 11212012 END  
						IF (@OccupancyCd = 'O' or @OccupancyCd = 'X') 
    					   BEGIN  
    					     if @RiskTypeCd = 'RT'
    					       Begin 
						         SET @UnitNumber = 'BORT1'
    		   			   	     INSERT INTO @UnitTable VALUES (@UnitNumber)
    					         EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					       end
    						 if @RiskTypeCd = 'CT'
    						   Begin    
    						     SET @UnitNumber = 'BOCON1'
    		   				     INSERT INTO @UnitTable VALUES (@UnitNumber)
    						     EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
                               End
    					   END 	  
    					IF (@OccupancyCd = 'O' or @OccupancyCd = 'X')
    					   BEGIN
    					     if @RiskTypeCd = 'RT'  
    					        BEGIN
    					          SET @UnitNumber = 'BORT3'
    					          INSERT INTO @UnitTable VALUES (@UnitNumber)
    						      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					        END    					       
--    					     if @RiskTypeCd = 'RD' 
--    					        BEGIN
--    					          SET @UnitNumber = 'BORD3'
--    					          INSERT INTO @UnitTable VALUES (@UnitNumber)
--    						      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	    					        
--    					        END
    					     if @RiskTypeCd = 'DW'
    					        BEGIN
    					          SET @UnitNumber = 'BOWH3'
    		   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
    						      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					        END
    					     if @RiskTypeCd = 'OF'
    					        BEGIN
    					          SET @UnitNumber = 'BOOF2'
    		   				      INSERT INTO @UnitTable VALUES (@UnitNumber)
    						      EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					        END       					         					            						         
    					   END       					  
    					IF ((@ClassCd = '71212' or 
    					  @ClassCd = '57224' or
    					  @ClassCd = '57326' or 
    					  @ClassCd = '53127'or 
    					  @ClassCd = '50925' or 
    					  @ClassCd = '50819' or 
    					  @ClassCd = '59999' or 
    					  @ClassCd = '53315' or
    					  @ClassCd = '53317') and (@OccupancyCd = 'O' or @OccupancyCd = 'X')) --BP CA 2010 PP After Live DAte issue 18 11212012
    					   BEGIN  
							 SET @UnitNumber = 'BORT2'
    		   				 INSERT INTO @UnitTable VALUES (@UnitNumber)
    						 EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	
    					   END 	    		    					       					       					   
    				END   
					--TL FSIT 144444 issue 170-174 10/30/2012 Starts
					print 'BUSINCRISK'
					Declare @RiskType varchar(10)
					Set @RiskType = (Select LookupValueCd 
					From SHSeleLookupValues with(nolock) 
					Where LookupCd = 'BUSINCRISK' 
						and rtrim(LookupValueDesc)=(Select rtrim(RiskTypeCD) from BOPropertyInfo with(nolock) 
										 where LocationNbr = @LocationNumber and StructureNbr = @BuildingNumber and AppId = @AppId ))
					UPDATE SHCoverageDetailItems 
					SET FieldValueTxt = isnull(@RiskType,'OTHER')
					WHERE AppId = @AppId
					AND LocationNbr = @LocationNumber
					AND BuildingNbr = @BuildingNumber
					AND LineOfBusinessCd = @LOB	--TL BOP NY 2010
					AND InsuranceLineCd = @InsuranceLineCd
					AND CoverageCd = 'BIEE'	
					AND FieldNameTxt = 'BIEE_TypeOfRisk'
					--TL FSIT 144444 issue 170-174 10/30/2012 Ends
				--TL FSIT 144444 issue 213 11/03/2012 Starts
				If @RiskTypeCd='RD'
					UPDATE SHCoverageDetailItems 
					SET FieldValueTxt = 'N'
					WHERE AppId = @AppId
					AND LocationNbr = @LocationNumber
					AND BuildingNbr = @BuildingNumber
					AND LineOfBusinessCd = @LOB	--TL BOP NY 2010
					AND InsuranceLineCd = @InsuranceLineCd
					AND CoverageCd = 'FINARA'	
					AND FieldNameTxt = 'FINARA_ResFineArtsCov'
				Else If @RiskTypeCd='RS'
					UPDATE SHCoverageDetailItems 
					SET FieldValueTxt = 'N'
					WHERE AppId = @AppId
					AND LocationNbr = @LocationNumber
					AND BuildingNbr = @BuildingNumber
					AND LineOfBusinessCd = @LOB	--TL BOP NY 2010
					AND InsuranceLineCd = @InsuranceLineCd
					AND CoverageCd = 'FINARA'	
					AND FieldNameTxt = 'FINARA_ApartFineArtsCov'
				--TL FSIT 144444 issue 213 11/03/2012 Ends	
/*
    				SELECT @PMACd = GroupCd , @ExcludeOptCov2Cd = ExcludeOptCov2Cd 
					FROM BPSeleClassCodes 
					WHERE ClassCd = @ClassCd
							AND HostCd = @Host 
							AND LocationId in ('99',@LocationId)
							AND MasterCompanyId in('99',@MasterCompanyId)
							AND PolicyCompanyId in ('99',@PolicyCompanyId)
							AND StateCd in ('99',@StateCd)
							AND ClassDescription = @ClassDes						
					SET @GroupClassCd = ISNULL(RTRIM(@PMACd),'')		
					---'999999' is the default class code for default questions on Prequalification screen, It will not deleted in any case.
					--GroupClassCd is the combination of PMA code and Sub Type selected on Building screen. We have questions based on groupclasscd 
					--and should not be deleted the class code belongs to groupclasscd
					IF EXISTS(SELECT 1 FROM SHStopperQuestionsRemarks with (nolock), SHSeleStopperQuestions WHERE AppId = @AppId AND LocationNbr = @LocationNumber 
									AND StructureNbr = @BuildingNumber AND SHStopperQuestionsRemarks.QuestionCd = SHSeleStopperQuestions.QuestionCd
									AND LocationId in ('99',@LocationId)
									AND MasterCompanyId in('99',@MasterCompanyId)
									AND PolicyCompanyId in ('99',@PolicyCompanyId)
									AND StateCd in ('99',@StateCd)
									AND LineOfBusinessCd=@LOB   --TL BOP NY 2010
									AND QuestionClassCd <> '999999'
									AND QuestionClassCd <> @GroupClassCd
									AND QuestionClassCd <> @ClassCd
									AND QuestionClassDes <> @ClassDes)
					BEGIN
						--Deleting questions specific to location and building, which may become obsolete because of change of class code and/or description
						DELETE FROM SHStopperQuestionsRemarks WHERE AppId = @AppId 
									AND LocationNbr = @LocationNumber 
									AND StructureNbr = @BuildingNumber
									AND QuestionCd IN (SELECT QuestionCd FROM 
															SHSeleStopperQuestions WHERE 
															LocationId in ('99',@LocationId)
															AND MasterCompanyId in('99',@MasterCompanyId)
															AND PolicyCompanyId in ('99',@PolicyCompanyId)
															AND StateCd in ('99',@StateCd)
															AND LineOfBusinessCd=@LOB   --TL BOP NY 2010
															AND QuestionClassCd <> '999999'
															AND QuestionClassCd <> @GroupClassCd
															AND QuestionClassCd <> @ClassCd
															AND QuestionClassDes <> @ClassDes)
					END
				
					SELECT TOP 1 @QLocationId=LocationId, @QMasterCompanyId=MasterCompanyId , @QPolicyCompanyId=PolicyCompanyId
					FROM SHSeleStopperQuestions with (index(IX_SHSeleStopperQuestions),nolock)								
					where HostCd = @Host and 
					(locationid=@QLocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
					(mastercompanyid=@QMasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
					(policycompanyid= @QPolicyCompanyId or policycompanyid='99') and
					(StateCd=@StateCd or StateCd='99') and LineOfBusinessCd=@LOB
					set @ctr= (select count(*) 
					from SHStopperQuestionsRemarks with (nolock) 
					Where AppId=@AppId 
					and LocationNbr = @LocationNumber 
					and	StructureNbr = @BuildingNumber )
				
					SET @ctr2 = (select count(*) 
					from shselestopperquestions with (nolock) 
						Where ltrim(rtrim(QuestionClassCd)) = ltrim(rtrim(@ClassCd))
							AND QuestionClassDes = @ClassDes
							AND HostCd = @Host 
							AND LocationId IN ('99',@LocationId)
							AND MasterCompanyId IN('99',@MasterCompanyId)
							AND PolicyCompanyId IN ('99',@PolicyCompanyId)
							AND StateCd IN ('99',@StateCd)
							and LineOfBusinessCd = @LOB)
			
					SET @ctr4 = (SELECT COUNT(*) 
					from shselestopperquestions with (nolock) 
						Where LTRIM(RTRIM(QuestionClassCd)) = LTRIM(RTRIM(@GroupClassCd))
							AND HostCd = @Host 
							AND LocationId IN ('99',@LocationId)
							AND MasterCompanyId IN('99',@MasterCompanyId)
							AND PolicyCompanyId IN ('99',@PolicyCompanyId)
							AND StateCd IN ('99',@StateCd)
							and LineOfBusinessCd = @LOB)
			
					SET @ctr3 = (select count(*) 
						from shselestopperquestions with (nolock) 
						Where QuestionClassCd = '999999'
							AND HostCd = @Host 
							AND LocationId IN ('99',@LocationId)
							AND MasterCompanyId IN('99',@MasterCompanyId)
							AND PolicyCompanyId IN ('99',@PolicyCompanyId)
							AND StateCd IN ('99',@StateCd)
							AND LineOfBusinessCd = @LOB)
					IF ((@ctr <> 0 ) and (@ctr < @ctr2 + @ctr3 + @ctr4))        
				     BEGIN
					   print 'Inserting Specific Class Code Questions'
					   EXEC @status = SHInsertStopperQuestions @AppId=@AppId, @HostCd=@Host, @LocationId=@QLocationId, @PolicyCompanyId=@QPolicyCompanyId, 
						@MasterCompanyId=@QMasterCompanyId, @LineOfBusinessCd=@LOB, @StateCd=@StateCd 
						,@LocationNbr = @LocationNumber 
						,@StructureNbr = @BuildingNumber 						
						,@ShowGeneric = @ShowGeneric  
						,@ClassCode = @ClassCd
						,@InsertClassCdOnly = 1 
						,@GroupClassCd = @GroupClassCd 
						,@ClassDes = @ClassDes 
				     END
				
					IF @ctr = 0 and @AppId<>''
				    BEGIN
					  print 'Inserting Generic Class Code Questions'
					  EXEC @status = SHInsertStopperQuestions @AppId=@AppId, @HostCd=@Host, @LocationId=@QLocationId, @PolicyCompanyId=@QPolicyCompanyId, 
					  @MasterCompanyId=@QMasterCompanyId, @LineOfBusinessCd=@LOB, @StateCd=@StateCd
					  ,@LocationNbr = @LocationNumber
					  ,@StructureNbr =@BuildingNumber
					  ,@ShowGeneric = @ShowGeneric
					  ,@ClassCode = @ClassCd
					  ,@GroupClassCd = @GroupClassCd
					  ,@ClassDes = @ClassDes
				    END
				  
					IF @status=98
				    BEGIN
					  RAISERROR ('Failed to Insert responses into SHStopperQuestionsRemarks for following key: %s. Verify the key is found in SHSeleStopperQuestions.', 16, 1, @Host, @QLocationId, @QPolicyCompanyId, @QMasterCompanyId, @LOB, @StateCd) 
				    END
*/
    			END	
    	   END		    		   	
		  /* fsit 144130 end */
	      --DON00057 Begin
	      --IF (@ClassCd <> '' AND @ClassDes <> '' AND @TargetLink = '')  --DON00251A
          IF @LOB = 'BP' AND @StateCd = 'NY'
           BEGIN
              SELECT TOP 1 @ClsCode = ClassCd, @OccupancyCd2=OccupancyCd From BOPropertyinfo Where Appid = @Appid	And LocationNbr = @LocationNumber AND StructureNbr=@BuildingNumber	
			  IF (@ClassCd <> '' AND @ClassDes <> '' AND @TargetLink <> 'GetClassCd' AND @TargetLink <> 'GetClassDesc')  --DON00251A
				BEGIN
				  INSERT INTO @UnitTable VALUES ('BPPL')            
				  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPPL', @InsuranceLineCd = @InsuranceLineCd --TP BOP NY 2010, Change class code clear statement questions 
				  IF @OccupancyCd2= 'L'
				     Begin
					   INSERT INTO @UnitTable VALUES ('BPPL1')
					    EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPPL1', @InsuranceLineCd = @InsuranceLineCd --TP BOP NY 2010, Change class code clear statement questions 
				     End	
				  IF @RiskTypeCd = 'OF'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPOFFICE')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPOFFICE', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'CT'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'RT'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPRETAIL')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'RS'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPREST')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPREST', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'MT'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPMOTEL')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPMOTEL', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'CV'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCONV')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCONV', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'AP'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPAPART')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPAPART', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'WS'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPWHOLE')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPWHOLE', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'SV'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPSERV')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPSERV', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END
				  IF @RiskTypeCd = 'SS'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPSELF')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPSELF', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END            
				  IF @RiskTypeCd = 'LD'
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPLAUND')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPLAUND', @InsuranceLineCd = @InsuranceLineCd --TL BOP NY 2010                
					END            
				  IF ((@ClassCd = '74221' AND @ClassDes = 'CARPENTRY-INTERIOR-OFFICE') OR (@ClassCd = '74231' AND @ClassDes = 'CARPENTRY-INTERIOR-SHOP'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON2')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON2', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END
				  IF ((@ClassCd = '74161' AND @ClassDes = 'CARPENTRY-CONST/RESIDENTIAL-NOT EXCEEDING 3 STORIES-OFFICE') OR (@ClassCd = '74171' AND @ClassDes = 'CARPENTRY-CONST/RESIDENTIAL-NOT EXCEEDING 3 STORIES-SHOP)'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON3')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON3', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END
				  IF ((@ClassCd = '74541' AND @ClassDes = 'ELECTRICAL WORK-WITHIN BUILDINGS-SHOP') OR (@ClassCd = '74561' AND @ClassDes = 'ELECTRICAL WORK-WITHIN BUILDINGS-OFFICE'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON4')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON4', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END
				  IF ((@ClassCd = '74891' AND @ClassDes = 'LANDSCAPE GARDENING-NO TREE REMOVAL OR EXCAVATION-OFFICE') OR (@ClassCd = '74901' AND @ClassDes = 'LANDSCAPE GARDENING-NO TREE REMOVAL OR EXCAVATION-SHOP'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON7')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON7', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					  INSERT INTO @UnitTable VALUES ('BPCON8')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON8', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					  INSERT INTO @UnitTable VALUES ('BPCON5')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON5', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '75601' AND @ClassDes = 'PAINTING-EXTERIOR-BLDGS/STRUCTURES-3 STORIES OR LESS-OFFICE') OR (@ClassCd = '75611' AND @ClassDes = 'PAINTING-EXTERIOR-BLDGS/STRUCTURES-3 STORIES OR LESS-SHOP') OR (@ClassCd = '75631' AND @ClassDes = 'PAINTING-INTERIOR BUILDINGS OR STRUCTURES-OFFICE') OR (@ClassCd = '75641' AND @ClassDes = 'PAINTING-INTERIOR BUILDINGS OR STRUCTURES-SHOP'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON9')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON9', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '75511' AND @ClassDes = 'MASONRY-OFFICE') OR (@ClassCd = '75521' AND @ClassDes = 'MASONRY-SHOP'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON6')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '75781' AND @ClassDes = 'PLUMBING-COMMERCIAL (NOT INDUSTRIAL)-OFFICE') OR (@ClassCd = '75791' AND @ClassDes = 'PLUMBING-COMMERCIAL (NOT INDUSTRIAL)-SHOP') OR (@ClassCd = '75811' AND @ClassDes = 'PLUMBING-RESIDENTIAL OR DOMESTIC-OFFICE') OR (@ClassCd = '75821' AND @ClassDes = 'PLUMBING-RESIDENTIAL OR DOMESTIC-SHOP'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON7')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON7', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					  INSERT INTO @UnitTable VALUES ('BPCON5')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON5', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '75931' AND @ClassDes = 'ROOFING-RESIDENTIAL-OFFICE') OR (@ClassCd = '75941' AND @ClassDes = 'ROOFING-RESIDENTIAL-SHOP'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON10')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON10', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '71332' AND @ClassDes = 'BARBER SHOPS') OR (@ClassCd = '71952' AND @ClassDes = 'BEAUTY PARLORS AND HAIR STYLING SALONS (INCL NAIL SALONS)') OR (@ClassCd = '71952' AND @ClassDes = 'NAIL SALONS') OR (@ClassCd = '50171' AND @ClassDes = 'BARBER/BEAUTY SHOP SUPPLIES DISTRIBUTORS (NO RE-PACKAGING)'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPSERV1')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPSERV1', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '50571' AND @ClassDes = 'HEARING AID - DISTRIBUTORS') OR (@ClassCd = '59974' AND @ClassDes = 'HEARING AID RETAIL') OR (@ClassCd = '59954' AND @ClassDes = 'OPTICAL GOODS - RETAIL') OR (@ClassCd = '50721' AND @ClassDes = 'OPTICAL GOODS - DISTRIBUTORS'))	--TL FSIT 147649
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPRETAIL1')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL1', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				--TL FSIT 147649 Starts	
				  IF ((@ClassCd = '59999' AND @ClassDes = 'STRAW AND STRAW PRODUCTS-RETAIL ONLY'))	
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPRETAIL2')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL2', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END
				  IF ((@ClassCd = '53315' AND @ClassDes = 'VARIETY STORES DISCOUNT HOUSES') OR (@ClassCd = '53317' AND @ClassDes = 'VARIETY STORES FIVE AND TEN CENT STORES'))	
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPRETAIL3')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL3', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END
				  IF ((@ClassCd = '50171' AND @ClassDes = 'BARBER/BEAUTY SHOP SUPPLIES DISTRIBUTORS (NO RE-PACKAGING)'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPRETAIL4')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL4', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END 
				  IF ((@ClassCd = '71332' AND @ClassDes = 'BARBER SHOPS') OR (@ClassCd = '71952' AND @ClassDes = 'BEAUTY PARLORS AND HAIR STYLING SALONS (INCL NAIL SALONS)') OR (@ClassCd = '71952' AND @ClassDes = 'NAIL SALONS'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPSERV2')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPSERV2', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END       
       
				--TL FSIT 147649 Ends
				--TL FSIT 148230 Starts
				IF ((@ClassCd = '50291' AND @ClassDes = 'DRUG DISTRIBUTORS (NO RE-PACKAGING OR RE-LABELING)') OR (@ClassCd = '59116' AND @ClassDes = 'DRUGSTORES'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL5')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL5', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				IF ((@ClassCd = '54127' AND @ClassDes = 'GROCERY STORES WITH AN AREA AT LEAST 4000 SQUARE FEET') OR (@ClassCd = '54127' AND @ClassDes = 'SUPERMARKETS WITH AN AREA AT LEAST 4000 SQUARE FEET') OR (@ClassCd = '54127' AND @ClassDes = 'HEALTH OR NATURAL FOOD STORES-AREA AT LEAST 4000 SQ FT'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL6')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				IF ((@ClassCd = '54136' AND @ClassDes = 'SUPERMARKETS WITH AN AREA LESS THAN 4000 SQUARE FEET') OR (@ClassCd = '54136' AND @ClassDes = 'HEALTH OR NATURAL FOOD STORES-AREA LESS THAN 4000 SQ FT'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL6')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				IF ((@ClassCd = '50671' AND @ClassDes = 'MEAT,FISH,POULTRY OR SEAFOOD DISTRIBUTORS-POULTRY') OR (@ClassCd = '50671' AND @ClassDes = 'MEAT,FISH,POULTRY OR SEAFOOD DISTRIBUTORS-FISH OR SEAFOOD') OR (@ClassCd = '50671' AND @ClassDes = 'MEAT,FISH,POULTRY OR SEAFOOD DISTRIBUTORS-MEAT'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL6')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				IF ((@ClassCd = '54216' AND @ClassDes = 'MEAT,FISH,POULTRY OR SEAFOOD RETAIL-FISH OR SEAFOOD') OR (@ClassCd = '54216' AND @ClassDes = 'MEAT,FISH,POULTRY OR SEAFOOD RETAIL-MEAT OR POULTRY'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL6')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				IF ((@ClassCd = '53127' AND @ClassDes = 'DEPARTMENT STORES'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL6')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				IF ((@ClassCd = '54315' AND @ClassDes = 'FRUIT OR VEGETABLE DEALERS'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL6')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				IF ((@ClassCd = '50391' AND @ClassDes = 'FRUIT OR VEGETABLE DISTRIBUTORS'))
				BEGIN
					INSERT INTO @UnitTable VALUES ('BPRETAIL6')
					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPRETAIL6', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
				END        
				--TL FSIT 148230 Ends    
				  IF ((@ClassCd = '71912' AND @ClassDes = 'PRINTING'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPPRINT')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPPRINT', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '65132' AND @ClassDes = 'APARTMENT BLDG-OVER 4 FAMILIES WITH NO MERC OR OFFICE OCC') OR (@ClassCd = '65132' AND @ClassDes = 'BOARDING HOUSES/ROOMS NO MERCANTILE OR OFFICE OCCUPANCY') OR (@ClassCd = '65132' AND @ClassDes = 'TOWNHOUSE/SIMILAR ASSN-OVER 4 FAMILIES W/NO MERC/OFFICE OCC') OR (@ClassCd = '65141' AND @ClassDes = 'DWELLINGS-3 OR 4 FAMILY (LESSOR''S RISK ONLY) NO MERC OCC'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPAPART1')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPAPART1', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END  
				  --fsit 149288 start dlh 4/30/13
    			  IF ((@ClassCd = '65142' AND @ClassDes = 'APARTMENT BLDG-4 FAMILIES OR FEWER, W/ MERC OR OFFICE OCC')     					 
    					 OR (@ClassCd = '65142' AND @ClassDes = 'TOWNHOUSE/SIMILAR ASSN-4 FAM OR FEWER,WITH MERC/OFFICE OCC') 
    					 OR (@ClassCd = '65142' AND @ClassDes = 'DWELLINGS-3 OR 4 FAMILY (LESSORS RISK ONLY) WITH MERC OCC'))    					 
    				BEGIN
    					SET @UnitNumber = 'BPAPART2'
    					INSERT INTO @UnitTable VALUES (@UnitNumber)
    					EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = @UnitNumber, @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
    				END    
    			  --fsit 149288 end dlh 4/30/13   	      
				  IF ((@ClassCd = '74011' AND @ClassDes = 'AIR CONDITIONING SYST-DEALER & INSTALL/SERVICE/REPAIR-OFFICE') OR (@ClassCd = '74021' AND @ClassDes = 'AIR CONDITIONING SYST-DEALER-INSTALL/SERVICE/REPAIR-SHOP') OR (@ClassCd = '74771' AND @ClassDes = 'HEAT/AIR COND SYST-DEALERS-INSTALL/REPAIR-NO LP GAS-OFFICE') OR (@ClassCd = '74781' AND @ClassDes = 'HEAT/AIR COND SYST-DEALERS-INSTALL/REPAIR-NO LP GAS-SHOP'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON1')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON1', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END        
				  IF ((@ClassCd = '69161' AND @ClassDes = 'MOTELS WITH LIMITED COOKING RESTAURANTS') OR (@ClassCd = '69171' AND @ClassDes = 'MOTELS WITH FAST FOOD RESTAURANTS'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPMOTEL1')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPMOTEL1', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END
				  --TL FSIT 141898 - Starts
				  IF ((@ClassCd = '75871' AND @ClassDes = 'REFRIGERATION SYST-DEALERS-INSTALL/REPAIR-COMML-OFFICE') OR (@ClassCd = '75881' AND @ClassDes = 'REFRIGERATION SYST-DEALERS-INSTALL/REPAIR-COMML-SHOP') OR (@ClassCd = '50581' AND @ClassDes = 'HEATING/COMBINED HEATING & AIR COND EQUIPMENT-DISTRIBUTORS') OR (@ClassCd = '50801' AND @ClassDes = 'STATIONERY/PAPER PRODUCTS DISTRIBUTORS-PAPER WHOLESALING'))
					BEGIN
					  INSERT INTO @UnitTable VALUES ('BPCON11')
					  EXEC SHInsertStatements @Appid = @AppId, @HostCd = @Host, @LineOfBusinessCd = @LOB, @UnitNbr = 'BPCON11', @InsuranceLineCd = @InsuranceLineCd	--TL BOP NY 2010
					END			
				  --TL FSIT 141898 - Ends        
		       
					--DON00167 Begin
				SELECT @PMACd = GroupCd , @ExcludeOptCov2Cd = ExcludeOptCov2Cd 
				FROM BPSeleClassCodes 
				WHERE ClassCd = @ClassCd
							AND HostCd = @Host 
							AND LocationId in ('99',@LocationId)
							AND MasterCompanyId in('99',@MasterCompanyId)
							AND PolicyCompanyId in ('99',@PolicyCompanyId)
							AND StateCd in ('99',@StateCd)
							AND ClassDescription = @ClassDes						
				SET @GroupClassCd = ISNULL(RTRIM(@PMACd),'')		
				  ---'999999' is the default class code for default questions on Prequalification screen, It will not deleted in any case.
				  --GroupClassCd is the combination of PMA code and Sub Type selected on Building screen. We have questions based on groupclasscd 
				  --and should not be deleted the class code belongs to groupclasscd
				IF EXISTS(SELECT 1 FROM SHStopperQuestionsRemarks with (nolock), SHSeleStopperQuestions WHERE AppId = @AppId AND LocationNbr = @LocationNumber 
									AND StructureNbr = @BuildingNumber AND SHStopperQuestionsRemarks.QuestionCd = SHSeleStopperQuestions.QuestionCd
									AND LocationId in ('99',@LocationId)
									AND MasterCompanyId in('99',@MasterCompanyId)
									AND PolicyCompanyId in ('99',@PolicyCompanyId)
									AND StateCd in ('99',@StateCd)
									AND LineOfBusinessCd=@LOB   --TL BOP NY 2010
									AND QuestionClassCd <> '999999'
									AND QuestionClassCd <> @GroupClassCd
									AND QuestionClassCd <> @ClassCd
									AND QuestionClassDes <> @ClassDes)
				BEGIN
						--Deleting questions specific to location and building, which may become obsolete because of change of class code and/or description
					DELETE FROM SHStopperQuestionsRemarks WHERE AppId = @AppId 
									AND LocationNbr = @LocationNumber 
									AND StructureNbr = @BuildingNumber
									AND QuestionCd IN (SELECT QuestionCd FROM 
															SHSeleStopperQuestions WHERE 
															LocationId in ('99',@LocationId)
															AND MasterCompanyId in('99',@MasterCompanyId)
															AND PolicyCompanyId in ('99',@PolicyCompanyId)
															AND StateCd in ('99',@StateCd)
															AND LineOfBusinessCd=@LOB   --TL BOP NY 2010
															AND QuestionClassCd <> '999999'
															AND QuestionClassCd <> @GroupClassCd
															AND QuestionClassCd <> @ClassCd
															AND QuestionClassDes <> @ClassDes)
				END
					--DON00167 End	
					--DON00251 Starts
				SELECT TOP 1 @QLocationId=LocationId, @QMasterCompanyId=MasterCompanyId , @QPolicyCompanyId=PolicyCompanyId
				FROM SHSeleStopperQuestions with (index(IX_SHSeleStopperQuestions),nolock)								
				where HostCd = @Host and 
					(locationid=@QLocationId or (locationid='99' and mastercompanyid='99' and policycompanyid='99')) and 
					(mastercompanyid=@QMasterCompanyId or (mastercompanyid='99' and policycompanyid='99')) and 
					(policycompanyid= @QPolicyCompanyId or policycompanyid='99') and
					(StateCd=@StateCd or StateCd='99') and LineOfBusinessCd=@LOB
				set @ctr= (select count(*) 
					from SHStopperQuestionsRemarks with (nolock) 
					Where AppId=@AppId 
					and LocationNbr = @LocationNumber 
					and	StructureNbr = @BuildingNumber )
				
				SET @ctr2 = (select count(*) 
					from shselestopperquestions with (nolock) 
						Where ltrim(rtrim(QuestionClassCd)) = ltrim(rtrim(@ClassCd))
							AND QuestionClassDes = @ClassDes
							AND HostCd = @Host 
							AND LocationId IN ('99',@LocationId)
							AND MasterCompanyId IN('99',@MasterCompanyId)
							AND PolicyCompanyId IN ('99',@PolicyCompanyId)
							AND StateCd IN ('99',@StateCd)
							and LineOfBusinessCd = @LOB)
			
				SET @ctr4 = (SELECT COUNT(*) 
					from shselestopperquestions with (nolock) 
						Where LTRIM(RTRIM(QuestionClassCd)) = LTRIM(RTRIM(@GroupClassCd))
							AND HostCd = @Host 
							AND LocationId IN ('99',@LocationId)
							AND MasterCompanyId IN('99',@MasterCompanyId)
							AND PolicyCompanyId IN ('99',@PolicyCompanyId)
							AND StateCd IN ('99',@StateCd)
							and LineOfBusinessCd = @LOB)
			
				SET @ctr3 = (select count(*) 
						from shselestopperquestions with (nolock) 
						Where QuestionClassCd = '999999'
							AND HostCd = @Host 
							AND LocationId IN ('99',@LocationId)
							AND MasterCompanyId IN('99',@MasterCompanyId)
							AND PolicyCompanyId IN ('99',@PolicyCompanyId)
							AND StateCd IN ('99',@StateCd)
							AND LineOfBusinessCd = @LOB)
				if ((@ctr <> 0 ) and (@ctr < @ctr2 + @ctr3 + @ctr4))        
				     BEGIN
					   print 'Inserting Specific Class Code Questions'
					   EXEC @status = SHInsertStopperQuestions @AppId=@AppId, @HostCd=@Host, @LocationId=@QLocationId, @PolicyCompanyId=@QPolicyCompanyId, 
						@MasterCompanyId=@QMasterCompanyId, @LineOfBusinessCd=@LOB, @StateCd=@StateCd 
						,@LocationNbr = @LocationNumber 
						,@StructureNbr = @BuildingNumber 
						--,@ShowGeneric = 1   --DON00251A
						,@ShowGeneric = @ShowGeneric  --DON00251A
						,@ClassCode = @ClassCd
						,@InsertClassCdOnly = 1 
						,@GroupClassCd = @GroupClassCd 
						,@ClassDes = @ClassDes 
				     END
				  --DON00251A Starts
				If @ctr = 0 and @AppId<>''
				    BEGIN
					  print 'Inserting Generic Class Code Questions'
					  EXEC @status = SHInsertStopperQuestions @AppId=@AppId, @HostCd=@Host, @LocationId=@QLocationId, @PolicyCompanyId=@QPolicyCompanyId, 
					  @MasterCompanyId=@QMasterCompanyId, @LineOfBusinessCd=@LOB, @StateCd=@StateCd
					  ,@LocationNbr = @LocationNumber
					  ,@StructureNbr =@BuildingNumber
					  ,@ShowGeneric = @ShowGeneric
					  ,@ClassCode = @ClassCd
					  ,@GroupClassCd = @GroupClassCd
					  ,@ClassDes = @ClassDes
				    END
				  --DON00251A Ends
			    If @status=98
				    BEGIN
					  RAISERROR ('Failed to Insert responses into SHStopperQuestionsRemarks for following key: %s. Verify the key is found in SHSeleStopperQuestions.', 16, 1, @Host, @QLocationId, @QPolicyCompanyId, @QMasterCompanyId, @LOB, @StateCd) 
				    END
				  --DON00251 Ends
	            END		
	       END
	       --DON00057 End    
           FETCH NEXT FROM CurBuildList into @BuildingNumber, @LocationNumber , @ClassCd, @ClassDes
       END --end cursor 
       CLOSE CurBuildList
       DEALLOCATE CurBuildList
       IF @LOB = 'BP' and @StateCd ='NY'
          BEGIN 
	        DELETE FROM SHRemarks 
		    WHERE AppId = @AppId 
		    AND UnitNbr NOT IN (SELECT DISTINCT UnitNumber FROM @UnitTable) 
		    AND UnitNbr LIKE 'BP%'
	        DELETE FROM SHRemarksDetail 
		    WHERE AppId = @AppId 
		    AND UnitNbr NOT IN (SELECT DISTINCT UnitNumber FROM @UnitTable) 
		    AND UnitNbr LIKE 'BP%' 
		  END  
	   IF @LOB = 'BP' and @StateCd ='CA'
          BEGIN 
	        DELETE FROM SHRemarks 
		    WHERE AppId = @AppId 
		    AND UnitNbr NOT IN (SELECT DISTINCT UnitNumber FROM @UnitTable) 
		    AND UnitNbr LIKE 'BO%'
	        DELETE FROM SHRemarksDetail 
		    WHERE AppId = @AppId 
		    AND UnitNbr NOT IN (SELECT DISTINCT UnitNumber FROM @UnitTable) 
		    AND UnitNbr LIKE 'BO%' 	
		END    			
    END
--TL BOP NY 2010 Ends    
    --DON00251 Starts
     IF @LOB = 'BP' and @StateCd ='CA'
          BEGIN 
				IF EXISTS(SELECT 1 FROM BOPropertyInfo with (nolock)
							WHERE AppId = @AppId
							AND RiskTypeCd = 'RS')		
				BEGIN
					Update BOInsuranceLine SET FireLiabilityAmt = PerOccurrenceAmt
					WHERE AppId = @AppId		
				END
				ELSE
				BEGIN
					Update BOInsuranceLine SET FireLiabilityAmt = 300000
					WHERE AppId = @AppId
				END
     END
	
   /*fsit 240038 start */    
	IF @LOB = 'BP' and @StateCd ='NY'
	   Begin
	       declare @DedAmount varchar(6)         
           if (select count(*) from ShCoverageDetailItems with (nolock)
                                     where appid = @appid and rtrim(Coveragecd) = 'EQBDN' and rtrim(FieldNameTxt) = 'DedAmount' and locationnbr = @LocationNumber and buildingnbr =@BuildingNumber  ) <> 0
			  Begin
			   set @DedAmount = (select UnitDeductCd from BOPropertyInfo with (nolock) where appid = @Appid and locationnbr = @LocationNumber and Structurenbr = @BuildingNumber)			   
			   update ShCoverageDetailItems set FieldValueTxt = @DedAmount where appid = @Appid and rtrim(Coveragecd) = 'EQBDN' and rtrim(FieldNameTxt) = 'DedAmount' and locationnbr = @LocationNumber and buildingnbr = @BuildingNumber 
			  End
       end 
    
/*fsit 240038 end */
    --DON00251 Ends
/* check for error on update */
Set @error = @@error
If @error <> 0
 Return @error

GRANT EXECUTE ON [dbo].[BPUpdateBuildingInfo] TO [isol_app] AS [dbo]

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHRetrieveBuildingCoverageParms]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHRetrieveBuildingCoverageParms]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

CREATE PROCEDURE [dbo].[SHRetrieveBuildingCoverageParms]
	@AppId 				CHAR(20)	= NULL
	, @HostCd 			CHAR(2)		= 'PT'
	, @LocationId 		CHAR(2)		= '99'
	, @MasterCompanyId 	CHAR(2)		= '99'
	, @PolicyCompanyId 	CHAR(2)		= '99'
	, @StateCd 			CHAR(2)		= '99'
	, @LineOfBusinessCd CHAR(3)		= NULL 
	, @InsuranceLineCd 	CHAR(3)		= NULL 
	, @LocationNbr 		SMALLINT	= 0
	, @BuildingNbr 		SMALLINT	= 0 
	, @FieldListInd		BIT			= 0
	, @IsUnderwriterUser bit = 1		--TL FSIT 147450
AS
	SET NOCOUNT ON
	DECLARE @error INT , @TempStateCd CHAR(2)
	--don-2576 begin
	Declare @effdate as date
	select @effdate=effectivedate from shplaninfo where appid=@AppId
	--don-2576 end
	IF @LineOfBusinessCd = 'CP'
		SET @TempStateCd = (SELECT StateCd FROM CPPropertyLocation 
							WHERE Appid  = @AppId AND LocationNbr = @LocationNbr)
	ELSE IF @LineOfBusinessCd = 'BO'
		SET @TempStateCd = (SELECT StateCd FROM SHPropertyLocation with (nolock)
							WHERE Appid  = @AppId AND LocationNbr = @LocationNbr)
	IF LEN(RTRIM(@TempStateCd)) > 0
		SET @StateCd = @TempStateCd
	--TL FSIT 147450 Starts
	Declare @BuildingCoverages Table (CoverageCd char(6))
	If @IsUnderwriterUser = 1
	Begin
		Insert into @BuildingCoverages
		SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @HostCd
										AND LocationId IN ('99', @LocationId)
										AND MasterCompanyId IN ('99', @MasterCompanyId)
										AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
										AND LineOfBusinessCd = @LineOfBusinessCd
										AND InsuranceLineCd = @InsuranceLineCd
										AND StateCd IN ('99' , @StateCd)
										AND InsuranceLineCovInd = 2
	End
	else
	Begin
		Insert into @BuildingCoverages
		SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @HostCd
										AND LocationId IN ('99', @LocationId)
										AND MasterCompanyId IN ('99', @MasterCompanyId)
										AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
										AND LineOfBusinessCd = @LineOfBusinessCd
										AND InsuranceLineCd = @InsuranceLineCd
										AND StateCd IN ('99' , @StateCd)
										AND InsuranceLineCovInd = 2
										AND IsAppliedForAgent = 1	
	End
	--TL FSIT 147450 Ends
	IF @FieldListInd = 1 
	BEGIN
		SELECT     
			  A.CoverageParmFieldId
			, A.CoverageParmTypeCd
		FROM SHSeleCovParms AS A LEFT JOIN
			SHCoverageDetailItems AS C with (nolock)
				ON A.LineOfBusinessCd = C.LineOfBusinessCd 
				AND A.InsuranceLineCd = C.InsuranceLineCd 
				AND A.CoverageCd = C.CoverageCd 
				AND A.CoverageParmFieldId = C.FieldNameTxt
				AND C.AppId = @AppId 
				AND C.LocationNbr = @LocationNbr
				AND C.BuildingNbr = @BuildingNbr
				AND C.CoverageSequenceNbr = 1
			WHERE   A.HostCd = @HostCd
				AND A.LocationId IN ('99', @LocationId)
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.LineOfBusinessCd = @LineOfBusinessCd
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND A.StateCd IN ('99', @StateCd)
				--TL FSIT 147450 Starts
				--AND RTRIM(A.CoverageCd) IN (SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @HostCd
				--									AND InsuranceLineCovInd = 2 AND InsuranceLineCd = A.InsuranceLineCd AND LineOfBusinessCd = A.LineOfBusinessCd)
				AND RTRIM(A.CoverageCd) IN (SELECT CoverageCd FROM @BuildingCoverages)
				--TL FSIT 147450 Ends
				--TP BOP NY 2010, Add AND InsuranceLineCd = A.InsuranceLineCd AND LineOfBusinessCd = A.LineOfBusinessCd
		RETURN 0
	END
	SELECT
		  A.CoverageParmSeqNbr
		, A.CoverageParmFieldId
		, ISNULL(A.CoverageParmHeadingTxt, '') AS CoverageParmHeadingTxt
		, A.CoverageParmTypeCd
		, ISNULL(A.CoverageParmSizeTxt, '') AS CoverageParmSizeTxt
		, A.CoverageParmFieldRowNbr
		, (CASE A.MandatoryFieldsInd WHEN 1 THEN 'Y' ELSE 'N' END) AS MandatoryFieldsInd
		, ISNULL(A.CoverageParmUserTypeStatusCd, 0) AS CoverageParmUserTypeStatusCd
		, RTRIM(A.CoverageCd) AS CoverageCd
		, ISNULL(A.MandatoryFieldsEditMsgTxt, 'N') AS MandatoryFieldsEditMsgTxt
		, (SELECT COUNT(*) 
			FROM SHSeleCovParms AS B
			WHERE HostCd = @HostCd
				AND LocationId IN ('99' , @LocationId)
				AND MasterCompanyId IN ('99' , @MasterCompanyId)
				AND PolicyCompanyId IN ('99' , @PolicyCompanyId) 
				AND LineOfBusinessCd = @LineOfBusinessCd
				AND InsuranceLineCd  = @InsuranceLineCd
				AND StateCd IN ('99' , @StateCd)
				AND A.CoverageParmFieldRowNbr = CoverageParmFieldRowNbr
				--TL FSIT 147450 Starts
				--AND RTRIM(CoverageCd) IN (SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @HostCd				
				--AND LocationId IN ('99', @LocationId)
				--AND StateCd IN ('99' , @StateCd)
				--AND InsuranceLineCovInd = 2)) AS ColumnCount
				AND RTRIM(CoverageCd) IN (SELECT CoverageCd FROM @BuildingCoverages)) AS ColumnCount
				--TL FSIT 147450 Ends
		, ISNULL(A.MandatoryFieldsEditTypeCd, '') AS MandatoryFieldsEditTypeCd
		, ISNULL(C.FieldValueTxt,'') AS FieldValueTxt
		FROM SHSeleCovParms AS A 
			LEFT JOIN SHCoverageDetailItems AS C with (nolock) ON
				C.AppId = @AppId 
				AND C.LocationNbr = @LocationNbr
				AND C.BuildingNbr = @BuildingNbr				
				AND A.LineOfBusinessCd = C.LineOfBusinessCd 
				AND A.InsuranceLineCd = C.InsuranceLineCd 
				AND A.CoverageCd = C.CoverageCd 
				AND C.CoverageSequenceNbr = 1
				AND A.CoverageParmFieldId = C.FieldNameTxt				
		WHERE A.HostCd = @HostCd
			AND A.LocationId IN ('99', @LocationId)
			AND A.MasterCompanyId IN ('99', @MasterCompanyId)
			AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND A.StateCd IN ('99' , @StateCd)			
			AND A.LineOfBusinessCd = @LineOfBusinessCd
			AND A.InsuranceLineCd  = @InsuranceLineCd
			--TL FSIT 147450 Starts			
			--AND RTRIM(A.CoverageCd) IN (SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @HostCd
			--AND LocationId IN ('99', @LocationId)
			--AND MasterCompanyId IN ('99', @MasterCompanyId)
			--AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
			--AND LineOfBusinessCd = @LineOfBusinessCd
			--AND InsuranceLineCd = @InsuranceLineCd
			--AND StateCd IN ('99' , @StateCd)
			--AND InsuranceLineCovInd = 2)
			AND RTRIM(A.CoverageCd) IN (SELECT CoverageCd FROM @BuildingCoverages)
			--TL FSIT 147450 Ends
			--don-2576 begin
			and A.CoverageCd<>
			case 
			when datediff(dd,@effdate,'5/16/2020') > 0 then
				'WTRDMG'
			else
				'WATER' 
			end
			--don-2576 end 
	ORDER BY A.CoverageParmSeqNbr
	SELECT CoverageParmLookupCd, CoverageParmFieldId
		FROM SHSeleCovParms 
		WHERE HostCd = @HostCd
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99', @StateCd)
			AND LineOfBusinessCd = @LineOfBusinessCd
			AND InsuranceLineCd  = @InsuranceLineCd						
			AND CoverageParmTypeCd = 'SEL' 
			AND ISNULL(CoverageParmLookupCd , '') <> ''
			--TL FSIT 147450 Starts	
			--AND RTRIM(CoverageCd) IN (SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @HostCd
			--						AND LocationId IN ('99', @LocationId)
			--						AND MasterCompanyId IN ('99', @MasterCompanyId)
			--						AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
			--						AND LineOfBusinessCd = @LineOfBusinessCd
			--						AND InsuranceLineCd = @InsuranceLineCd
			--						AND StateCd IN ('99' , @StateCd)
			--						AND InsuranceLineCovInd = 2)
			AND RTRIM(CoverageCd) IN (SELECT CoverageCd FROM @BuildingCoverages)
			--TL FSIT 147450 Ends	
	ORDER BY CoverageParmSeqNbr
	DECLARE @CoverageParmLookupCd AS VARCHAR(30)
	DECLARE CoverageLookUP CURSOR FOR
		SELECT CoverageParmLookupCd 
			FROM SHSeleCovParms 
			WHERE HostCd = @HostCd
				AND LocationId IN ('99', @LocationId)
				AND MasterCompanyId IN ('99', @MasterCompanyId)
				AND PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND StateCd IN ('99', @StateCd)
				AND LineOfBusinessCd = @LineOfBusinessCd
				AND InsuranceLineCd  = @InsuranceLineCd			
				AND CoverageParmTypeCd = 'SEL' 
				AND ISNULL(CoverageParmLookupCd , '') <> ''
				--TL FSIT 147450 Starts
				--AND RTRIM(CoverageCd) IN (SELECT CoverageCd FROM SHSeleCoverageAttributes WHERE HostCd = @HostCd
				--																	AND LocationId IN ('99', @LocationId)
				--																	AND MasterCompanyId IN ('99', @MasterCompanyId)
				--																	AND PolicyCompanyId IN ('99', @PolicyCompanyId)			
				--																	AND LineOfBusinessCd = @LineOfBusinessCd
				--																	AND InsuranceLineCd = @InsuranceLineCd
				--																	AND StateCd IN ('99' , @StateCd)
				--																	AND InsuranceLineCovInd = 2)
				AND RTRIM(CoverageCd) IN (SELECT CoverageCd FROM @BuildingCoverages)
				--TL FSIT 147450 Ends
				
		ORDER BY CoverageParmSeqNbr
		OPEN CoverageLookUP
		FETCH NEXT FROM CoverageLookUP INTO @CoverageParmLookupCd
		WHILE @@FETCH_STATUS = 0
		BEGIN
			IF EXISTS (SELECT 1
						FROM SHSeleLookupValues
						WHERE HostCd = @HostCd
							AND LocationId IN ('99', @LocationId)
							AND MasterCompanyId IN ('99', @MasterCompanyId)
							AND PolicyCompanyId IN ('99', @PolicyCompanyId)
							AND StateCd IN ('99', @StateCd)
                            AND LineOfBusinessCd = @LineOfBusinessCd    --TL BOP NY 2010
							AND LookupCd = @CoverageParmLookupCd)
			BEGIN 
				SELECT LookupValueCd , LookupValueDesc 
				FROM SHSeleLookupValues
				WHERE HostCd = @HostCd
					AND LocationId IN ('99', @LocationId)
					AND MasterCompanyId IN ('99', @MasterCompanyId)
					AND PolicyCompanyId IN ('99', @PolicyCompanyId)
					AND StateCd IN ('99' , @StateCd)
                    AND LineOfBusinessCd = @LineOfBusinessCd    --TL BOP NY 2010
					AND LookupCd = @CoverageParmLookupCd
				ORDER BY SortOrderNbr
			END
			ELSE
				SELECT '' AS LookupValueCd , 'No Support Table Values' AS LookupValueDesc 
			FETCH NEXT FROM CoverageLookUP INTO @CoverageParmLookupCd
		END
	CLOSE CoverageLookUP
	DEALLOCATE CoverageLookUP
SET @error = @@error
 IF @error <> 0 
  RETURN @error

GRANT EXECUTE ON [dbo].[SHRetrieveBuildingCoverageParms] TO [isol_app] AS [dbo]

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHRetrieveCoverageParms]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHRetrieveCoverageParms]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

CREATE     PROCEDURE [dbo].[SHRetrieveCoverageParms]
	@AppId 				CHAR(20)	= NULL
	, @HostCd 			CHAR(2)		= 'PT'
	, @LocationId 		CHAR(2)		= '99'
	, @MasterCompanyId 	CHAR(2)		= '99'
	, @PolicyCompanyId 	CHAR(2)		= '99'
	, @StateCd 			CHAR(2)		= '99'
	--, @LineOfBusinessCd CHAR(3)		= NULL --TL BOP NY 2010
	--, @InsuranceLineCd 	CHAR(3)		= NULL --TL BOP NY 2010
	, @LineOfBusinessCd CHAR(3)		= '' --TL BOP NY 2010
	, @InsuranceLineCd 	CHAR(3)		= ''--TL BOP NY 2010    
	, @LocationNbr 		SMALLINT	= 0
	, @BuildingNbr 		SMALLINT	= 0 
	, @CoverageCd 		VARCHAR(6)	= NULL
	, @CoverageSequenceNbr SMALLINT = NULL
	, @IsUnderWriter	CHAR(1)		= 'N'
	, @FieldListInd		BIT			= 0
	, @IsUnderwriterUser bit = 1 --TL BOP CA 2010 Post live issue 67
AS
	SET NOCOUNT ON
	DECLARE @error INT , @TempStateCd CHAR(2), @TempClassCd varchar(10)
    
    if @LineOfBusinessCd='' Set @LineOfBusinessCd = (select top 1 LineOfBusiness from SHPlanInfo (nolock) where appid=@AppId)   --TL BOP NY 2010
    if @InsuranceLineCd='' Set @InsuranceLineCd = (select top 1 WCLineOfBusiness from SHPlanInfo (nolock) where appid=@AppId)   --TL BOP NY 2010
    
	
	SET @TempStateCd = (SELECT StateCd FROM CPPropertyLocation 
							WHERE Appid  = @AppId AND LocationNbr = @LocationNbr)
	IF LEN(RTRIM(@TempStateCd)) > 0
		SET @StateCd = @TempStateCd
	IF (@CoverageCd = '' OR @CoverageCd IS NULL) 
	BEGIN    
		SET @CoverageCd = (SELECT TOP 1 CoverageCd 
							FROM SHCoverageDetails WITH(NOLOCK)   
							WHERE AppId = @AppId 
								AND LocationNbr = @LocationNbr 
								AND BuildingNbr = @BuildingNbr 
								AND LineOfBusinessCd = @LineOfBusinessCd
								AND InsuranceLineCd = @InsuranceLineCd
							ORDER BY CoverageCd, CoverageSequenceNbr)  
	END
	--IF (CHARINDEX('-',@CoverageCd)) > 0 --FSIT 144444 PP
	IF ((@CoverageCd <> 'E-COMM') and ((CHARINDEX('-',@CoverageCd)) > 0)) --FSIT 144444 PP
		SET @CoverageCd = RIGHT(@CoverageCd,( LEN(@CoverageCd) - (CHARINDEX('-',@CoverageCd)+1)))
--DON00052 begin
	if rtrim(@CoverageCd) = 'PROF'
	begin
		update SHCoverageDetailItems
			set FieldValueTxt = (select GrossSalesAmt from BOPropertyInfo with (nolock) where AppId = @AppID and LocationNbr=@LocationNbr  
											and StructureNbr=@BuildingNbr and InsuranceLineCd = @InsuranceLineCd)   --TL BOP NY 2010
			where AppId = @AppID
				and rtrim(FieldNameTxt) = 'GrossSales'
				and rtrim(CoverageCd) = 'PROF'
				and LocationNbr=@LocationNbr  
				and BuildingNbr=@BuildingNbr
				--and LineOfBusinessCd = 'BO'   --TL BOP NY 2010
				--and InsuranceLineCd = 'BOP'   --TL BOP NY 2010
				and LineOfBusinessCd = @LineOfBusinessCd   --TL BOP NY 2010
				and InsuranceLineCd = @InsuranceLineCd   --TL BOP NY 2010                
	end
	/* fsit 145651 start NY Pharmacists limit moved and locked start */	
    if @InsuranceLineCd = 'NBP' 
       if (select count(*) from ShCoverageDetailItems with (nolock)
            where appid = @appid and Coveragecd = 'PHARM' and FieldNameTxt = 'PharmOccLmt') <> 0
           Begin
               declare @MedicalLmt varchar(20)
               if (Select count(*) from BOInsuranceLine with (nolock) where appid = @appid) <> 0 
                   Begin
                       set @MedicalLmt = (select PerOccurrenceAmt from BOInsuranceLine with (nolock) where appid = @appid)
					   UPDATE SHCoverageDetailItems
					   SET FieldValueTxt = @MedicalLmt
					   WHERE AppId = @AppId 						 
						AND LineOfBusinessCd = @LineOfBusinessCd 
						AND InsuranceLineCd = @InsuranceLineCd
						AND rtrim(CoverageCd) = 'PHARM'						
						AND rtrim(FieldNameTxt) = 'PharmOccLmt'
					End						
           End 
     /* fsit 145651 start NY Pharmacists limit moved and locked start */
--DON00052 end
	IF @FieldListInd = 1 
	BEGIN
		SELECT     
			  A.CoverageParmFieldId
			, A.CoverageParmTypeCd
		FROM SHSeleCovParms AS A LEFT JOIN
			SHCoverageDetailItems AS C with (nolock)
				ON A.LineOfBusinessCd = C.LineOfBusinessCd 
				AND A.InsuranceLineCd = C.InsuranceLineCd 
				AND A.CoverageCd = C.CoverageCd 
				AND A.CoverageParmFieldId = C.FieldNameTxt
				AND C.AppId = @AppId 
				AND C.LocationNbr = @LocationNbr
				AND C.BuildingNbr = @BuildingNbr
				AND C.CoverageSequenceNbr = @CoverageSequenceNbr
			WHERE   A.HostCd = @HostCd
				AND A.LocationId IN ('99', @LocationId)
				AND A.MasterCompanyId IN ('99', @MasterCompanyId)
				AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND A.LineOfBusinessCd = @LineOfBusinessCd
				AND A.InsuranceLineCd  = @InsuranceLineCd
				AND A.StateCd IN ('99', @StateCd)
				AND RTRIM(A.CoverageCd) = @CoverageCd
		RETURN 0
	END
	
	SELECT
		  A.CoverageParmSeqNbr
		, A.CoverageParmFieldId
		, ISNULL(A.CoverageParmHeadingTxt, '') AS CoverageParmHeadingTxt
		, A.CoverageParmTypeCd
		, ISNULL(A.CoverageParmSizeTxt, '') AS CoverageParmSizeTxt
		, A.CoverageParmFieldRowNbr
		, (CASE A.MandatoryFieldsInd WHEN 1 THEN 'Y' ELSE 'N' END) AS MandatoryFieldsInd
		, ISNULL(A.CoverageParmUserTypeStatusCd, 0) AS CoverageParmUserTypeStatusCd
		, RTRIM(A.CoverageCd) AS CoverageCd
		, ISNULL(A.MandatoryFieldsEditMsgTxt, 'N') AS MandatoryFieldsEditMsgTxt
		, (SELECT COUNT(*) 
			FROM SHSeleCovParms AS B
			WHERE HostCd = @HostCd
				AND LocationId IN ('99' , @LocationId)
				AND MasterCompanyId IN ('99' , @MasterCompanyId)
				AND PolicyCompanyId IN ('99' , @PolicyCompanyId) 
				AND LineOfBusinessCd = @LineOfBusinessCd
				AND InsuranceLineCd  = @InsuranceLineCd
				AND StateCd IN ('99' , @StateCd)
				AND RTRIM(CoverageCd) = @CoverageCd
				AND A.CoverageParmFieldRowNbr = CoverageParmFieldRowNbr) AS ColumnCount
		, ISNULL(A.MandatoryFieldsEditTypeCd, '') AS MandatoryFieldsEditTypeCd
		, ISNULL(C.FieldValueTxt,'') AS FieldValueTxt
		, ISNULL(A.ValidationEditCd,'') AS ValidationEditCd -- BP Ca 2010 PP issue 216
		, ISNULL(A.ValidationMandatoryFieldsEditMsgTxt,'') AS ValidationMandatoryFieldsEditMsgTxt -- BP Ca 2010 PP issue 240, 241, 242, 243, 244, 245, 246, 247, 248 - 11122012
		, ISNULL(A.ValidationMsgTxt,'') AS ValidationMsgTxt -- BP Ca 2010 PP issue 240, 241, 242, 243, 244, 245, 246, 247, 248 - 11122012
		FROM SHSeleCovParms AS A 
			LEFT JOIN SHCoverageDetailItems AS C with (nolock) ON
				C.AppId = @AppId 
				AND C.LocationNbr = @LocationNbr
				AND C.BuildingNbr = @BuildingNbr				
				AND A.LineOfBusinessCd = C.LineOfBusinessCd 
				AND A.InsuranceLineCd = C.InsuranceLineCd 
				AND A.CoverageCd = C.CoverageCd 
				AND C.CoverageSequenceNbr = @CoverageSequenceNbr
				AND A.CoverageParmFieldId = C.FieldNameTxt				
		WHERE A.HostCd = @HostCd
			AND A.LocationId IN ('99', @LocationId)
			AND A.MasterCompanyId IN ('99', @MasterCompanyId)
			AND A.PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND A.StateCd IN ('99' , @StateCd)			
			AND A.LineOfBusinessCd = @LineOfBusinessCd
			AND A.InsuranceLineCd  = @InsuranceLineCd			
			AND RTRIM(A.CoverageCd) = @CoverageCd
	ORDER BY A.CoverageParmSeqNbr
	SELECT CoverageParmLookupCd, CoverageParmFieldId, CoverageParmDefaultTxt --FSIT 144441 pp
		FROM SHSeleCovParms 
		WHERE HostCd = @HostCd
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99', @StateCd)
			AND LineOfBusinessCd = @LineOfBusinessCd
			AND InsuranceLineCd  = @InsuranceLineCd			
			AND RTRIM(CoverageCd) = @CoverageCd
			AND CoverageParmTypeCd = 'SEL' 
			AND ISNULL(CoverageParmLookupCd , '') <> ''
	ORDER BY CoverageParmSeqNbr
	DECLARE @CoverageParmLookupCd AS VARCHAR(30)
	DECLARE CoverageLookUP CURSOR FOR
		SELECT CoverageParmLookupCd 
			FROM SHSeleCovParms 
			WHERE HostCd = @HostCd
				AND LocationId IN ('99', @LocationId)
				AND MasterCompanyId IN ('99', @MasterCompanyId)
				AND PolicyCompanyId IN ('99', @PolicyCompanyId)
				AND StateCd IN ('99', @StateCd)
				AND LineOfBusinessCd = @LineOfBusinessCd
				AND InsuranceLineCd  = @InsuranceLineCd			
				AND RTRIM(CoverageCd) = @CoverageCd
				AND CoverageParmTypeCd = 'SEL' 
				AND ISNULL(CoverageParmLookupCd , '') <> ''
		ORDER BY CoverageParmSeqNbr
		OPEN CoverageLookUP
		FETCH NEXT FROM CoverageLookUP INTO @CoverageParmLookupCd
		WHILE @@FETCH_STATUS = 0
		BEGIN
			IF EXISTS (SELECT 1
						FROM SHSeleLookupValues
						WHERE HostCd = @HostCd
							AND LocationId IN ('99', @LocationId)
							AND MasterCompanyId IN ('99', @MasterCompanyId)
							AND PolicyCompanyId IN ('99', @PolicyCompanyId)
							AND StateCd IN ('99', @StateCd)
                            AND LineOfBusinessCd = @LineOfBusinessCd    --TL BOP NY 2010
							AND LookupCd = @CoverageParmLookupCd)
			BEGIN 
				--TL BOP CA 2010 Post live issue 67 Starts
				If (@IsUnderwriterUser = 1)
				Begin
					SELECT LookupValueCd , LookupValueDesc 
					FROM SHSeleLookupValues
					WHERE HostCd = @HostCd
						AND LocationId IN ('99', @LocationId)
						AND MasterCompanyId IN ('99', @MasterCompanyId)
						AND PolicyCompanyId IN ('99', @PolicyCompanyId)
						AND StateCd IN ('99' , @StateCd)
						AND LineOfBusinessCd = @LineOfBusinessCd    --TL BOP NY 2010
						AND LookupCd = @CoverageParmLookupCd
					ORDER BY SortOrderNbr
				End
				Else
				Begin
					SELECT LookupValueCd , LookupValueDesc 
					FROM SHSeleLookupValues
					WHERE HostCd = @HostCd
						AND LocationId IN ('99', @LocationId)
						AND MasterCompanyId IN ('99', @MasterCompanyId)
						AND PolicyCompanyId IN ('99', @PolicyCompanyId)
						AND StateCd IN ('99' , @StateCd)
						AND LineOfBusinessCd = @LineOfBusinessCd    --TL BOP NY 2010
						AND LookupCd = @CoverageParmLookupCd
						AND IsAppliedForAgent=1
					ORDER BY SortOrderNbr				
				End
				--TL BOP CA 2010 Post live issue 67 Ends
				--LR FSIT 137900 START
				IF (@CoverageCd = 'MONEY')
					BEGIN
						SELECT  TerritoryCd, TerritoryDes
						FROM    BPSeleMoneyTerr --issue 125 dlh
						WHERE   (StateCd = @StateCd) AND (HostCd = @HostCd) AND (LineOfBusinessCd = @LineOfBusinessCd)
						ORDER BY TerritoryDes
					END
				--LR FSIT 137900 END
				--DON-2576 begin
				If (@CoverageCd='CONDO')
					Select LocationNbr as LocationNumber, ltrim(str(LocationNbr))+ ' - ' + Address1Txt as Address1Txt --Issue # 117502
					From SHPropertyLocation with (nolock) where Appid = @Appid Order By LocationNbr	 
			--DON-2576 end
			END
			ELSE
			BEGIN
			--DON-2576 begin
				If (@CoverageCD='CONDO')
					Select LocationNbr as LocationNumber, ltrim(str(LocationNbr))+ ' - ' + Address1Txt as Address1Txt --Issue # 117502
					From SHPropertyLocation with (nolock) where Appid = @Appid Order By LocationNbr	 
			--DON-2576 end
				--FSIT 144444 start PP
				If (@CoverageCD='SPKLEQ')
				Begin
					If (@CoverageParmLookupCd='BOSeleTerritory') 
					Begin
						select Territory as Territory, ZipCode as LookupValueCd from BOSeleTerritory with (nolock) --BP CA 2010 issue with LookupValue PP
						where HostCd=@HostCd and LocationId=@LocationId and MasterCompanyId=@MasterCompanyId and PolicyCompanyId=@PolicyCompanyId and 
							LineOfBusinessCd=@LineOfBusinessCd and InsuranceLineCd=@InsuranceLineCd and (StateCd=@StateCd or StateCd='99') order by SortOrder
					End
					Else If (@CoverageParmLookupCd='BOSeleGroup') 
					Begin
						select GroupCd as [Group], Territory as LookupValueCd from BOSeleGroup with (nolock) --BP CA 2010 issue with LookupValue PP
						where HostCd=@HostCd and LocationId=@LocationId and MasterCompanyId=@MasterCompanyId and PolicyCompanyId=@PolicyCompanyId and 
							LineOfBusinessCd=@LineOfBusinessCd and InsuranceLineCd=@InsuranceLineCd and (StateCd=@StateCd or StateCd='99') order by SortOrder
					End
				End
				Else
				--FSIT 144444 end PP
				Exec BOReadOptCovParms 
					@AppId = @AppId
					, @LocationNbr = @LocationNbr
					, @BuildingNbr = @BuildingNbr
					, @LOB = @LineOfBusinessCd
					, @MasterCompanyId = @MasterCompanyId
					, @PolicyCompanyId = @PolicyCompanyId
					, @State = @StateCd
					, @InsuranceLineCd = @InsuranceLineCd
					, @Host = @HostCd
					, @LocationId = @LocationId
					, @SelectedCG = @CoverageCd
					, @SequenceNbr = 1
					, @TableName = @CoverageParmLookupCd
			END
			FETCH NEXT FROM CoverageLookUP INTO @CoverageParmLookupCd
		END
	CLOSE CoverageLookUP
	DEALLOCATE CoverageLookUP
-----Fetching Class Code information Begin
--
--	SELECT (ClassCd + '/' + ClassDes) AS ClassCd , (ClassCd + '/' + ClassDes) AS ClassDes ,@TempClassCd = ClassCd FROM	SHCoverageDetails 
--					WHERE AppId = @AppId
--									AND LocationNbr = @LocationNbr
--									AND BuildingNbr = @BuildingNbr
--									AND LineOfBusinessCd = @LineOfBusinessCd
--									AND InsuranceLineCd = @InsuranceLineCd
--									AND CoverageCd = @CoverageCd
--									AND CoverageSequenceNbr = @CoverageSequenceNbr
--
--	SELECT @TempClassCd as ClassCd
-----Fetching Class Code information end
	SELECT ScheduleItemCd, (SELECT  MAX(ScheduleItemSeqNbr) FROM SHCoverageScheduleItems with (nolock)
								WHERE AppId = @AppId
									AND LocationNbr = @LocationNbr
									AND BuildingNbr = @BuildingNbr
									AND LineOfBusinessCd = @LineOfBusinessCd
									AND InsuranceLineCd = @InsuranceLineCd
									AND CoverageCd = @CoverageCd
									AND CoverageSequenceNbr = @CoverageSequenceNbr) AS ScheduleItemCount
		, ClassSearchCd
	 FROM SHSeleCoverageAttributes 
		WHERE HostCd = @HostCd
			AND LocationId IN ('99', @LocationId)
			AND MasterCompanyId IN ('99', @MasterCompanyId)
			AND PolicyCompanyId IN ('99', @PolicyCompanyId)
			AND StateCd IN ('99' , @StateCd)
			AND LineOfBusinessCd = @LineOfBusinessCd 
			AND InsuranceLineCd = @InsuranceLineCd 
			AND CoverageCd = @CoverageCd 
SET @error = @@error
 IF @error <> 0 
  RETURN @error

GRANT EXECUTE ON [dbo].[SHRetrieveCoverageParms] TO [isol_app] AS [dbo]

IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[SHUpdateCoverageDetailItems]') AND type in (N'P', N'PC'))
DROP PROCEDURE [dbo].[SHUpdateCoverageDetailItems]

SET ANSI_NULLS ON

SET QUOTED_IDENTIFIER ON

CREATE PROCEDURE [dbo].[SHUpdateCoverageDetailItems]
	@AppId					CHAR(20)	= Null
	, @LocationNbr			SMALLINT	= 0
	, @BuildingNbr			SMALLINT	= 0
	, @LineOfBusinessCd		CHAR(3)		= NULL 
	, @InsuranceLineCd		CHAR(3)		= NULL
	, @CoverageCd			VARCHAR(6)		= Null
	, @CoverageSequenceNbr	SMALLINT	= 0
	, @FieldNameTxt			VARCHAR(30)	= NULL
	, @FieldValueTxt		VARCHAR(50)	= NULL
AS
	SET NOCOUNT ON
	DECLARE @error INTEGER	
	--don-2576 begin
	Declare @effdate as date
	select @effdate=effectivedate from shplaninfo where appid=@AppId
	print datediff(dd,@effdate,'5/16/2020')
	--if @CoverageCd='WATER' set @CoverageCd='WTRDMG'
	if datediff(dd,'5/16/2020',@effdate) >= 0 and @CoverageCd='WATER'
		set @CoverageCd='WTRDMG'

	if datediff(dd,'5/16/2020',@effdate) < 0 and @CoverageCd='WTRDMG'
		set @CoverageCd='WATER'

    if datediff(dd,'5/16/2020',@effdate) >= 0 
	begin
		if (select count(*) from SHCoverageDetailItems where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WATER')>0
		begin
			if (select count(*) from SHCoverageDetailItems where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WTRDMG')>0
				delete from SHCoverageDetailItems where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WATER'
			else
				update SHCoverageDetailItems set CoverageCd='WTRDMG' where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WATER'
		end
		if (select count(*) from SHCoverageDetails where AppId = @AppId and CoverageCd='WATER')>0
		begin 
			if (select count(*) from SHCoverageDetails where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WTRDMG')>0
				delete from SHCoverageDetails where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WATER'
			else
				update SHCoverageDetails set CoverageCd='WTRDMG' where AppId = @AppId and CoverageCd='WATER'
		end
	end

	if datediff(dd,'5/16/2020',@effdate) < 0 
	begin
		if (select count(*) from SHCoverageDetailItems where AppId = @AppId and CoverageCd='WTRDMG')>0
			if (select count(*) from SHCoverageDetailItems where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WATER')>0
				delete from SHCoverageDetailItems where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WTRDMG'
			else
				update SHCoverageDetailItems set CoverageCd='WATER' where AppId = @AppId and CoverageCd='WTRDMG'
		if (select count(*) from SHCoverageDetails where AppId = @AppId and CoverageCd='WTRDMG')>0
			if (select count(*) from SHCoverageDetails where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WATER')>0
				delete from SHCoverageDetails where AppId = @AppId and LocationNbr = @LocationNbr and BuildingNbr = @BuildingNbr and CoverageCd='WTRDMG'
			else
				update SHCoverageDetails set CoverageCd='WATER' where AppId = @AppId and CoverageCd='WTRDMG'
	end
	--don-2576 end	
	--fsit 145545 issue 147 10/29/12 dlh start
	if rtrim(@InsuranceLineCd) =''
	   set @InsuranceLineCd = (select WCLineOfBusiness from shplaninfo where appid = @appid)
	   
	 
    if rtrim(@FieldNameTxt) <> '' and rtrim(@FieldNameTxt) <> 'BIEE_TypeOfRisk'
       Begin
	    UPDATE SHCoverageDetailItems
		SET FieldValueTxt = @FieldValueTxt
		WHERE AppId = @AppId 
			AND LocationNbr = @LocationNbr 
			AND BuildingNbr = @BuildingNbr 
			AND LineOfBusinessCd = @LineOfBusinessCd 
			AND InsuranceLineCd = @InsuranceLineCd
			AND CoverageCd = @CoverageCd 
			AND CoverageSequenceNbr = @CoverageSequenceNbr 
			AND FieldNameTxt = @FieldNameTxt
	   End		
	/* fsit 144130 65 10/10/12 Dlh start */	
	--fsit 145545 issue 147 10/29/12 dlh end 
	If @InsuranceLineCd = 'CBP'
	   Begin 
	     Declare @RiskTypeCd char(2)	
	     Declare @UnitNumber VARCHAR(12)	
	     Declare @HostCd varchar(3)    
	     Set @RiskTypeCd = (Select top 1 GroupCd from BPSeleClassCodes with (nolock)
	                            where ClassCd = (select ClassCd from BoPropertyInfo with (nolock)
	                                             where Appid = @Appid and LocationNbr = @LocationNbr and StructureNbr = @BuildingNbr)
	                        )                   
	     --TL FSIT 144196 issue 162 10/31/2012 Starts
	     /*If @RiskTypeCd = 'RD' 
	        BEGIN                      
				IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and rtrim(coverageCd)='POOL') = 1)
				   BEGIN					 	
					 Delete SHRemarks where Appid = @Appid and rtrim(QuestionCd) = 'Q95' and rtrim(UnitNbr) = 'BORD2'
					 Delete SHRemarksDetail where Appid = @Appid and rtrim(QuestionCd) = 'Q95' and rtrim(UnitNbr) = 'BORD2'
					 
				   END	   
				ELSE
				   BEGIN					 	
					 if ((Select count(*) from SHRemarks with (nolock) where Appid = @Appid and rtrim(QuestionCd) = 'Q95' and rtrim(UnitNbr) = 'BORD2') = 0)					    		     
					    EXEC SHInsertStatements @Appid = @AppId, @HostCd = 'PT', @LineOfBusinessCd = 'BP', @UnitNbr = 'BORD2', @InsuranceLineCd = @InsuranceLineCd							     
				   END
	        END */
		--TL FSIT 144196 issue 162 10/31/2012 Ends
		
		--TL FSIT 144444 issue 187 11/01/2012 Starts
	    IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and rtrim(coverageCd)='LIQUOR') = 0)  
		BEGIN
			Update BOPropertyInfo Set PayRollAmt=0 Where AppId=@AppId
		END
		--TL FSIT 144444 issue 187 11/01/2012 Ends
	        
	    IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and rtrim(coverageCd)='HIRED') = 1)  
	       BEGIN
	            EXEC SHInsertStatements @Appid = @AppId, @HostCd = 'PT', @LineOfBusinessCd = 'BP', @UnitNbr = 'BOHIRED', @InsuranceLineCd = @InsuranceLineCd	
	       END
	    ELSE
	       IF ((select count(*) from SHRemarks with (nolock) where appid=@AppId and rtrim(QuestionCd) = 'Q57' and rtrim(UnitNbr) = 'BOHIRED') = 1)  
	          BEGIN
	             Delete SHRemarks where Appid = @Appid and rtrim(QuestionCd) = 'Q57' and rtrim(UnitNbr) = 'BOHIRED'
		         Delete SHRemarksDetail where Appid = @Appid and rtrim(QuestionCd) = 'Q57' and rtrim(UnitNbr) = 'BOHIRED'
		         --fsit 145545 issue 147 10/29/12 dlh start  
		         Delete SHRemarks where Appid = @Appid and rtrim(QuestionCd) = 'Q58' and rtrim(UnitNbr) = 'BOHIRED'
		         Delete SHRemarksDetail where Appid = @Appid and rtrim(QuestionCd) = 'Q58' and rtrim(UnitNbr) = 'BOHIRED'
		         --fsit 145545 issue 147 10/29/12 dlh end  
	          END 
	            
		--TL FSIT 144196 issue 162 10/31/2012 Starts
	    /*IF ((select count(*) from SHCoverageDetails with (nolock) where appid=@AppId and rtrim(coverageCd)='POOL') = 1)  
	        BEGIN
	            EXEC SHInsertStatements @Appid = @AppId, @HostCd = 'PT', @LineOfBusinessCd = 'BP', @UnitNbr = 'BOPOOL', @InsuranceLineCd = @InsuranceLineCd	
	        END
	    ELSE
	        BEGIN
	            IF ((select count(*) from SHRemarks with (nolock) where appid=@AppId and rtrim(QuestionCd) = 'Q56' and rtrim(UnitNbr) = 'BOPOOL') = 1)  
	                BEGIN
	                  Delete SHRemarks where Appid = @Appid and rtrim(QuestionCd) = 'Q56' and rtrim(UnitNbr) = 'BOPOOL'
		              Delete SHRemarksDetail where Appid = @Appid and rtrim(QuestionCd) = 'Q56' and rtrim(UnitNbr) = 'BOPOOL'
			          Delete SHRemarks where Appid = @Appid and rtrim(QuestionCd) = 'Q56A' and rtrim(UnitNbr) = 'BOPOOL'
			          Delete SHRemarksDetail where Appid = @Appid and rtrim(QuestionCd) = 'Q56A' and rtrim(UnitNbr) = 'BOPOOL'
			          Delete SHRemarks where Appid = @Appid and rtrim(QuestionCd) = 'Q56B' and rtrim(UnitNbr) = 'BOPOOL'
			          Delete SHRemarksDetail where Appid = @Appid and rtrim(QuestionCd) = 'Q56B' and rtrim(UnitNbr) = 'BOPOOL'
			        END  
	         END   */    
		--TL FSIT 144196 issue 162 10/31/2012 Ends
	   End
	/* fsit 144130 65 10/10/12 Dlh end */	   
	/* fsit 145651 start NY Pharmacists limit moved and locked start */	   
    if @InsuranceLineCd = 'NBP' 
       if (select count(*) from ShCoverageDetailItems with (nolock)
            where appid = @appid and rtrim(Coveragecd) = 'PHARM' and rtrim(FieldNameTxt) = 'PharmOccLmt') <> 0
           Begin
               declare @MedicalLmt varchar(20)
               declare @MedicalAggLmt varchar(20)
			   declare @DedAmount varchar(6)
               if (Select count(*) from BOInsuranceLine with (nolock) where appid = @appid) <> 0 
                   Begin
                       set @MedicalLmt = (select PerOccurrenceAmt from BOInsuranceLine with (nolock) where appid = @appid)
                       set @MedicalAggLmt = (select GenAggregateAmt from BOInsuranceLine with (nolock) where appid = @appid)
					   UPDATE SHCoverageDetailItems
					   SET FieldValueTxt = @MedicalLmt
					   WHERE AppId = @AppId 						 
						AND LineOfBusinessCd = @LineOfBusinessCd 
						AND InsuranceLineCd = @InsuranceLineCd
						AND rtrim(CoverageCd) = 'PHARM'						
						AND rtrim(FieldNameTxt) = 'PharmOccLmt'
						UPDATE SHCoverageDetailItems
					   SET FieldValueTxt = @MedicalAggLmt
					   WHERE AppId = @AppId 						 
						AND LineOfBusinessCd = @LineOfBusinessCd 
						AND InsuranceLineCd = @InsuranceLineCd
						AND rtrim(CoverageCd) = 'PHARM'						
						AND rtrim(FieldNameTxt) = 'PharmAggLmt'
					End	
           End 
       
       if (select count(*) from ShCoverageDetailItems with (nolock)
            where appid = @appid and rtrim(Coveragecd) = 'EMPDIS' and rtrim(FieldNameTxt) = 'CoverageLimitAmt') <> 0
              Begin
                declare @LimtAmt  VarChar(20)
                declare @TotalEmp  VarChar(20)
                set @MedicalLmt = (select FieldValueTxt from SHCoverageDetailItems with (nolock) 
                                   where appid = @appid and rtrim(Coveragecd) = 'EMPDIS' 
                                   and rtrim(FieldNameTxt) = 'CoverageLimitAmt')  
                set @TotalEmp = (select FieldValueTxt from SHCoverageDetailItems with (nolock) 
                                   where appid = @appid and rtrim(Coveragecd) = 'EMPDIS' 
                                   and rtrim(FieldNameTxt) = 'TotalEmployees')
                UPDATE SHCoverageDetailItems
					   SET FieldValueTxt = @MedicalLmt
					   WHERE AppId = @AppId 						 
						AND LineOfBusinessCd = @LineOfBusinessCd 
						AND InsuranceLineCd = @InsuranceLineCd
						AND rtrim(CoverageCd) = 'FORGE'						
						AND rtrim(FieldNameTxt) = 'CoverageLimitAmt'
				UPDATE SHCoverageDetailItems
					   SET FieldValueTxt = @TotalEmp
					   WHERE AppId = @AppId 						 
						AND LineOfBusinessCd = @LineOfBusinessCd 
						AND InsuranceLineCd = @InsuranceLineCd
						AND rtrim(CoverageCd) = 'FORGE'						
						AND rtrim(FieldNameTxt) = 'TotalEmployee'		
              End
           
     /* fsit 145651 start NY Pharmacists limit moved and locked start */	   
SET @error =  @@error
If @error <>0 
    RETURN @error
ELSE
    RETURN 0

GRANT EXECUTE ON [dbo].[SHUpdateCoverageDetailItems] TO [isol_app] AS [dbo]

